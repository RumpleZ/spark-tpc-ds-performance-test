2018-11-08 14:15:04 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2018-11-08 14:15:04 INFO  HiveMetaStore:589 - 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore
2018-11-08 14:15:04 INFO  ObjectStore:289 - ObjectStore, initialize called
2018-11-08 14:15:04 INFO  Persistence:77 - Property hive.metastore.integral.jdo.pushdown unknown - will be ignored
2018-11-08 14:15:04 INFO  Persistence:77 - Property datanucleus.cache.level2 unknown - will be ignored
2018-11-08 14:15:11 INFO  ObjectStore:370 - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2018-11-08 14:15:13 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:13 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:17 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:17 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:18 INFO  MetaStoreDirectSql:139 - Using direct SQL, underlying DB is DERBY
2018-11-08 14:15:18 INFO  ObjectStore:272 - Initialized ObjectStore
2018-11-08 14:15:19 WARN  ObjectStore:6666 - Version information not found in metastore. hive.metastore.schema.verification is not enabled so recording the schema version 1.2.0
2018-11-08 14:15:19 WARN  ObjectStore:568 - Failed to get database default, returning NoSuchObjectException
2018-11-08 14:15:20 INFO  HiveMetaStore:663 - Added admin role in metastore
2018-11-08 14:15:20 INFO  HiveMetaStore:672 - Added public role in metastore
2018-11-08 14:15:20 INFO  HiveMetaStore:712 - No user is added in admin role, since config is empty
2018-11-08 14:15:20 INFO  HiveMetaStore:746 - 0: get_all_databases
2018-11-08 14:15:20 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_all_databases	
2018-11-08 14:15:20 INFO  HiveMetaStore:746 - 0: get_functions: db=default pat=*
2018-11-08 14:15:20 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_functions: db=default pat=*	
2018-11-08 14:15:20 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MResourceUri" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:21 INFO  SessionState:641 - Created local directory: /tmp/d638b0f4-1514-40d5-a76c-9bddeb4fa673_resources
2018-11-08 14:15:21 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/d638b0f4-1514-40d5-a76c-9bddeb4fa673
2018-11-08 14:15:21 INFO  SessionState:641 - Created local directory: /tmp/gsd/d638b0f4-1514-40d5-a76c-9bddeb4fa673
2018-11-08 14:15:21 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/d638b0f4-1514-40d5-a76c-9bddeb4fa673/_tmp_space.db
2018-11-08 14:15:21 INFO  SparkContext:54 - Running Spark version 2.2.0
2018-11-08 14:15:21 INFO  SparkContext:54 - Submitted application: SparkSQL::192.168.112.64
2018-11-08 14:15:21 INFO  SecurityManager:54 - Changing view acls to: gsd
2018-11-08 14:15:21 INFO  SecurityManager:54 - Changing modify acls to: gsd
2018-11-08 14:15:21 INFO  SecurityManager:54 - Changing view acls groups to: 
2018-11-08 14:15:21 INFO  SecurityManager:54 - Changing modify acls groups to: 
2018-11-08 14:15:21 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(gsd); groups with view permissions: Set(); users  with modify permissions: Set(gsd); groups with modify permissions: Set()
2018-11-08 14:15:22 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 45875.
2018-11-08 14:15:22 INFO  SparkEnv:54 - Registering MapOutputTracker
2018-11-08 14:15:22 INFO  SparkEnv:54 - Registering BlockManagerMaster
2018-11-08 14:15:22 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2018-11-08 14:15:22 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2018-11-08 14:15:22 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-2c670e40-d303-4d98-98fa-591d58797b07
2018-11-08 14:15:22 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2018-11-08 14:15:22 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2018-11-08 14:15:22 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2018-11-08 14:15:22 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://192.168.112.64:4040
2018-11-08 14:15:22 INFO  RMProxy:98 - Connecting to ResourceManager at cloud64/192.168.112.64:8032
2018-11-08 14:15:22 INFO  Client:54 - Requesting a new application from cluster with 2 NodeManagers
2018-11-08 14:15:22 INFO  Client:54 - Verifying our application has not requested more than the maximum memory capability of the cluster (8192 MB per container)
2018-11-08 14:15:22 INFO  Client:54 - Will allocate AM container, with 896 MB memory including 384 MB overhead
2018-11-08 14:15:22 INFO  Client:54 - Setting up container launch context for our AM
2018-11-08 14:15:22 INFO  Client:54 - Setting up the launch environment for our AM container
2018-11-08 14:15:22 INFO  Client:54 - Preparing resources for our AM container
2018-11-08 14:15:24 WARN  Client:66 - Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
2018-11-08 14:15:25 INFO  Client:54 - Uploading resource file:/tmp/spark-b44058d3-dad1-488a-ad21-c313c10aae16/__spark_libs__5626268766983157800.zip -> hdfs://cloud64:9000/user/gsd/.sparkStaging/application_1541507063599_0113/__spark_libs__5626268766983157800.zip
2018-11-08 14:15:30 INFO  Client:54 - Uploading resource file:/tmp/spark-b44058d3-dad1-488a-ad21-c313c10aae16/__spark_conf__6350433488953400302.zip -> hdfs://cloud64:9000/user/gsd/.sparkStaging/application_1541507063599_0113/__spark_conf__.zip
2018-11-08 14:15:30 INFO  SecurityManager:54 - Changing view acls to: gsd
2018-11-08 14:15:30 INFO  SecurityManager:54 - Changing modify acls to: gsd
2018-11-08 14:15:30 INFO  SecurityManager:54 - Changing view acls groups to: 
2018-11-08 14:15:30 INFO  SecurityManager:54 - Changing modify acls groups to: 
2018-11-08 14:15:30 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(gsd); groups with view permissions: Set(); users  with modify permissions: Set(gsd); groups with modify permissions: Set()
2018-11-08 14:15:30 INFO  Client:54 - Submitting application application_1541507063599_0113 to ResourceManager
2018-11-08 14:15:30 INFO  YarnClientImpl:273 - Submitted application application_1541507063599_0113
2018-11-08 14:15:30 INFO  SchedulerExtensionServices:54 - Starting Yarn extension services with app application_1541507063599_0113 and attemptId None
2018-11-08 14:15:31 INFO  Client:54 - Application report for application_1541507063599_0113 (state: ACCEPTED)
2018-11-08 14:15:31 INFO  Client:54 - 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1541686530452
	 final status: UNDEFINED
	 tracking URL: http://cloud64:8088/proxy/application_1541507063599_0113/
	 user: gsd
2018-11-08 14:15:32 INFO  Client:54 - Application report for application_1541507063599_0113 (state: ACCEPTED)
2018-11-08 14:15:33 INFO  Client:54 - Application report for application_1541507063599_0113 (state: ACCEPTED)
2018-11-08 14:15:34 INFO  Client:54 - Application report for application_1541507063599_0113 (state: ACCEPTED)
2018-11-08 14:15:34 INFO  YarnSchedulerBackend$YarnSchedulerEndpoint:54 - ApplicationMaster registered as NettyRpcEndpointRef(spark-client://YarnAM)
2018-11-08 14:15:34 INFO  YarnClientSchedulerBackend:54 - Add WebUI Filter. org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter, Map(PROXY_HOSTS -> cloud64, PROXY_URI_BASES -> http://cloud64:8088/proxy/application_1541507063599_0113), /proxy/application_1541507063599_0113
2018-11-08 14:15:34 INFO  JettyUtils:54 - Adding filter: org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter
2018-11-08 14:15:35 INFO  Client:54 - Application report for application_1541507063599_0113 (state: RUNNING)
2018-11-08 14:15:35 INFO  Client:54 - 
	 client token: N/A
	 diagnostics: N/A
	 ApplicationMaster host: 192.168.112.70
	 ApplicationMaster RPC port: 0
	 queue: default
	 start time: 1541686530452
	 final status: UNDEFINED
	 tracking URL: http://cloud64:8088/proxy/application_1541507063599_0113/
	 user: gsd
2018-11-08 14:15:35 INFO  YarnClientSchedulerBackend:54 - Application application_1541507063599_0113 has started running.
2018-11-08 14:15:35 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 32870.
2018-11-08 14:15:35 INFO  NettyBlockTransferService:54 - Server created on 192.168.112.64:32870
2018-11-08 14:15:35 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2018-11-08 14:15:35 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 192.168.112.64, 32870, None)
2018-11-08 14:15:35 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 192.168.112.64:32870 with 366.3 MB RAM, BlockManagerId(driver, 192.168.112.64, 32870, None)
2018-11-08 14:15:35 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 192.168.112.64, 32870, None)
2018-11-08 14:15:35 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 192.168.112.64, 32870, None)
2018-11-08 14:15:35 INFO  EventLoggingListener:54 - Logging events to hdfs://cloud64:9000/app/shared/spark-logs/application_1541507063599_0113
2018-11-08 14:15:38 INFO  YarnSchedulerBackend$YarnDriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.112.70:41818) with ID 1
2018-11-08 14:15:38 INFO  BlockManagerMasterEndpoint:54 - Registering block manager cloud70.cluster.lsd.di.uminho.pt:44385 with 366.3 MB RAM, BlockManagerId(1, cloud70.cluster.lsd.di.uminho.pt, 44385, None)
2018-11-08 14:15:39 INFO  YarnSchedulerBackend$YarnDriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.112.74:58734) with ID 2
2018-11-08 14:15:39 INFO  YarnClientSchedulerBackend:54 - SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
2018-11-08 14:15:39 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/usr/local/spark/spark-warehouse/').
2018-11-08 14:15:39 INFO  SharedState:54 - Warehouse path is 'file:/usr/local/spark/spark-warehouse/'.
2018-11-08 14:15:39 INFO  BlockManagerMasterEndpoint:54 - Registering block manager cloud74.cluster.lsd.di.uminho.pt:38882 with 366.3 MB RAM, BlockManagerId(2, cloud74.cluster.lsd.di.uminho.pt, 38882, None)
2018-11-08 14:15:39 INFO  HiveUtils:54 - Initializing HiveMetastoreConnection version 1.2.1 using Spark classes.
2018-11-08 14:15:40 INFO  HiveMetaStore:589 - 0: Opening raw store with implemenation class:org.apache.hadoop.hive.metastore.ObjectStore
2018-11-08 14:15:40 INFO  ObjectStore:289 - ObjectStore, initialize called
2018-11-08 14:15:40 INFO  Persistence:77 - Property hive.metastore.integral.jdo.pushdown unknown - will be ignored
2018-11-08 14:15:40 INFO  Persistence:77 - Property datanucleus.cache.level2 unknown - will be ignored
2018-11-08 14:15:42 INFO  ObjectStore:370 - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2018-11-08 14:15:43 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:43 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:43 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:43 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:43 INFO  Query:77 - Reading in results for query "org.datanucleus.store.rdbms.query.SQLQuery@0" since the connection used is closing
2018-11-08 14:15:43 INFO  MetaStoreDirectSql:139 - Using direct SQL, underlying DB is DERBY
2018-11-08 14:15:43 INFO  ObjectStore:272 - Initialized ObjectStore
2018-11-08 14:15:43 INFO  HiveMetaStore:663 - Added admin role in metastore
2018-11-08 14:15:43 INFO  HiveMetaStore:672 - Added public role in metastore
2018-11-08 14:15:43 INFO  HiveMetaStore:712 - No user is added in admin role, since config is empty
2018-11-08 14:15:43 INFO  HiveMetaStore:746 - 0: get_all_databases
2018-11-08 14:15:43 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_all_databases	
2018-11-08 14:15:43 INFO  HiveMetaStore:746 - 0: get_functions: db=default pat=*
2018-11-08 14:15:43 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_functions: db=default pat=*	
2018-11-08 14:15:43 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MResourceUri" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:43 INFO  HiveMetaStore:746 - 0: get_functions: db=tpcds pat=*
2018-11-08 14:15:43 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_functions: db=tpcds pat=*	
2018-11-08 14:15:43 INFO  SessionState:641 - Created local directory: /tmp/08331902-354b-41df-86ad-074aafac90fa_resources
2018-11-08 14:15:43 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/08331902-354b-41df-86ad-074aafac90fa
2018-11-08 14:15:43 INFO  SessionState:641 - Created local directory: /tmp/gsd/08331902-354b-41df-86ad-074aafac90fa
2018-11-08 14:15:44 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/08331902-354b-41df-86ad-074aafac90fa/_tmp_space.db
2018-11-08 14:15:44 INFO  HiveClientImpl:54 - Warehouse location for Hive client (version 1.2.1) is file:/usr/local/spark/spark-warehouse/
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_database: default
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: default	
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_database: global_temp
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: global_temp	
2018-11-08 14:15:44 WARN  ObjectStore:568 - Failed to get database global_temp, returning NoSuchObjectException
2018-11-08 14:15:44 INFO  SessionState:641 - Created local directory: /tmp/48763f00-4611-4dc0-91bc-b723a255e730_resources
2018-11-08 14:15:44 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/48763f00-4611-4dc0-91bc-b723a255e730
2018-11-08 14:15:44 INFO  SessionState:641 - Created local directory: /tmp/gsd/48763f00-4611-4dc0-91bc-b723a255e730
2018-11-08 14:15:44 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/48763f00-4611-4dc0-91bc-b723a255e730/_tmp_space.db
2018-11-08 14:15:44 INFO  HiveClientImpl:54 - Warehouse location for Hive client (version 1.2.1) is file:/usr/local/spark/spark-warehouse/
2018-11-08 14:15:44 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
2018-11-08 14:15:44 INFO  SessionState:641 - Created local directory: /tmp/1a38715a-d1a5-4e40-954e-0c83a8a4dcf2_resources
2018-11-08 14:15:44 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/1a38715a-d1a5-4e40-954e-0c83a8a4dcf2
2018-11-08 14:15:44 INFO  SessionState:641 - Created local directory: /tmp/gsd/1a38715a-d1a5-4e40-954e-0c83a8a4dcf2
2018-11-08 14:15:44 INFO  SessionState:641 - Created HDFS directory: /tmp/hive/gsd/1a38715a-d1a5-4e40-954e-0c83a8a4dcf2/_tmp_space.db
2018-11-08 14:15:44 INFO  HiveClientImpl:54 - Warehouse location for Hive client (version 1.2.1) is file:/usr/local/spark/spark-warehouse/
2018-11-08 14:15:44 INFO  SparkSqlParser:54 - Parsing command: 
USE TPCDS
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:44 INFO  CliDriver:951 - Time taken: 0.462 seconds
2018-11-08 14:15:44 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists call_center_text
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:44 INFO  CliDriver:951 - Time taken: 0.062 seconds
2018-11-08 14:15:44 INFO  SparkSqlParser:54 - Parsing command: 
create table call_center_text
(
cc_call_center_sk         int,
cc_call_center_id         string,
cc_rec_start_date         string,
cc_rec_end_date           string,
cc_closed_date_sk         int,
cc_open_date_sk           int,
cc_name                   string,
cc_class                  string,
cc_employees              int,
cc_sq_ft                  int,
cc_hours                  string,
cc_manager                string,
cc_mkt_id                 int,
cc_mkt_class              string,
cc_mkt_desc               string,
cc_market_manager         string,
cc_division               int,
cc_division_name          string,
cc_company                int,
cc_company_name           string,
cc_street_number          string,
cc_street_name            string,
cc_street_type            string,
cc_suite_number           string,
cc_city                   string,
cc_county                 string,
cc_state                  string,
cc_zip                    string,
cc_country                string,
cc_gmt_offset             double,
cc_tax_percentage         double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/call_center.csv")

2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:45 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`call_center_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:call_center_text, dbName:tpcds, owner:gsd, createTime:1541686545, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/call_center_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/call_center.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cc_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_call_center_id","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_employees","type":"integer","nullable":true,"metadata":{}},{"name":"cc_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"cc_hours","type":"string","nullable":true,"metadata":{}},{"name":"cc_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"cc_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"cc_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_division","type":"integer","nullable":true,"metadata":{}},{"name":"cc_division_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_company","type":"integer","nullable":true,"metadata":{}},{"name":"cc_company_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_type","type":"string","nullable":true,"metadata":{}},{"name":"cc_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_city","type":"string","nullable":true,"metadata":{}},{"name":"cc_county","type":"string","nullable":true,"metadata":{}},{"name":"cc_state","type":"string","nullable":true,"metadata":{}},{"name":"cc_zip","type":"string","nullable":true,"metadata":{}},{"name":"cc_country","type":"string","nullable":true,"metadata":{}},{"name":"cc_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"cc_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:call_center_text, dbName:tpcds, owner:gsd, createTime:1541686545, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/call_center_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/call_center.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cc_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_call_center_id","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_employees","type":"integer","nullable":true,"metadata":{}},{"name":"cc_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"cc_hours","type":"string","nullable":true,"metadata":{}},{"name":"cc_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"cc_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"cc_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_division","type":"integer","nullable":true,"metadata":{}},{"name":"cc_division_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_company","type":"integer","nullable":true,"metadata":{}},{"name":"cc_company_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_type","type":"string","nullable":true,"metadata":{}},{"name":"cc_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_city","type":"string","nullable":true,"metadata":{}},{"name":"cc_county","type":"string","nullable":true,"metadata":{}},{"name":"cc_state","type":"string","nullable":true,"metadata":{}},{"name":"cc_zip","type":"string","nullable":true,"metadata":{}},{"name":"cc_country","type":"string","nullable":true,"metadata":{}},{"name":"cc_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"cc_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:45 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/call_center_text-__PLACEHOLDER__
2018-11-08 14:15:45 INFO  CliDriver:951 - Time taken: 0.642 seconds
2018-11-08 14:15:45 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists call_center
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:45 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=call_center
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=call_center	
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MFieldSchema" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  Datastore:77 - The class "org.apache.hadoop.hive.metastore.model.MOrder" is tagged as "embedded-only" so does not have its own datastore table.
2018-11-08 14:15:46 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/call_center
2018-11-08 14:15:46 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:15:46 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/call_center
2018-11-08 14:15:46 INFO  CliDriver:951 - Time taken: 1.046 seconds
2018-11-08 14:15:46 INFO  SparkSqlParser:54 - Parsing command: 
create table call_center
using parquet
as (select * from call_center_text)

2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:46 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:46 INFO  ContextCleaner:54 - Cleaned accumulator 2
2018-11-08 14:15:46 INFO  ContextCleaner:54 - Cleaned accumulator 3
2018-11-08 14:15:46 INFO  ContextCleaner:54 - Cleaned accumulator 0
2018-11-08 14:15:46 INFO  ContextCleaner:54 - Cleaned accumulator 1
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:46 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:15:46 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:15:46 INFO  FileSourceStrategy:54 - Output Data Schema: struct<cc_call_center_sk: int, cc_call_center_id: string, cc_rec_start_date: string, cc_rec_end_date: string, cc_closed_date_sk: int ... 29 more fields>
2018-11-08 14:15:47 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:15:47 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:47 WARN  Utils:66 - Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
2018-11-08 14:15:47 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:47 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:47 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:47 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:47 INFO  CodeGenerator:54 - Code generated in 221.560538 ms
2018-11-08 14:15:47 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 283.4 KB, free 366.0 MB)
2018-11-08 14:15:47 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 23.5 KB, free 366.0 MB)
2018-11-08 14:15:47 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:15:47 INFO  SparkContext:54 - Created broadcast 0 from processCmd at CliDriver.java:376
2018-11-08 14:15:47 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:15:47 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:15:47 INFO  DAGScheduler:54 - Got job 0 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:15:47 INFO  DAGScheduler:54 - Final stage: ResultStage 0 (processCmd at CliDriver.java:376)
2018-11-08 14:15:47 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:15:47 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:15:47 INFO  DAGScheduler:54 - Submitting ResultStage 0 (MapPartitionsRDD[1] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:15:47 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 91.1 KB, free 365.9 MB)
2018-11-08 14:15:47 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 34.1 KB, free 365.9 MB)
2018-11-08 14:15:47 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 192.168.112.64:32870 (size: 34.1 KB, free: 366.2 MB)
2018-11-08 14:15:47 INFO  SparkContext:54 - Created broadcast 1 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:15:48 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[1] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:15:48 INFO  YarnScheduler:54 - Adding task set 0.0 with 1 tasks
2018-11-08 14:15:48 INFO  TaskSetManager:54 - Starting task 0.0 in stage 0.0 (TID 0, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5319 bytes)
2018-11-08 14:15:48 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 34.1 KB, free: 366.3 MB)
2018-11-08 14:15:49 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 0.0 (TID 0) in 2043 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/1)
2018-11-08 14:15:50 INFO  YarnScheduler:54 - Removed TaskSet 0.0, whose tasks have all completed, from pool 
2018-11-08 14:15:50 INFO  DAGScheduler:54 - ResultStage 0 (processCmd at CliDriver.java:376) finished in 2,059 s
2018-11-08 14:15:50 INFO  DAGScheduler:54 - Job 0 finished: processCmd at CliDriver.java:376, took 2,218672 s
2018-11-08 14:15:50 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center	
2018-11-08 14:15:50 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`call_center` into Hive metastore in Hive compatible format.
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:call_center, dbName:tpcds, owner:gsd, createTime:1541686546, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cc_call_center_sk, type:int, comment:null), FieldSchema(name:cc_call_center_id, type:string, comment:null), FieldSchema(name:cc_rec_start_date, type:string, comment:null), FieldSchema(name:cc_rec_end_date, type:string, comment:null), FieldSchema(name:cc_closed_date_sk, type:int, comment:null), FieldSchema(name:cc_open_date_sk, type:int, comment:null), FieldSchema(name:cc_name, type:string, comment:null), FieldSchema(name:cc_class, type:string, comment:null), FieldSchema(name:cc_employees, type:int, comment:null), FieldSchema(name:cc_sq_ft, type:int, comment:null), FieldSchema(name:cc_hours, type:string, comment:null), FieldSchema(name:cc_manager, type:string, comment:null), FieldSchema(name:cc_mkt_id, type:int, comment:null), FieldSchema(name:cc_mkt_class, type:string, comment:null), FieldSchema(name:cc_mkt_desc, type:string, comment:null), FieldSchema(name:cc_market_manager, type:string, comment:null), FieldSchema(name:cc_division, type:int, comment:null), FieldSchema(name:cc_division_name, type:string, comment:null), FieldSchema(name:cc_company, type:int, comment:null), FieldSchema(name:cc_company_name, type:string, comment:null), FieldSchema(name:cc_street_number, type:string, comment:null), FieldSchema(name:cc_street_name, type:string, comment:null), FieldSchema(name:cc_street_type, type:string, comment:null), FieldSchema(name:cc_suite_number, type:string, comment:null), FieldSchema(name:cc_city, type:string, comment:null), FieldSchema(name:cc_county, type:string, comment:null), FieldSchema(name:cc_state, type:string, comment:null), FieldSchema(name:cc_zip, type:string, comment:null), FieldSchema(name:cc_country, type:string, comment:null), FieldSchema(name:cc_gmt_offset, type:double, comment:null), FieldSchema(name:cc_tax_percentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/call_center, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cc_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_call_center_id","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_employees","type":"integer","nullable":true,"metadata":{}},{"name":"cc_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"cc_hours","type":"string","nullable":true,"metadata":{}},{"name":"cc_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"cc_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"cc_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_division","type":"integer","nullable":true,"metadata":{}},{"name":"cc_division_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_company","type":"integer","nullable":true,"metadata":{}},{"name":"cc_company_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_type","type":"string","nullable":true,"metadata":{}},{"name":"cc_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_city","type":"string","nullable":true,"metadata":{}},{"name":"cc_county","type":"string","nullable":true,"metadata":{}},{"name":"cc_state","type":"string","nullable":true,"metadata":{}},{"name":"cc_zip","type":"string","nullable":true,"metadata":{}},{"name":"cc_country","type":"string","nullable":true,"metadata":{}},{"name":"cc_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"cc_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:call_center, dbName:tpcds, owner:gsd, createTime:1541686546, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cc_call_center_sk, type:int, comment:null), FieldSchema(name:cc_call_center_id, type:string, comment:null), FieldSchema(name:cc_rec_start_date, type:string, comment:null), FieldSchema(name:cc_rec_end_date, type:string, comment:null), FieldSchema(name:cc_closed_date_sk, type:int, comment:null), FieldSchema(name:cc_open_date_sk, type:int, comment:null), FieldSchema(name:cc_name, type:string, comment:null), FieldSchema(name:cc_class, type:string, comment:null), FieldSchema(name:cc_employees, type:int, comment:null), FieldSchema(name:cc_sq_ft, type:int, comment:null), FieldSchema(name:cc_hours, type:string, comment:null), FieldSchema(name:cc_manager, type:string, comment:null), FieldSchema(name:cc_mkt_id, type:int, comment:null), FieldSchema(name:cc_mkt_class, type:string, comment:null), FieldSchema(name:cc_mkt_desc, type:string, comment:null), FieldSchema(name:cc_market_manager, type:string, comment:null), FieldSchema(name:cc_division, type:int, comment:null), FieldSchema(name:cc_division_name, type:string, comment:null), FieldSchema(name:cc_company, type:int, comment:null), FieldSchema(name:cc_company_name, type:string, comment:null), FieldSchema(name:cc_street_number, type:string, comment:null), FieldSchema(name:cc_street_name, type:string, comment:null), FieldSchema(name:cc_street_type, type:string, comment:null), FieldSchema(name:cc_suite_number, type:string, comment:null), FieldSchema(name:cc_city, type:string, comment:null), FieldSchema(name:cc_county, type:string, comment:null), FieldSchema(name:cc_state, type:string, comment:null), FieldSchema(name:cc_zip, type:string, comment:null), FieldSchema(name:cc_country, type:string, comment:null), FieldSchema(name:cc_gmt_offset, type:double, comment:null), FieldSchema(name:cc_tax_percentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/call_center, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cc_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_call_center_id","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"cc_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cc_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_employees","type":"integer","nullable":true,"metadata":{}},{"name":"cc_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"cc_hours","type":"string","nullable":true,"metadata":{}},{"name":"cc_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"cc_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"cc_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"cc_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"cc_division","type":"integer","nullable":true,"metadata":{}},{"name":"cc_division_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_company","type":"integer","nullable":true,"metadata":{}},{"name":"cc_company_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_name","type":"string","nullable":true,"metadata":{}},{"name":"cc_street_type","type":"string","nullable":true,"metadata":{}},{"name":"cc_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"cc_city","type":"string","nullable":true,"metadata":{}},{"name":"cc_county","type":"string","nullable":true,"metadata":{}},{"name":"cc_state","type":"string","nullable":true,"metadata":{}},{"name":"cc_zip","type":"string","nullable":true,"metadata":{}},{"name":"cc_country","type":"string","nullable":true,"metadata":{}},{"name":"cc_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"cc_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:50 INFO  log:217 - Updating table stats fast for call_center
2018-11-08 14:15:50 INFO  log:219 - Updated size of table call_center to 8991
2018-11-08 14:15:50 INFO  CliDriver:951 - Time taken: 3.652 seconds
2018-11-08 14:15:50 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists call_center_text
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=call_center_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=call_center_text	
2018-11-08 14:15:50 INFO  CliDriver:951 - Time taken: 0.205 seconds
2018-11-08 14:15:50 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists catalog_page_text
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 INFO  CliDriver:951 - Time taken: 0.014 seconds
2018-11-08 14:15:50 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_page_text
(
cp_catalog_page_sk        int,
cp_catalog_page_id        string,
cp_start_date_sk          int,
cp_end_date_sk            int,
cp_department             string,
cp_catalog_number         int,
cp_catalog_page_number    int,
cp_description            string,
cp_type                   string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_page.csv")

2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`catalog_page_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_page_text, dbName:tpcds, owner:gsd, createTime:1541686550, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_page.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cp_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_id","type":"string","nullable":true,"metadata":{}},{"name":"cp_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_department","type":"string","nullable":true,"metadata":{}},{"name":"cp_catalog_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_description","type":"string","nullable":true,"metadata":{}},{"name":"cp_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_page_text, dbName:tpcds, owner:gsd, createTime:1541686550, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_page.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cp_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_id","type":"string","nullable":true,"metadata":{}},{"name":"cp_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_department","type":"string","nullable":true,"metadata":{}},{"name":"cp_catalog_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_description","type":"string","nullable":true,"metadata":{}},{"name":"cp_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:50 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page_text-__PLACEHOLDER__
2018-11-08 14:15:50 INFO  CliDriver:951 - Time taken: 0.108 seconds
2018-11-08 14:15:50 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_page
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page
2018-11-08 14:15:50 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:15:50 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page
2018-11-08 14:15:50 INFO  CliDriver:951 - Time taken: 0.229 seconds
2018-11-08 14:15:50 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_page
using parquet
as (select * from catalog_page_text)

2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:50 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:50 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:50 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:15:50 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:15:50 INFO  FileSourceStrategy:54 - Output Data Schema: struct<cp_catalog_page_sk: int, cp_catalog_page_id: string, cp_start_date_sk: int, cp_end_date_sk: int, cp_department: string ... 7 more fields>
2018-11-08 14:15:50 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:15:50 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:50 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:50 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:50 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:50 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:50 INFO  MemoryStore:54 - Block broadcast_2 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:15:51 INFO  MemoryStore:54 - Block broadcast_2_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:15:51 INFO  BlockManagerInfo:54 - Added broadcast_2_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:51 INFO  SparkContext:54 - Created broadcast 2 from processCmd at CliDriver.java:376
2018-11-08 14:15:51 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:15:51 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Got job 1 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Final stage: ResultStage 1 (processCmd at CliDriver.java:376)
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Submitting ResultStage 1 (MapPartitionsRDD[4] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:15:51 INFO  MemoryStore:54 - Block broadcast_3 stored as values in memory (estimated size 85.6 KB, free 365.5 MB)
2018-11-08 14:15:51 INFO  MemoryStore:54 - Block broadcast_3_piece0 stored as bytes in memory (estimated size 32.8 KB, free 365.5 MB)
2018-11-08 14:15:51 INFO  BlockManagerInfo:54 - Added broadcast_3_piece0 in memory on 192.168.112.64:32870 (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:15:51 INFO  SparkContext:54 - Created broadcast 3 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:15:51 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 1 (MapPartitionsRDD[4] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:15:51 INFO  YarnScheduler:54 - Adding task set 1.0 with 1 tasks
2018-11-08 14:15:51 INFO  TaskSetManager:54 - Starting task 0.0 in stage 1.0 (TID 1, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5320 bytes)
2018-11-08 14:15:51 INFO  BlockManagerInfo:54 - Added broadcast_3_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.8 KB, free: 366.3 MB)
2018-11-08 14:15:52 INFO  BlockManagerInfo:54 - Added broadcast_2_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:53 INFO  TaskSetManager:54 - Finished task 0.0 in stage 1.0 (TID 1) in 2895 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:15:53 INFO  YarnScheduler:54 - Removed TaskSet 1.0, whose tasks have all completed, from pool 
2018-11-08 14:15:53 INFO  DAGScheduler:54 - ResultStage 1 (processCmd at CliDriver.java:376) finished in 2,896 s
2018-11-08 14:15:53 INFO  DAGScheduler:54 - Job 1 finished: processCmd at CliDriver.java:376, took 2,923935 s
2018-11-08 14:15:54 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page	
2018-11-08 14:15:54 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`catalog_page` into Hive metastore in Hive compatible format.
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_page, dbName:tpcds, owner:gsd, createTime:1541686550, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cp_catalog_page_sk, type:int, comment:null), FieldSchema(name:cp_catalog_page_id, type:string, comment:null), FieldSchema(name:cp_start_date_sk, type:int, comment:null), FieldSchema(name:cp_end_date_sk, type:int, comment:null), FieldSchema(name:cp_department, type:string, comment:null), FieldSchema(name:cp_catalog_number, type:int, comment:null), FieldSchema(name:cp_catalog_page_number, type:int, comment:null), FieldSchema(name:cp_description, type:string, comment:null), FieldSchema(name:cp_type, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cp_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_id","type":"string","nullable":true,"metadata":{}},{"name":"cp_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_department","type":"string","nullable":true,"metadata":{}},{"name":"cp_catalog_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_description","type":"string","nullable":true,"metadata":{}},{"name":"cp_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_page, dbName:tpcds, owner:gsd, createTime:1541686550, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cp_catalog_page_sk, type:int, comment:null), FieldSchema(name:cp_catalog_page_id, type:string, comment:null), FieldSchema(name:cp_start_date_sk, type:int, comment:null), FieldSchema(name:cp_end_date_sk, type:int, comment:null), FieldSchema(name:cp_department, type:string, comment:null), FieldSchema(name:cp_catalog_number, type:int, comment:null), FieldSchema(name:cp_catalog_page_number, type:int, comment:null), FieldSchema(name:cp_description, type:string, comment:null), FieldSchema(name:cp_type, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_page, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cp_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_id","type":"string","nullable":true,"metadata":{}},{"name":"cp_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cp_department","type":"string","nullable":true,"metadata":{}},{"name":"cp_catalog_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_catalog_page_number","type":"integer","nullable":true,"metadata":{}},{"name":"cp_description","type":"string","nullable":true,"metadata":{}},{"name":"cp_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:54 INFO  log:217 - Updating table stats fast for catalog_page
2018-11-08 14:15:54 INFO  log:219 - Updated size of table catalog_page to 693347
2018-11-08 14:15:54 INFO  CliDriver:951 - Time taken: 3.225 seconds
2018-11-08 14:15:54 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_page_text
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_page_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_page_text	
2018-11-08 14:15:54 INFO  CliDriver:951 - Time taken: 0.158 seconds
2018-11-08 14:15:54 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists catalog_returns_text
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:15:54 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_returns_text
(
cr_returned_date_sk       int,
cr_returned_time_sk       int,
cr_item_sk                int,
cr_refunded_customer_sk   int,
cr_refunded_cdemo_sk      int,
cr_refunded_hdemo_sk      int,
cr_refunded_addr_sk       int,
cr_returning_customer_sk  int,
cr_returning_cdemo_sk     int,
cr_returning_hdemo_sk     int,
cr_returning_addr_sk      int,
cr_call_center_sk         int,
cr_catalog_page_sk        int,
cr_ship_mode_sk           int,
cr_warehouse_sk           int,
cr_reason_sk              int,
cr_order_number           int,
cr_return_quantity        int,
cr_return_amount          double,
cr_return_tax             double,
cr_return_amt_inc_tax     double,
cr_fee                    double,
cr_return_ship_cost       double,
cr_refunded_cash          double,
cr_reversed_charge        double,
cr_store_credit           double,
cr_net_loss               double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_returns.csv")

2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`catalog_returns_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_returns_text, dbName:tpcds, owner:gsd, createTime:1541686554, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_amount","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_fee","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"cr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"cr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"cr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_returns_text, dbName:tpcds, owner:gsd, createTime:1541686554, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_amount","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_fee","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"cr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"cr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"cr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:54 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns_text-__PLACEHOLDER__
2018-11-08 14:15:54 INFO  CliDriver:951 - Time taken: 0.102 seconds
2018-11-08 14:15:54 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_returns
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns
2018-11-08 14:15:54 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:15:54 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns
2018-11-08 14:15:54 INFO  CliDriver:951 - Time taken: 0.212 seconds
2018-11-08 14:15:54 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_returns
using parquet
as (select * from catalog_returns_text)

2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:54 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:54 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:54 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:15:54 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:15:54 INFO  FileSourceStrategy:54 - Output Data Schema: struct<cr_returned_date_sk: int, cr_returned_time_sk: int, cr_item_sk: int, cr_refunded_customer_sk: int, cr_refunded_cdemo_sk: int ... 25 more fields>
2018-11-08 14:15:54 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:15:54 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:54 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:54 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:54 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:54 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:54 INFO  MemoryStore:54 - Block broadcast_4 stored as values in memory (estimated size 283.4 KB, free 365.2 MB)
2018-11-08 14:15:54 INFO  MemoryStore:54 - Block broadcast_4_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.2 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Added broadcast_4_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:54 INFO  SparkContext:54 - Created broadcast 4 from processCmd at CliDriver.java:376
2018-11-08 14:15:54 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 12714304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:15:54 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Got job 2 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Final stage: ResultStage 2 (processCmd at CliDriver.java:376)
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Submitting ResultStage 2 (MapPartitionsRDD[7] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:15:54 INFO  MemoryStore:54 - Block broadcast_5 stored as values in memory (estimated size 90.3 KB, free 365.1 MB)
2018-11-08 14:15:54 INFO  MemoryStore:54 - Block broadcast_5_piece0 stored as bytes in memory (estimated size 33.8 KB, free 365.0 MB)
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 5
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 57
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 59
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 91
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 93
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 92
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 63
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 64
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Added broadcast_5_piece0 in memory on 192.168.112.64:32870 (size: 33.8 KB, free: 366.1 MB)
2018-11-08 14:15:54 INFO  SparkContext:54 - Created broadcast 5 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:15:54 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 2 (MapPartitionsRDD[7] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:15:54 INFO  YarnScheduler:54 - Adding task set 2.0 with 2 tasks
2018-11-08 14:15:54 INFO  TaskSetManager:54 - Starting task 0.0 in stage 2.0 (TID 2, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5323 bytes)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_0_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_0_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_3_piece0 on 192.168.112.64:32870 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_3_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.8 KB, free: 366.3 MB)
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 7
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 60
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 61
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 6
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 4
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 94
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 62
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 58
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 8
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 65
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 66
2018-11-08 14:15:54 INFO  ContextCleaner:54 - Cleaned accumulator 95
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_1_piece0 on 192.168.112.64:32870 in memory (size: 34.1 KB, free: 366.2 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_1_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 34.1 KB, free: 366.3 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_2_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Removed broadcast_2_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Added broadcast_5_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 33.8 KB, free: 366.3 MB)
2018-11-08 14:15:54 INFO  BlockManagerInfo:54 - Added broadcast_4_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:56 INFO  TaskSetManager:54 - Starting task 1.0 in stage 2.0 (TID 3, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, NODE_LOCAL, 5323 bytes)
2018-11-08 14:15:56 INFO  TaskSetManager:54 - Finished task 0.0 in stage 2.0 (TID 2) in 2036 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/2)
2018-11-08 14:15:58 INFO  TaskSetManager:54 - Finished task 1.0 in stage 2.0 (TID 3) in 1182 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (2/2)
2018-11-08 14:15:58 INFO  YarnScheduler:54 - Removed TaskSet 2.0, whose tasks have all completed, from pool 
2018-11-08 14:15:58 INFO  DAGScheduler:54 - ResultStage 2 (processCmd at CliDriver.java:376) finished in 3,216 s
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Job 2 finished: processCmd at CliDriver.java:376, took 3,301397 s
2018-11-08 14:15:58 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns	
2018-11-08 14:15:58 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`catalog_returns` into Hive metastore in Hive compatible format.
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_returns, dbName:tpcds, owner:gsd, createTime:1541686554, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cr_returned_date_sk, type:int, comment:null), FieldSchema(name:cr_returned_time_sk, type:int, comment:null), FieldSchema(name:cr_item_sk, type:int, comment:null), FieldSchema(name:cr_refunded_customer_sk, type:int, comment:null), FieldSchema(name:cr_refunded_cdemo_sk, type:int, comment:null), FieldSchema(name:cr_refunded_hdemo_sk, type:int, comment:null), FieldSchema(name:cr_refunded_addr_sk, type:int, comment:null), FieldSchema(name:cr_returning_customer_sk, type:int, comment:null), FieldSchema(name:cr_returning_cdemo_sk, type:int, comment:null), FieldSchema(name:cr_returning_hdemo_sk, type:int, comment:null), FieldSchema(name:cr_returning_addr_sk, type:int, comment:null), FieldSchema(name:cr_call_center_sk, type:int, comment:null), FieldSchema(name:cr_catalog_page_sk, type:int, comment:null), FieldSchema(name:cr_ship_mode_sk, type:int, comment:null), FieldSchema(name:cr_warehouse_sk, type:int, comment:null), FieldSchema(name:cr_reason_sk, type:int, comment:null), FieldSchema(name:cr_order_number, type:int, comment:null), FieldSchema(name:cr_return_quantity, type:int, comment:null), FieldSchema(name:cr_return_amount, type:double, comment:null), FieldSchema(name:cr_return_tax, type:double, comment:null), FieldSchema(name:cr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:cr_fee, type:double, comment:null), FieldSchema(name:cr_return_ship_cost, type:double, comment:null), FieldSchema(name:cr_refunded_cash, type:double, comment:null), FieldSchema(name:cr_reversed_charge, type:double, comment:null), FieldSchema(name:cr_store_credit, type:double, comment:null), FieldSchema(name:cr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_amount","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_fee","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"cr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"cr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"cr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_returns, dbName:tpcds, owner:gsd, createTime:1541686554, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cr_returned_date_sk, type:int, comment:null), FieldSchema(name:cr_returned_time_sk, type:int, comment:null), FieldSchema(name:cr_item_sk, type:int, comment:null), FieldSchema(name:cr_refunded_customer_sk, type:int, comment:null), FieldSchema(name:cr_refunded_cdemo_sk, type:int, comment:null), FieldSchema(name:cr_refunded_hdemo_sk, type:int, comment:null), FieldSchema(name:cr_refunded_addr_sk, type:int, comment:null), FieldSchema(name:cr_returning_customer_sk, type:int, comment:null), FieldSchema(name:cr_returning_cdemo_sk, type:int, comment:null), FieldSchema(name:cr_returning_hdemo_sk, type:int, comment:null), FieldSchema(name:cr_returning_addr_sk, type:int, comment:null), FieldSchema(name:cr_call_center_sk, type:int, comment:null), FieldSchema(name:cr_catalog_page_sk, type:int, comment:null), FieldSchema(name:cr_ship_mode_sk, type:int, comment:null), FieldSchema(name:cr_warehouse_sk, type:int, comment:null), FieldSchema(name:cr_reason_sk, type:int, comment:null), FieldSchema(name:cr_order_number, type:int, comment:null), FieldSchema(name:cr_return_quantity, type:int, comment:null), FieldSchema(name:cr_return_amount, type:double, comment:null), FieldSchema(name:cr_return_tax, type:double, comment:null), FieldSchema(name:cr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:cr_fee, type:double, comment:null), FieldSchema(name:cr_return_ship_cost, type:double, comment:null), FieldSchema(name:cr_refunded_cash, type:double, comment:null), FieldSchema(name:cr_reversed_charge, type:double, comment:null), FieldSchema(name:cr_store_credit, type:double, comment:null), FieldSchema(name:cr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cr_return_amount","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cr_fee","type":"double","nullable":true,"metadata":{}},{"name":"cr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"cr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"cr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"cr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:58 INFO  log:217 - Updating table stats fast for catalog_returns
2018-11-08 14:15:58 INFO  log:219 - Updated size of table catalog_returns to 11732220
2018-11-08 14:15:58 INFO  CliDriver:951 - Time taken: 3.632 seconds
2018-11-08 14:15:58 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_returns_text
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_returns_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_returns_text	
2018-11-08 14:15:58 INFO  CliDriver:951 - Time taken: 0.158 seconds
2018-11-08 14:15:58 INFO  SparkSqlParser:54 - Parsing command: 


drop table if exists catalog_sales_text
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 INFO  CliDriver:951 - Time taken: 0.015 seconds
2018-11-08 14:15:58 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_sales_text
(
cs_sold_date_sk           int,
cs_sold_time_sk           int,
cs_ship_date_sk           int,
cs_bill_customer_sk       int,
cs_bill_cdemo_sk          int,
cs_bill_hdemo_sk          int,
cs_bill_addr_sk           int,
cs_ship_customer_sk       int,
cs_ship_cdemo_sk          int,
cs_ship_hdemo_sk          int,
cs_ship_addr_sk           int,
cs_call_center_sk         int,
cs_catalog_page_sk        int,
cs_ship_mode_sk           int,
cs_warehouse_sk           int,
cs_item_sk                int,
cs_promo_sk               int,
cs_order_number           int,
cs_quantity               int,
cs_wholesale_cost         double,
cs_list_price             double,
cs_sales_price            double,
cs_ext_discount_amt       double,
cs_ext_sales_price        double,
cs_ext_wholesale_cost     double,
cs_ext_list_price         double,
cs_ext_tax                double,
cs_coupon_amt             double,
cs_ext_ship_cost          double,
cs_net_paid               double,
cs_net_paid_inc_tax       double,
cs_net_paid_inc_ship      double,
cs_net_paid_inc_ship_tax  double,
cs_net_profit             double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_sales.csv")

2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`catalog_sales_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_sales_text, dbName:tpcds, owner:gsd, createTime:1541686558, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cs_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cs_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cs_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_sales_text, dbName:tpcds, owner:gsd, createTime:1541686558, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/catalog_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cs_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cs_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cs_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:15:58 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales_text-__PLACEHOLDER__
2018-11-08 14:15:58 INFO  CliDriver:951 - Time taken: 0.091 seconds
2018-11-08 14:15:58 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_sales
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales
2018-11-08 14:15:58 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:15:58 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales
2018-11-08 14:15:58 INFO  CliDriver:951 - Time taken: 0.213 seconds
2018-11-08 14:15:58 INFO  SparkSqlParser:54 - Parsing command: 
create table catalog_sales
using parquet
as (select * from catalog_sales_text)

2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:15:58 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:15:58 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:15:58 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:15:58 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:15:58 INFO  FileSourceStrategy:54 - Output Data Schema: struct<cs_sold_date_sk: int, cs_sold_time_sk: int, cs_ship_date_sk: int, cs_bill_customer_sk: int, cs_bill_cdemo_sk: int ... 32 more fields>
2018-11-08 14:15:58 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:15:58 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:58 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:58 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:58 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:15:58 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:15:58 INFO  MemoryStore:54 - Block broadcast_6 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:15:58 INFO  MemoryStore:54 - Block broadcast_6_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:15:58 INFO  BlockManagerInfo:54 - Added broadcast_6_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:58 INFO  SparkContext:54 - Created broadcast 6 from processCmd at CliDriver.java:376
2018-11-08 14:15:58 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 134217728 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:15:58 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Got job 3 (processCmd at CliDriver.java:376) with 3 output partitions
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Final stage: ResultStage 3 (processCmd at CliDriver.java:376)
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Submitting ResultStage 3 (MapPartitionsRDD[10] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:15:58 INFO  MemoryStore:54 - Block broadcast_7 stored as values in memory (estimated size 92.1 KB, free 365.5 MB)
2018-11-08 14:15:58 INFO  MemoryStore:54 - Block broadcast_7_piece0 stored as bytes in memory (estimated size 34.2 KB, free 365.5 MB)
2018-11-08 14:15:58 INFO  BlockManagerInfo:54 - Added broadcast_7_piece0 in memory on 192.168.112.64:32870 (size: 34.2 KB, free: 366.2 MB)
2018-11-08 14:15:58 INFO  SparkContext:54 - Created broadcast 7 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:15:58 INFO  DAGScheduler:54 - Submitting 3 missing tasks from ResultStage 3 (MapPartitionsRDD[10] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1, 2))
2018-11-08 14:15:58 INFO  YarnScheduler:54 - Adding task set 3.0 with 3 tasks
2018-11-08 14:15:58 INFO  TaskSetManager:54 - Starting task 2.0 in stage 3.0 (TID 4, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 2, NODE_LOCAL, 5321 bytes)
2018-11-08 14:15:58 INFO  TaskSetManager:54 - Starting task 0.0 in stage 3.0 (TID 5, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5321 bytes)
2018-11-08 14:15:58 INFO  BlockManagerInfo:54 - Added broadcast_7_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 34.2 KB, free: 366.2 MB)
2018-11-08 14:15:58 INFO  BlockManagerInfo:54 - Added broadcast_6_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:15:58 INFO  BlockManagerInfo:54 - Added broadcast_7_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 34.2 KB, free: 366.3 MB)
2018-11-08 14:15:59 INFO  BlockManagerInfo:54 - Added broadcast_6_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:02 INFO  TaskSetManager:54 - Starting task 1.0 in stage 3.0 (TID 6, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, RACK_LOCAL, 5321 bytes)
2018-11-08 14:16:02 INFO  TaskSetManager:54 - Finished task 2.0 in stage 3.0 (TID 4) in 3403 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/3)
2018-11-08 14:16:05 INFO  TaskSetManager:54 - Finished task 0.0 in stage 3.0 (TID 5) in 6767 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (2/3)
2018-11-08 14:16:11 INFO  TaskSetManager:54 - Finished task 1.0 in stage 3.0 (TID 6) in 8764 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (3/3)
2018-11-08 14:16:11 INFO  YarnScheduler:54 - Removed TaskSet 3.0, whose tasks have all completed, from pool 
2018-11-08 14:16:11 INFO  DAGScheduler:54 - ResultStage 3 (processCmd at CliDriver.java:376) finished in 12,165 s
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Job 3 finished: processCmd at CliDriver.java:376, took 12,190741 s
2018-11-08 14:16:11 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales	
2018-11-08 14:16:11 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`catalog_sales` into Hive metastore in Hive compatible format.
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:catalog_sales, dbName:tpcds, owner:gsd, createTime:1541686558, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cs_sold_date_sk, type:int, comment:null), FieldSchema(name:cs_sold_time_sk, type:int, comment:null), FieldSchema(name:cs_ship_date_sk, type:int, comment:null), FieldSchema(name:cs_bill_customer_sk, type:int, comment:null), FieldSchema(name:cs_bill_cdemo_sk, type:int, comment:null), FieldSchema(name:cs_bill_hdemo_sk, type:int, comment:null), FieldSchema(name:cs_bill_addr_sk, type:int, comment:null), FieldSchema(name:cs_ship_customer_sk, type:int, comment:null), FieldSchema(name:cs_ship_cdemo_sk, type:int, comment:null), FieldSchema(name:cs_ship_hdemo_sk, type:int, comment:null), FieldSchema(name:cs_ship_addr_sk, type:int, comment:null), FieldSchema(name:cs_call_center_sk, type:int, comment:null), FieldSchema(name:cs_catalog_page_sk, type:int, comment:null), FieldSchema(name:cs_ship_mode_sk, type:int, comment:null), FieldSchema(name:cs_warehouse_sk, type:int, comment:null), FieldSchema(name:cs_item_sk, type:int, comment:null), FieldSchema(name:cs_promo_sk, type:int, comment:null), FieldSchema(name:cs_order_number, type:int, comment:null), FieldSchema(name:cs_quantity, type:int, comment:null), FieldSchema(name:cs_wholesale_cost, type:double, comment:null), FieldSchema(name:cs_list_price, type:double, comment:null), FieldSchema(name:cs_sales_price, type:double, comment:null), FieldSchema(name:cs_ext_discount_amt, type:double, comment:null), FieldSchema(name:cs_ext_sales_price, type:double, comment:null), FieldSchema(name:cs_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:cs_ext_list_price, type:double, comment:null), FieldSchema(name:cs_ext_tax, type:double, comment:null), FieldSchema(name:cs_coupon_amt, type:double, comment:null), FieldSchema(name:cs_ext_ship_cost, type:double, comment:null), FieldSchema(name:cs_net_paid, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_ship, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_ship_tax, type:double, comment:null), FieldSchema(name:cs_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cs_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cs_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cs_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:catalog_sales, dbName:tpcds, owner:gsd, createTime:1541686558, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cs_sold_date_sk, type:int, comment:null), FieldSchema(name:cs_sold_time_sk, type:int, comment:null), FieldSchema(name:cs_ship_date_sk, type:int, comment:null), FieldSchema(name:cs_bill_customer_sk, type:int, comment:null), FieldSchema(name:cs_bill_cdemo_sk, type:int, comment:null), FieldSchema(name:cs_bill_hdemo_sk, type:int, comment:null), FieldSchema(name:cs_bill_addr_sk, type:int, comment:null), FieldSchema(name:cs_ship_customer_sk, type:int, comment:null), FieldSchema(name:cs_ship_cdemo_sk, type:int, comment:null), FieldSchema(name:cs_ship_hdemo_sk, type:int, comment:null), FieldSchema(name:cs_ship_addr_sk, type:int, comment:null), FieldSchema(name:cs_call_center_sk, type:int, comment:null), FieldSchema(name:cs_catalog_page_sk, type:int, comment:null), FieldSchema(name:cs_ship_mode_sk, type:int, comment:null), FieldSchema(name:cs_warehouse_sk, type:int, comment:null), FieldSchema(name:cs_item_sk, type:int, comment:null), FieldSchema(name:cs_promo_sk, type:int, comment:null), FieldSchema(name:cs_order_number, type:int, comment:null), FieldSchema(name:cs_quantity, type:int, comment:null), FieldSchema(name:cs_wholesale_cost, type:double, comment:null), FieldSchema(name:cs_list_price, type:double, comment:null), FieldSchema(name:cs_sales_price, type:double, comment:null), FieldSchema(name:cs_ext_discount_amt, type:double, comment:null), FieldSchema(name:cs_ext_sales_price, type:double, comment:null), FieldSchema(name:cs_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:cs_ext_list_price, type:double, comment:null), FieldSchema(name:cs_ext_tax, type:double, comment:null), FieldSchema(name:cs_coupon_amt, type:double, comment:null), FieldSchema(name:cs_ext_ship_cost, type:double, comment:null), FieldSchema(name:cs_net_paid, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_ship, type:double, comment:null), FieldSchema(name:cs_net_paid_inc_ship_tax, type:double, comment:null), FieldSchema(name:cs_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/catalog_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cs_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_call_center_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_catalog_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cs_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"cs_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"cs_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"cs_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"cs_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:11 INFO  log:217 - Updating table stats fast for catalog_sales
2018-11-08 14:16:11 INFO  log:219 - Updated size of table catalog_sales to 116534930
2018-11-08 14:16:11 INFO  CliDriver:951 - Time taken: 12.511 seconds
2018-11-08 14:16:11 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists catalog_sales_text
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=catalog_sales_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=catalog_sales_text	
2018-11-08 14:16:11 INFO  CliDriver:951 - Time taken: 0.149 seconds
2018-11-08 14:16:11 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists customer_text
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:16:11 INFO  SparkSqlParser:54 - Parsing command: 
create table customer_text
(
c_customer_sk             int,
c_customer_id             string,
c_current_cdemo_sk        int,
c_current_hdemo_sk        int,
c_current_addr_sk         int,
c_first_shipto_date_sk    int,
c_first_sales_date_sk     int,
c_salutation              string,
c_first_name              string,
c_last_name               string,
c_preferred_cust_flag     string,
c_birth_day               int,
c_birth_month             int,
c_birth_year              int,
c_birth_country           string,
c_login                   string,
c_email_address           string,
c_last_review_date        string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer.csv")

2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`customer_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer_text, dbName:tpcds, owner:gsd, createTime:1541686571, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"c_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_customer_id","type":"string","nullable":true,"metadata":{}},{"name":"c_current_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_shipto_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_sales_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_salutation","type":"string","nullable":true,"metadata":{}},{"name":"c_first_name","type":"string","nullable":true,"metadata":{}},{"name":"c_last_name","type":"string","nullable":true,"metadata":{}},{"name":"c_preferred_cust_flag","type":"string","nullable":true,"metadata":{}},{"name":"c_birth_day","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_month","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_year","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_country","type":"string","nullable":true,"metadata":{}},{"name":"c_login","type":"string","nullable":true,"metadata":{}},{"name":"c_email_address","type":"string","nullable":true,"metadata":{}},{"name":"c_last_review_date","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer_text, dbName:tpcds, owner:gsd, createTime:1541686571, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"c_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_customer_id","type":"string","nullable":true,"metadata":{}},{"name":"c_current_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_shipto_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_sales_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_salutation","type":"string","nullable":true,"metadata":{}},{"name":"c_first_name","type":"string","nullable":true,"metadata":{}},{"name":"c_last_name","type":"string","nullable":true,"metadata":{}},{"name":"c_preferred_cust_flag","type":"string","nullable":true,"metadata":{}},{"name":"c_birth_day","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_month","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_year","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_country","type":"string","nullable":true,"metadata":{}},{"name":"c_login","type":"string","nullable":true,"metadata":{}},{"name":"c_email_address","type":"string","nullable":true,"metadata":{}},{"name":"c_last_review_date","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:11 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/customer_text-__PLACEHOLDER__
2018-11-08 14:16:11 INFO  CliDriver:951 - Time taken: 0.076 seconds
2018-11-08 14:16:11 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/customer
2018-11-08 14:16:11 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:11 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/customer
2018-11-08 14:16:11 INFO  CliDriver:951 - Time taken: 0.172 seconds
2018-11-08 14:16:11 INFO  SparkSqlParser:54 - Parsing command: 
create table customer
using parquet
as (select * from customer_text)

2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:11 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:11 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:11 INFO  FileSourceStrategy:54 - Output Data Schema: struct<c_customer_sk: int, c_customer_id: string, c_current_cdemo_sk: int, c_current_hdemo_sk: int, c_current_addr_sk: int ... 16 more fields>
2018-11-08 14:16:11 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:11 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:11 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:11 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:11 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:11 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:11 INFO  MemoryStore:54 - Block broadcast_8 stored as values in memory (estimated size 283.4 KB, free 365.2 MB)
2018-11-08 14:16:11 INFO  MemoryStore:54 - Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.2 MB)
2018-11-08 14:16:11 INFO  BlockManagerInfo:54 - Added broadcast_8_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:11 INFO  SparkContext:54 - Created broadcast 8 from processCmd at CliDriver.java:376
2018-11-08 14:16:11 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 8652293 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:11 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Got job 4 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Final stage: ResultStage 4 (processCmd at CliDriver.java:376)
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Submitting ResultStage 4 (MapPartitionsRDD[13] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:11 INFO  MemoryStore:54 - Block broadcast_9 stored as values in memory (estimated size 87.9 KB, free 365.1 MB)
2018-11-08 14:16:11 INFO  MemoryStore:54 - Block broadcast_9_piece0 stored as bytes in memory (estimated size 33.4 KB, free 365.0 MB)
2018-11-08 14:16:11 INFO  BlockManagerInfo:54 - Added broadcast_9_piece0 in memory on 192.168.112.64:32870 (size: 33.4 KB, free: 366.1 MB)
2018-11-08 14:16:11 INFO  SparkContext:54 - Created broadcast 9 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:11 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 4 (MapPartitionsRDD[13] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:11 INFO  YarnScheduler:54 - Adding task set 4.0 with 2 tasks
2018-11-08 14:16:11 INFO  TaskSetManager:54 - Starting task 0.0 in stage 4.0 (TID 7, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5316 bytes)
2018-11-08 14:16:11 INFO  BlockManagerInfo:54 - Added broadcast_9_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.4 KB, free: 366.2 MB)
2018-11-08 14:16:11 INFO  BlockManagerInfo:54 - Added broadcast_8_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:13 INFO  TaskSetManager:54 - Starting task 1.0 in stage 4.0 (TID 8, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, NODE_LOCAL, 5316 bytes)
2018-11-08 14:16:13 INFO  TaskSetManager:54 - Finished task 0.0 in stage 4.0 (TID 7) in 1558 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:16:14 INFO  TaskSetManager:54 - Finished task 1.0 in stage 4.0 (TID 8) in 925 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:16:14 INFO  YarnScheduler:54 - Removed TaskSet 4.0, whose tasks have all completed, from pool 
2018-11-08 14:16:14 INFO  DAGScheduler:54 - ResultStage 4 (processCmd at CliDriver.java:376) finished in 2,481 s
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Job 4 finished: processCmd at CliDriver.java:376, took 2,500806 s
2018-11-08 14:16:14 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer	
2018-11-08 14:16:14 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`customer` into Hive metastore in Hive compatible format.
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer, dbName:tpcds, owner:gsd, createTime:1541686571, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:c_customer_sk, type:int, comment:null), FieldSchema(name:c_customer_id, type:string, comment:null), FieldSchema(name:c_current_cdemo_sk, type:int, comment:null), FieldSchema(name:c_current_hdemo_sk, type:int, comment:null), FieldSchema(name:c_current_addr_sk, type:int, comment:null), FieldSchema(name:c_first_shipto_date_sk, type:int, comment:null), FieldSchema(name:c_first_sales_date_sk, type:int, comment:null), FieldSchema(name:c_salutation, type:string, comment:null), FieldSchema(name:c_first_name, type:string, comment:null), FieldSchema(name:c_last_name, type:string, comment:null), FieldSchema(name:c_preferred_cust_flag, type:string, comment:null), FieldSchema(name:c_birth_day, type:int, comment:null), FieldSchema(name:c_birth_month, type:int, comment:null), FieldSchema(name:c_birth_year, type:int, comment:null), FieldSchema(name:c_birth_country, type:string, comment:null), FieldSchema(name:c_login, type:string, comment:null), FieldSchema(name:c_email_address, type:string, comment:null), FieldSchema(name:c_last_review_date, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"c_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_customer_id","type":"string","nullable":true,"metadata":{}},{"name":"c_current_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_shipto_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_sales_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_salutation","type":"string","nullable":true,"metadata":{}},{"name":"c_first_name","type":"string","nullable":true,"metadata":{}},{"name":"c_last_name","type":"string","nullable":true,"metadata":{}},{"name":"c_preferred_cust_flag","type":"string","nullable":true,"metadata":{}},{"name":"c_birth_day","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_month","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_year","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_country","type":"string","nullable":true,"metadata":{}},{"name":"c_login","type":"string","nullable":true,"metadata":{}},{"name":"c_email_address","type":"string","nullable":true,"metadata":{}},{"name":"c_last_review_date","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer, dbName:tpcds, owner:gsd, createTime:1541686571, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:c_customer_sk, type:int, comment:null), FieldSchema(name:c_customer_id, type:string, comment:null), FieldSchema(name:c_current_cdemo_sk, type:int, comment:null), FieldSchema(name:c_current_hdemo_sk, type:int, comment:null), FieldSchema(name:c_current_addr_sk, type:int, comment:null), FieldSchema(name:c_first_shipto_date_sk, type:int, comment:null), FieldSchema(name:c_first_sales_date_sk, type:int, comment:null), FieldSchema(name:c_salutation, type:string, comment:null), FieldSchema(name:c_first_name, type:string, comment:null), FieldSchema(name:c_last_name, type:string, comment:null), FieldSchema(name:c_preferred_cust_flag, type:string, comment:null), FieldSchema(name:c_birth_day, type:int, comment:null), FieldSchema(name:c_birth_month, type:int, comment:null), FieldSchema(name:c_birth_year, type:int, comment:null), FieldSchema(name:c_birth_country, type:string, comment:null), FieldSchema(name:c_login, type:string, comment:null), FieldSchema(name:c_email_address, type:string, comment:null), FieldSchema(name:c_last_review_date, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"c_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_customer_id","type":"string","nullable":true,"metadata":{}},{"name":"c_current_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_current_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_shipto_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_first_sales_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"c_salutation","type":"string","nullable":true,"metadata":{}},{"name":"c_first_name","type":"string","nullable":true,"metadata":{}},{"name":"c_last_name","type":"string","nullable":true,"metadata":{}},{"name":"c_preferred_cust_flag","type":"string","nullable":true,"metadata":{}},{"name":"c_birth_day","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_month","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_year","type":"integer","nullable":true,"metadata":{}},{"name":"c_birth_country","type":"string","nullable":true,"metadata":{}},{"name":"c_login","type":"string","nullable":true,"metadata":{}},{"name":"c_email_address","type":"string","nullable":true,"metadata":{}},{"name":"c_last_review_date","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:14 INFO  log:217 - Updating table stats fast for customer
2018-11-08 14:16:14 INFO  log:219 - Updated size of table customer to 5532082
2018-11-08 14:16:14 INFO  CliDriver:951 - Time taken: 2.748 seconds
2018-11-08 14:16:14 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer_text
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer_text	
2018-11-08 14:16:14 INFO  CliDriver:951 - Time taken: 0.146 seconds
2018-11-08 14:16:14 INFO  SparkSqlParser:54 - Parsing command: 


drop table if exists customer_address_text
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 INFO  CliDriver:951 - Time taken: 0.011 seconds
2018-11-08 14:16:14 INFO  SparkSqlParser:54 - Parsing command: 
create table customer_address_text
(
ca_address_sk             int,
ca_address_id             string,
ca_street_number          string,
ca_street_name            string,
ca_street_type            string,
ca_suite_number           string,
ca_city                   string,
ca_county                 string,
ca_state                  string,
ca_zip                    string,
ca_country                string,
ca_gmt_offset             double,
ca_location_type          string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_address.csv")

2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`customer_address_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer_address_text, dbName:tpcds, owner:gsd, createTime:1541686574, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_address.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ca_address_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ca_address_id","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_name","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_type","type":"string","nullable":true,"metadata":{}},{"name":"ca_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_city","type":"string","nullable":true,"metadata":{}},{"name":"ca_county","type":"string","nullable":true,"metadata":{}},{"name":"ca_state","type":"string","nullable":true,"metadata":{}},{"name":"ca_zip","type":"string","nullable":true,"metadata":{}},{"name":"ca_country","type":"string","nullable":true,"metadata":{}},{"name":"ca_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"ca_location_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer_address_text, dbName:tpcds, owner:gsd, createTime:1541686574, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_address.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ca_address_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ca_address_id","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_name","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_type","type":"string","nullable":true,"metadata":{}},{"name":"ca_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_city","type":"string","nullable":true,"metadata":{}},{"name":"ca_county","type":"string","nullable":true,"metadata":{}},{"name":"ca_state","type":"string","nullable":true,"metadata":{}},{"name":"ca_zip","type":"string","nullable":true,"metadata":{}},{"name":"ca_country","type":"string","nullable":true,"metadata":{}},{"name":"ca_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"ca_location_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:14 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address_text-__PLACEHOLDER__
2018-11-08 14:16:14 INFO  CliDriver:951 - Time taken: 0.128 seconds
2018-11-08 14:16:14 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer_address
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address
2018-11-08 14:16:14 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:14 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address
2018-11-08 14:16:14 INFO  CliDriver:951 - Time taken: 0.165 seconds
2018-11-08 14:16:14 INFO  SparkSqlParser:54 - Parsing command: 
create table customer_address
using parquet
as (select * from customer_address_text)

2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:14 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:14 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:14 INFO  FileSourceStrategy:54 - Output Data Schema: struct<ca_address_sk: int, ca_address_id: string, ca_street_number: string, ca_street_name: string, ca_street_type: string ... 11 more fields>
2018-11-08 14:16:14 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:14 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:14 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:14 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:14 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:14 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:14 INFO  MemoryStore:54 - Block broadcast_10 stored as values in memory (estimated size 283.4 KB, free 364.8 MB)
2018-11-08 14:16:14 INFO  MemoryStore:54 - Block broadcast_10_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.7 MB)
2018-11-08 14:16:14 INFO  BlockManagerInfo:54 - Added broadcast_10_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:14 INFO  SparkContext:54 - Created broadcast 10 from processCmd at CliDriver.java:376
2018-11-08 14:16:14 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4823234 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:14 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Got job 5 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Final stage: ResultStage 5 (processCmd at CliDriver.java:376)
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Submitting ResultStage 5 (MapPartitionsRDD[16] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:14 INFO  MemoryStore:54 - Block broadcast_11 stored as values in memory (estimated size 86.6 KB, free 364.7 MB)
2018-11-08 14:16:14 INFO  MemoryStore:54 - Block broadcast_11_piece0 stored as bytes in memory (estimated size 33.0 KB, free 364.6 MB)
2018-11-08 14:16:14 INFO  BlockManagerInfo:54 - Added broadcast_11_piece0 in memory on 192.168.112.64:32870 (size: 33.0 KB, free: 366.1 MB)
2018-11-08 14:16:14 INFO  SparkContext:54 - Created broadcast 11 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:14 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 5 (MapPartitionsRDD[16] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:14 INFO  YarnScheduler:54 - Adding task set 5.0 with 2 tasks
2018-11-08 14:16:14 INFO  TaskSetManager:54 - Starting task 0.0 in stage 5.0 (TID 9, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5324 bytes)
2018-11-08 14:16:14 INFO  BlockManagerInfo:54 - Added broadcast_11_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.0 KB, free: 366.2 MB)
2018-11-08 14:16:15 INFO  BlockManagerInfo:54 - Added broadcast_10_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:16 INFO  TaskSetManager:54 - Starting task 1.0 in stage 5.0 (TID 10, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, NODE_LOCAL, 5324 bytes)
2018-11-08 14:16:16 INFO  TaskSetManager:54 - Finished task 0.0 in stage 5.0 (TID 9) in 1139 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:16:16 INFO  TaskSetManager:54 - Finished task 1.0 in stage 5.0 (TID 10) in 221 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:16:16 INFO  YarnScheduler:54 - Removed TaskSet 5.0, whose tasks have all completed, from pool 
2018-11-08 14:16:16 INFO  DAGScheduler:54 - ResultStage 5 (processCmd at CliDriver.java:376) finished in 1,358 s
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Job 5 finished: processCmd at CliDriver.java:376, took 1,381993 s
2018-11-08 14:16:16 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address	
2018-11-08 14:16:16 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`customer_address` into Hive metastore in Hive compatible format.
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer_address, dbName:tpcds, owner:gsd, createTime:1541686574, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ca_address_sk, type:int, comment:null), FieldSchema(name:ca_address_id, type:string, comment:null), FieldSchema(name:ca_street_number, type:string, comment:null), FieldSchema(name:ca_street_name, type:string, comment:null), FieldSchema(name:ca_street_type, type:string, comment:null), FieldSchema(name:ca_suite_number, type:string, comment:null), FieldSchema(name:ca_city, type:string, comment:null), FieldSchema(name:ca_county, type:string, comment:null), FieldSchema(name:ca_state, type:string, comment:null), FieldSchema(name:ca_zip, type:string, comment:null), FieldSchema(name:ca_country, type:string, comment:null), FieldSchema(name:ca_gmt_offset, type:double, comment:null), FieldSchema(name:ca_location_type, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ca_address_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ca_address_id","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_name","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_type","type":"string","nullable":true,"metadata":{}},{"name":"ca_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_city","type":"string","nullable":true,"metadata":{}},{"name":"ca_county","type":"string","nullable":true,"metadata":{}},{"name":"ca_state","type":"string","nullable":true,"metadata":{}},{"name":"ca_zip","type":"string","nullable":true,"metadata":{}},{"name":"ca_country","type":"string","nullable":true,"metadata":{}},{"name":"ca_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"ca_location_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer_address, dbName:tpcds, owner:gsd, createTime:1541686574, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ca_address_sk, type:int, comment:null), FieldSchema(name:ca_address_id, type:string, comment:null), FieldSchema(name:ca_street_number, type:string, comment:null), FieldSchema(name:ca_street_name, type:string, comment:null), FieldSchema(name:ca_street_type, type:string, comment:null), FieldSchema(name:ca_suite_number, type:string, comment:null), FieldSchema(name:ca_city, type:string, comment:null), FieldSchema(name:ca_county, type:string, comment:null), FieldSchema(name:ca_state, type:string, comment:null), FieldSchema(name:ca_zip, type:string, comment:null), FieldSchema(name:ca_country, type:string, comment:null), FieldSchema(name:ca_gmt_offset, type:double, comment:null), FieldSchema(name:ca_location_type, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer_address, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ca_address_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ca_address_id","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_name","type":"string","nullable":true,"metadata":{}},{"name":"ca_street_type","type":"string","nullable":true,"metadata":{}},{"name":"ca_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"ca_city","type":"string","nullable":true,"metadata":{}},{"name":"ca_county","type":"string","nullable":true,"metadata":{}},{"name":"ca_state","type":"string","nullable":true,"metadata":{}},{"name":"ca_zip","type":"string","nullable":true,"metadata":{}},{"name":"ca_country","type":"string","nullable":true,"metadata":{}},{"name":"ca_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"ca_location_type","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:16 INFO  log:217 - Updating table stats fast for customer_address
2018-11-08 14:16:16 INFO  log:219 - Updated size of table customer_address to 1103227
2018-11-08 14:16:16 INFO  CliDriver:951 - Time taken: 1.629 seconds
2018-11-08 14:16:16 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer_address_text
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer_address_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer_address_text	
2018-11-08 14:16:16 INFO  CliDriver:951 - Time taken: 0.124 seconds
2018-11-08 14:16:16 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists customer_demographics_text
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 INFO  CliDriver:951 - Time taken: 0.011 seconds
2018-11-08 14:16:16 INFO  SparkSqlParser:54 - Parsing command: 
create table customer_demographics_text
(
cd_demo_sk                int,
cd_gender                 string,
cd_marital_status         string,
cd_education_status       string,
cd_purchase_estimate      int,
cd_credit_rating          string,
cd_dep_count              int,
cd_dep_employed_count     int,
cd_dep_college_count      int
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_demographics.csv")

2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`customer_demographics_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer_demographics_text, dbName:tpcds, owner:gsd, createTime:1541686576, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_demographics.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cd_gender","type":"string","nullable":true,"metadata":{}},{"name":"cd_marital_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_education_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_purchase_estimate","type":"integer","nullable":true,"metadata":{}},{"name":"cd_credit_rating","type":"string","nullable":true,"metadata":{}},{"name":"cd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_employed_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_college_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer_demographics_text, dbName:tpcds, owner:gsd, createTime:1541686576, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/customer_demographics.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cd_gender","type":"string","nullable":true,"metadata":{}},{"name":"cd_marital_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_education_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_purchase_estimate","type":"integer","nullable":true,"metadata":{}},{"name":"cd_credit_rating","type":"string","nullable":true,"metadata":{}},{"name":"cd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_employed_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_college_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:16 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics_text-__PLACEHOLDER__
2018-11-08 14:16:16 INFO  CliDriver:951 - Time taken: 0.077 seconds
2018-11-08 14:16:16 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer_demographics
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics
2018-11-08 14:16:16 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:16 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics
2018-11-08 14:16:16 INFO  CliDriver:951 - Time taken: 0.14 seconds
2018-11-08 14:16:16 INFO  SparkSqlParser:54 - Parsing command: 
create table customer_demographics
using parquet
as (select * from customer_demographics_text)

2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:16 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:16 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:16 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:16 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:16 INFO  FileSourceStrategy:54 - Output Data Schema: struct<cd_demo_sk: int, cd_gender: string, cd_marital_status: string, cd_education_status: string, cd_purchase_estimate: int ... 7 more fields>
2018-11-08 14:16:16 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:16 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:16 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:16 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:16 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:16 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:16 INFO  MemoryStore:54 - Block broadcast_12 stored as values in memory (estimated size 283.4 KB, free 364.3 MB)
2018-11-08 14:16:16 INFO  MemoryStore:54 - Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.3 MB)
2018-11-08 14:16:16 INFO  BlockManagerInfo:54 - Added broadcast_12_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:16 INFO  SparkContext:54 - Created broadcast 12 from processCmd at CliDriver.java:376
2018-11-08 14:16:16 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 41466800 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:16 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Got job 6 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Final stage: ResultStage 6 (processCmd at CliDriver.java:376)
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Submitting ResultStage 6 (MapPartitionsRDD[19] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:16 INFO  MemoryStore:54 - Block broadcast_13 stored as values in memory (estimated size 85.6 KB, free 364.2 MB)
2018-11-08 14:16:16 INFO  MemoryStore:54 - Block broadcast_13_piece0 stored as bytes in memory (estimated size 32.8 KB, free 364.2 MB)
2018-11-08 14:16:16 INFO  BlockManagerInfo:54 - Added broadcast_13_piece0 in memory on 192.168.112.64:32870 (size: 32.8 KB, free: 366.0 MB)
2018-11-08 14:16:16 INFO  SparkContext:54 - Created broadcast 13 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:16 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 6 (MapPartitionsRDD[19] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:16 INFO  YarnScheduler:54 - Adding task set 6.0 with 2 tasks
2018-11-08 14:16:16 INFO  TaskSetManager:54 - Starting task 0.0 in stage 6.0 (TID 11, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5329 bytes)
2018-11-08 14:16:16 INFO  BlockManagerInfo:54 - Added broadcast_13_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.8 KB, free: 366.1 MB)
2018-11-08 14:16:17 INFO  BlockManagerInfo:54 - Added broadcast_12_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:20 INFO  TaskSetManager:54 - Starting task 1.0 in stage 6.0 (TID 12, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, RACK_LOCAL, 5329 bytes)
2018-11-08 14:16:20 INFO  BlockManagerInfo:54 - Added broadcast_13_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:16:20 INFO  BlockManagerInfo:54 - Added broadcast_12_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:21 INFO  TaskSetManager:54 - Finished task 0.0 in stage 6.0 (TID 11) in 4641 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:16:23 INFO  TaskSetManager:54 - Finished task 1.0 in stage 6.0 (TID 12) in 2938 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (2/2)
2018-11-08 14:16:23 INFO  YarnScheduler:54 - Removed TaskSet 6.0, whose tasks have all completed, from pool 
2018-11-08 14:16:23 INFO  DAGScheduler:54 - ResultStage 6 (processCmd at CliDriver.java:376) finished in 6,515 s
2018-11-08 14:16:23 INFO  DAGScheduler:54 - Job 6 finished: processCmd at CliDriver.java:376, took 6,531916 s
2018-11-08 14:16:23 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics	
2018-11-08 14:16:23 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`customer_demographics` into Hive metastore in Hive compatible format.
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:customer_demographics, dbName:tpcds, owner:gsd, createTime:1541686576, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cd_demo_sk, type:int, comment:null), FieldSchema(name:cd_gender, type:string, comment:null), FieldSchema(name:cd_marital_status, type:string, comment:null), FieldSchema(name:cd_education_status, type:string, comment:null), FieldSchema(name:cd_purchase_estimate, type:int, comment:null), FieldSchema(name:cd_credit_rating, type:string, comment:null), FieldSchema(name:cd_dep_count, type:int, comment:null), FieldSchema(name:cd_dep_employed_count, type:int, comment:null), FieldSchema(name:cd_dep_college_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cd_gender","type":"string","nullable":true,"metadata":{}},{"name":"cd_marital_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_education_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_purchase_estimate","type":"integer","nullable":true,"metadata":{}},{"name":"cd_credit_rating","type":"string","nullable":true,"metadata":{}},{"name":"cd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_employed_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_college_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:customer_demographics, dbName:tpcds, owner:gsd, createTime:1541686576, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:cd_demo_sk, type:int, comment:null), FieldSchema(name:cd_gender, type:string, comment:null), FieldSchema(name:cd_marital_status, type:string, comment:null), FieldSchema(name:cd_education_status, type:string, comment:null), FieldSchema(name:cd_purchase_estimate, type:int, comment:null), FieldSchema(name:cd_credit_rating, type:string, comment:null), FieldSchema(name:cd_dep_count, type:int, comment:null), FieldSchema(name:cd_dep_employed_count, type:int, comment:null), FieldSchema(name:cd_dep_college_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/customer_demographics, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"cd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"cd_gender","type":"string","nullable":true,"metadata":{}},{"name":"cd_marital_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_education_status","type":"string","nullable":true,"metadata":{}},{"name":"cd_purchase_estimate","type":"integer","nullable":true,"metadata":{}},{"name":"cd_credit_rating","type":"string","nullable":true,"metadata":{}},{"name":"cd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_employed_count","type":"integer","nullable":true,"metadata":{}},{"name":"cd_dep_college_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:23 INFO  log:217 - Updating table stats fast for customer_demographics
2018-11-08 14:16:23 INFO  log:219 - Updated size of table customer_demographics to 7763968
2018-11-08 14:16:23 INFO  CliDriver:951 - Time taken: 6.743 seconds
2018-11-08 14:16:23 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists customer_demographics_text
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=customer_demographics_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=customer_demographics_text	
2018-11-08 14:16:23 INFO  CliDriver:951 - Time taken: 0.116 seconds
2018-11-08 14:16:23 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists date_dim_text
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:16:23 INFO  SparkSqlParser:54 - Parsing command: 
create table date_dim_text
(
d_date_sk                 int,
d_date_id                 string,
d_date                    string,
d_month_seq               int,
d_week_seq                int,
d_quarter_seq             int,
d_year                    int,
d_dow                     int,
d_moy                     int,
d_dom                     int,
d_qoy                     int,
d_fy_year                 int,
d_fy_quarter_seq          int,
d_fy_week_seq             int,
d_day_name                string,
d_quarter_name            string,
d_holiday                 string,
d_weekend                 string,
d_following_holiday       string,
d_first_dom               int,
d_last_dom                int,
d_same_day_ly             int,
d_same_day_lq             int,
d_current_day             string,
d_current_week            string,
d_current_month           string,
d_current_quarter         string,
d_current_year            string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/date_dim.csv")

2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`date_dim_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:date_dim_text, dbName:tpcds, owner:gsd, createTime:1541686583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/date_dim.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"d_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"d_date_id","type":"string","nullable":true,"metadata":{}},{"name":"d_date","type":"string","nullable":true,"metadata":{}},{"name":"d_month_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_dow","type":"integer","nullable":true,"metadata":{}},{"name":"d_moy","type":"integer","nullable":true,"metadata":{}},{"name":"d_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_qoy","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_day_name","type":"string","nullable":true,"metadata":{}},{"name":"d_quarter_name","type":"string","nullable":true,"metadata":{}},{"name":"d_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_weekend","type":"string","nullable":true,"metadata":{}},{"name":"d_following_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_first_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_last_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_ly","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_lq","type":"integer","nullable":true,"metadata":{}},{"name":"d_current_day","type":"string","nullable":true,"metadata":{}},{"name":"d_current_week","type":"string","nullable":true,"metadata":{}},{"name":"d_current_month","type":"string","nullable":true,"metadata":{}},{"name":"d_current_quarter","type":"string","nullable":true,"metadata":{}},{"name":"d_current_year","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:date_dim_text, dbName:tpcds, owner:gsd, createTime:1541686583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/date_dim.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"d_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"d_date_id","type":"string","nullable":true,"metadata":{}},{"name":"d_date","type":"string","nullable":true,"metadata":{}},{"name":"d_month_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_dow","type":"integer","nullable":true,"metadata":{}},{"name":"d_moy","type":"integer","nullable":true,"metadata":{}},{"name":"d_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_qoy","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_day_name","type":"string","nullable":true,"metadata":{}},{"name":"d_quarter_name","type":"string","nullable":true,"metadata":{}},{"name":"d_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_weekend","type":"string","nullable":true,"metadata":{}},{"name":"d_following_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_first_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_last_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_ly","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_lq","type":"integer","nullable":true,"metadata":{}},{"name":"d_current_day","type":"string","nullable":true,"metadata":{}},{"name":"d_current_week","type":"string","nullable":true,"metadata":{}},{"name":"d_current_month","type":"string","nullable":true,"metadata":{}},{"name":"d_current_quarter","type":"string","nullable":true,"metadata":{}},{"name":"d_current_year","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:23 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim_text-__PLACEHOLDER__
2018-11-08 14:16:23 INFO  CliDriver:951 - Time taken: 0.078 seconds
2018-11-08 14:16:23 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists date_dim
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim
2018-11-08 14:16:23 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:23 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim
2018-11-08 14:16:23 INFO  CliDriver:951 - Time taken: 0.147 seconds
2018-11-08 14:16:23 INFO  SparkSqlParser:54 - Parsing command: 
create table date_dim
using parquet
as (select * from date_dim_text)

2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:23 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:23 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:23 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:23 INFO  FileSourceStrategy:54 - Output Data Schema: struct<d_date_sk: int, d_date_id: string, d_date: string, d_month_seq: int, d_week_seq: int ... 26 more fields>
2018-11-08 14:16:23 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:23 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:23 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:23 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:23 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:23 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:23 INFO  BlockManagerInfo:54 - Removed broadcast_12_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.0 MB)
2018-11-08 14:16:23 INFO  BlockManagerInfo:54 - Removed broadcast_12_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:23 INFO  BlockManagerInfo:54 - Removed broadcast_12_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:23 INFO  ContextCleaner:54 - Cleaned accumulator 131
2018-11-08 14:16:23 INFO  BlockManagerInfo:54 - Removed broadcast_10_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:23 INFO  MemoryStore:54 - Block broadcast_14 stored as values in memory (estimated size 283.4 KB, free 364.3 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_10_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 97
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 166
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 262
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 200
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 98
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 128
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 229
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 234
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 231
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 161
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 168
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 160
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_4_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:24 INFO  MemoryStore:54 - Block broadcast_14_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Added broadcast_14_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_4_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  SparkContext:54 - Created broadcast 14 from processCmd at CliDriver.java:376
2018-11-08 14:16:24 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 7219346 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 165
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 230
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 235
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 264
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 236
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 233
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_7_piece0 on 192.168.112.64:32870 in memory (size: 34.2 KB, free: 366.1 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_7_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 34.2 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_7_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 34.2 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 198
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 197
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 134
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 162
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 194
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 193
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 159
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 228
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_8_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:24 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_8_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Got job 7 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Final stage: ResultStage 7 (processCmd at CliDriver.java:376)
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Submitting ResultStage 7 (MapPartitionsRDD[22] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_11_piece0 on 192.168.112.64:32870 in memory (size: 33.0 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_11_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.0 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  MemoryStore:54 - Block broadcast_15 stored as values in memory (estimated size 90.2 KB, free 365.3 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 99
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 202
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 201
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 195
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 126
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_13_piece0 on 192.168.112.64:32870 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  MemoryStore:54 - Block broadcast_15_piece0 stored as bytes in memory (estimated size 33.8 KB, free 365.3 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_13_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Added broadcast_15_piece0 in memory on 192.168.112.64:32870 (size: 33.8 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  SparkContext:54 - Created broadcast 15 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:24 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 7 (MapPartitionsRDD[22] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:24 INFO  YarnScheduler:54 - Adding task set 7.0 with 2 tasks
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_13_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  TaskSetManager:54 - Starting task 0.0 in stage 7.0 (TID 13, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5316 bytes)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_6_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_6_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_6_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 227
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 199
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 130
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 164
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 125
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 133
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_9_piece0 on 192.168.112.64:32870 in memory (size: 33.4 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_9_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.4 KB, free: 366.3 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Added broadcast_15_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.8 KB, free: 366.3 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 261
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 129
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 196
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 167
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 163
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 100
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 96
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 263
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 132
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 265
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 127
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_5_piece0 on 192.168.112.64:32870 in memory (size: 33.8 KB, free: 366.2 MB)
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Removed broadcast_5_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 33.8 KB, free: 366.3 MB)
2018-11-08 14:16:24 INFO  ContextCleaner:54 - Cleaned accumulator 232
2018-11-08 14:16:24 INFO  BlockManagerInfo:54 - Added broadcast_14_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:25 INFO  TaskSetManager:54 - Starting task 1.0 in stage 7.0 (TID 14, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, NODE_LOCAL, 5316 bytes)
2018-11-08 14:16:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 7.0 (TID 13) in 1367 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:16:26 INFO  TaskSetManager:54 - Finished task 1.0 in stage 7.0 (TID 14) in 790 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:16:26 INFO  YarnScheduler:54 - Removed TaskSet 7.0, whose tasks have all completed, from pool 
2018-11-08 14:16:26 INFO  DAGScheduler:54 - ResultStage 7 (processCmd at CliDriver.java:376) finished in 2,158 s
2018-11-08 14:16:26 INFO  DAGScheduler:54 - Job 7 finished: processCmd at CliDriver.java:376, took 2,180747 s
2018-11-08 14:16:26 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim	
2018-11-08 14:16:26 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`date_dim` into Hive metastore in Hive compatible format.
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:date_dim, dbName:tpcds, owner:gsd, createTime:1541686583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d_date_sk, type:int, comment:null), FieldSchema(name:d_date_id, type:string, comment:null), FieldSchema(name:d_date, type:string, comment:null), FieldSchema(name:d_month_seq, type:int, comment:null), FieldSchema(name:d_week_seq, type:int, comment:null), FieldSchema(name:d_quarter_seq, type:int, comment:null), FieldSchema(name:d_year, type:int, comment:null), FieldSchema(name:d_dow, type:int, comment:null), FieldSchema(name:d_moy, type:int, comment:null), FieldSchema(name:d_dom, type:int, comment:null), FieldSchema(name:d_qoy, type:int, comment:null), FieldSchema(name:d_fy_year, type:int, comment:null), FieldSchema(name:d_fy_quarter_seq, type:int, comment:null), FieldSchema(name:d_fy_week_seq, type:int, comment:null), FieldSchema(name:d_day_name, type:string, comment:null), FieldSchema(name:d_quarter_name, type:string, comment:null), FieldSchema(name:d_holiday, type:string, comment:null), FieldSchema(name:d_weekend, type:string, comment:null), FieldSchema(name:d_following_holiday, type:string, comment:null), FieldSchema(name:d_first_dom, type:int, comment:null), FieldSchema(name:d_last_dom, type:int, comment:null), FieldSchema(name:d_same_day_ly, type:int, comment:null), FieldSchema(name:d_same_day_lq, type:int, comment:null), FieldSchema(name:d_current_day, type:string, comment:null), FieldSchema(name:d_current_week, type:string, comment:null), FieldSchema(name:d_current_month, type:string, comment:null), FieldSchema(name:d_current_quarter, type:string, comment:null), FieldSchema(name:d_current_year, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"d_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"d_date_id","type":"string","nullable":true,"metadata":{}},{"name":"d_date","type":"string","nullable":true,"metadata":{}},{"name":"d_month_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_dow","type":"integer","nullable":true,"metadata":{}},{"name":"d_moy","type":"integer","nullable":true,"metadata":{}},{"name":"d_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_qoy","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_day_name","type":"string","nullable":true,"metadata":{}},{"name":"d_quarter_name","type":"string","nullable":true,"metadata":{}},{"name":"d_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_weekend","type":"string","nullable":true,"metadata":{}},{"name":"d_following_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_first_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_last_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_ly","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_lq","type":"integer","nullable":true,"metadata":{}},{"name":"d_current_day","type":"string","nullable":true,"metadata":{}},{"name":"d_current_week","type":"string","nullable":true,"metadata":{}},{"name":"d_current_month","type":"string","nullable":true,"metadata":{}},{"name":"d_current_quarter","type":"string","nullable":true,"metadata":{}},{"name":"d_current_year","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:date_dim, dbName:tpcds, owner:gsd, createTime:1541686583, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d_date_sk, type:int, comment:null), FieldSchema(name:d_date_id, type:string, comment:null), FieldSchema(name:d_date, type:string, comment:null), FieldSchema(name:d_month_seq, type:int, comment:null), FieldSchema(name:d_week_seq, type:int, comment:null), FieldSchema(name:d_quarter_seq, type:int, comment:null), FieldSchema(name:d_year, type:int, comment:null), FieldSchema(name:d_dow, type:int, comment:null), FieldSchema(name:d_moy, type:int, comment:null), FieldSchema(name:d_dom, type:int, comment:null), FieldSchema(name:d_qoy, type:int, comment:null), FieldSchema(name:d_fy_year, type:int, comment:null), FieldSchema(name:d_fy_quarter_seq, type:int, comment:null), FieldSchema(name:d_fy_week_seq, type:int, comment:null), FieldSchema(name:d_day_name, type:string, comment:null), FieldSchema(name:d_quarter_name, type:string, comment:null), FieldSchema(name:d_holiday, type:string, comment:null), FieldSchema(name:d_weekend, type:string, comment:null), FieldSchema(name:d_following_holiday, type:string, comment:null), FieldSchema(name:d_first_dom, type:int, comment:null), FieldSchema(name:d_last_dom, type:int, comment:null), FieldSchema(name:d_same_day_ly, type:int, comment:null), FieldSchema(name:d_same_day_lq, type:int, comment:null), FieldSchema(name:d_current_day, type:string, comment:null), FieldSchema(name:d_current_week, type:string, comment:null), FieldSchema(name:d_current_month, type:string, comment:null), FieldSchema(name:d_current_quarter, type:string, comment:null), FieldSchema(name:d_current_year, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/date_dim, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"d_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"d_date_id","type":"string","nullable":true,"metadata":{}},{"name":"d_date","type":"string","nullable":true,"metadata":{}},{"name":"d_month_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_dow","type":"integer","nullable":true,"metadata":{}},{"name":"d_moy","type":"integer","nullable":true,"metadata":{}},{"name":"d_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_qoy","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_year","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_quarter_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_fy_week_seq","type":"integer","nullable":true,"metadata":{}},{"name":"d_day_name","type":"string","nullable":true,"metadata":{}},{"name":"d_quarter_name","type":"string","nullable":true,"metadata":{}},{"name":"d_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_weekend","type":"string","nullable":true,"metadata":{}},{"name":"d_following_holiday","type":"string","nullable":true,"metadata":{}},{"name":"d_first_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_last_dom","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_ly","type":"integer","nullable":true,"metadata":{}},{"name":"d_same_day_lq","type":"integer","nullable":true,"metadata":{}},{"name":"d_current_day","type":"string","nullable":true,"metadata":{}},{"name":"d_current_week","type":"string","nullable":true,"metadata":{}},{"name":"d_current_month","type":"string","nullable":true,"metadata":{}},{"name":"d_current_quarter","type":"string","nullable":true,"metadata":{}},{"name":"d_current_year","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:26 INFO  log:217 - Updating table stats fast for date_dim
2018-11-08 14:16:26 INFO  log:219 - Updated size of table date_dim to 1858952
2018-11-08 14:16:26 INFO  CliDriver:951 - Time taken: 2.647 seconds
2018-11-08 14:16:26 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists date_dim_text
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=date_dim_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=date_dim_text	
2018-11-08 14:16:26 INFO  CliDriver:951 - Time taken: 0.159 seconds
2018-11-08 14:16:26 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists household_demographics_text
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:16:26 INFO  SparkSqlParser:54 - Parsing command: 
create table household_demographics_text
(
hd_demo_sk                int,
hd_income_band_sk         int,
hd_buy_potential          string,
hd_dep_count              int,
hd_vehicle_count          int
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/household_demographics.csv")

2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`household_demographics_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:household_demographics_text, dbName:tpcds, owner:gsd, createTime:1541686586, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/household_demographics.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"hd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_buy_potential","type":"string","nullable":true,"metadata":{}},{"name":"hd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"hd_vehicle_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:household_demographics_text, dbName:tpcds, owner:gsd, createTime:1541686586, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/household_demographics.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"hd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_buy_potential","type":"string","nullable":true,"metadata":{}},{"name":"hd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"hd_vehicle_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:26 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics_text-__PLACEHOLDER__
2018-11-08 14:16:26 INFO  CliDriver:951 - Time taken: 0.096 seconds
2018-11-08 14:16:26 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists household_demographics
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics
2018-11-08 14:16:26 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:26 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics
2018-11-08 14:16:26 INFO  CliDriver:951 - Time taken: 0.131 seconds
2018-11-08 14:16:26 INFO  SparkSqlParser:54 - Parsing command: 
create table household_demographics
using parquet
as (select * from household_demographics_text)

2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:26 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:26 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:26 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:26 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:26 INFO  FileSourceStrategy:54 - Output Data Schema: struct<hd_demo_sk: int, hd_income_band_sk: int, hd_buy_potential: string, hd_dep_count: int, hd_vehicle_count: int ... 3 more fields>
2018-11-08 14:16:26 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:26 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:26 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:26 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:27 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:27 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:27 INFO  MemoryStore:54 - Block broadcast_16 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:16:27 INFO  MemoryStore:54 - Block broadcast_16_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:16:27 INFO  BlockManagerInfo:54 - Added broadcast_16_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:27 INFO  SparkContext:54 - Created broadcast 16 from processCmd at CliDriver.java:376
2018-11-08 14:16:27 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:27 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Got job 8 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Final stage: ResultStage 8 (processCmd at CliDriver.java:376)
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Submitting ResultStage 8 (MapPartitionsRDD[25] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:27 INFO  MemoryStore:54 - Block broadcast_17 stored as values in memory (estimated size 84.6 KB, free 365.5 MB)
2018-11-08 14:16:27 INFO  MemoryStore:54 - Block broadcast_17_piece0 stored as bytes in memory (estimated size 32.5 KB, free 365.5 MB)
2018-11-08 14:16:27 INFO  BlockManagerInfo:54 - Added broadcast_17_piece0 in memory on 192.168.112.64:32870 (size: 32.5 KB, free: 366.2 MB)
2018-11-08 14:16:27 INFO  SparkContext:54 - Created broadcast 17 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[25] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:27 INFO  YarnScheduler:54 - Adding task set 8.0 with 1 tasks
2018-11-08 14:16:27 INFO  TaskSetManager:54 - Starting task 0.0 in stage 8.0 (TID 15, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5330 bytes)
2018-11-08 14:16:27 INFO  BlockManagerInfo:54 - Added broadcast_17_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 32.5 KB, free: 366.3 MB)
2018-11-08 14:16:27 INFO  BlockManagerInfo:54 - Added broadcast_16_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:27 INFO  TaskSetManager:54 - Finished task 0.0 in stage 8.0 (TID 15) in 586 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/1)
2018-11-08 14:16:27 INFO  YarnScheduler:54 - Removed TaskSet 8.0, whose tasks have all completed, from pool 
2018-11-08 14:16:27 INFO  DAGScheduler:54 - ResultStage 8 (processCmd at CliDriver.java:376) finished in 0,587 s
2018-11-08 14:16:27 INFO  DAGScheduler:54 - Job 8 finished: processCmd at CliDriver.java:376, took 0,608076 s
2018-11-08 14:16:27 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics	
2018-11-08 14:16:27 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`household_demographics` into Hive metastore in Hive compatible format.
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:household_demographics, dbName:tpcds, owner:gsd, createTime:1541686586, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:hd_demo_sk, type:int, comment:null), FieldSchema(name:hd_income_band_sk, type:int, comment:null), FieldSchema(name:hd_buy_potential, type:string, comment:null), FieldSchema(name:hd_dep_count, type:int, comment:null), FieldSchema(name:hd_vehicle_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"hd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_buy_potential","type":"string","nullable":true,"metadata":{}},{"name":"hd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"hd_vehicle_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:household_demographics, dbName:tpcds, owner:gsd, createTime:1541686586, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:hd_demo_sk, type:int, comment:null), FieldSchema(name:hd_income_band_sk, type:int, comment:null), FieldSchema(name:hd_buy_potential, type:string, comment:null), FieldSchema(name:hd_dep_count, type:int, comment:null), FieldSchema(name:hd_vehicle_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/household_demographics, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"hd_demo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"hd_buy_potential","type":"string","nullable":true,"metadata":{}},{"name":"hd_dep_count","type":"integer","nullable":true,"metadata":{}},{"name":"hd_vehicle_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:27 INFO  log:217 - Updating table stats fast for household_demographics
2018-11-08 14:16:27 INFO  log:219 - Updated size of table household_demographics to 30741
2018-11-08 14:16:27 INFO  CliDriver:951 - Time taken: 0.825 seconds
2018-11-08 14:16:27 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists household_demographics_text
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=household_demographics_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=household_demographics_text	
2018-11-08 14:16:27 INFO  CliDriver:951 - Time taken: 0.106 seconds
2018-11-08 14:16:27 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists income_band_text
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:27 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:16:27 INFO  SparkSqlParser:54 - Parsing command: 
create table income_band_text
(
ib_income_band_sk         int,
ib_lower_bound            int,
ib_upper_bound            int
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/income_band.csv")

2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:27 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`income_band_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:income_band_text, dbName:tpcds, owner:gsd, createTime:1541686587, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/income_band_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/income_band.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ib_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ib_lower_bound","type":"integer","nullable":true,"metadata":{}},{"name":"ib_upper_bound","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:income_band_text, dbName:tpcds, owner:gsd, createTime:1541686587, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/income_band_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/income_band.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ib_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ib_lower_bound","type":"integer","nullable":true,"metadata":{}},{"name":"ib_upper_bound","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:27 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/income_band_text-__PLACEHOLDER__
2018-11-08 14:16:27 INFO  CliDriver:951 - Time taken: 0.091 seconds
2018-11-08 14:16:27 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists income_band
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:27 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:27 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/income_band
2018-11-08 14:16:28 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:28 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/income_band
2018-11-08 14:16:28 INFO  CliDriver:951 - Time taken: 0.115 seconds
2018-11-08 14:16:28 INFO  SparkSqlParser:54 - Parsing command: 
create table income_band
using parquet
as (select * from income_band_text)

2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:28 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:28 INFO  FileSourceStrategy:54 - Output Data Schema: struct<ib_income_band_sk: int, ib_lower_bound: int, ib_upper_bound: int ... 1 more fields>
2018-11-08 14:16:28 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:28 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:28 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:28 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:28 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:28 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:28 INFO  MemoryStore:54 - Block broadcast_18 stored as values in memory (estimated size 283.4 KB, free 365.2 MB)
2018-11-08 14:16:28 INFO  MemoryStore:54 - Block broadcast_18_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.2 MB)
2018-11-08 14:16:28 INFO  BlockManagerInfo:54 - Added broadcast_18_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:28 INFO  SparkContext:54 - Created broadcast 18 from processCmd at CliDriver.java:376
2018-11-08 14:16:28 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:28 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Got job 9 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Final stage: ResultStage 9 (processCmd at CliDriver.java:376)
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Submitting ResultStage 9 (MapPartitionsRDD[28] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:28 INFO  MemoryStore:54 - Block broadcast_19 stored as values in memory (estimated size 84.0 KB, free 365.1 MB)
2018-11-08 14:16:28 INFO  MemoryStore:54 - Block broadcast_19_piece0 stored as bytes in memory (estimated size 32.3 KB, free 365.1 MB)
2018-11-08 14:16:28 INFO  BlockManagerInfo:54 - Added broadcast_19_piece0 in memory on 192.168.112.64:32870 (size: 32.3 KB, free: 366.1 MB)
2018-11-08 14:16:28 INFO  SparkContext:54 - Created broadcast 19 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[28] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:28 INFO  YarnScheduler:54 - Adding task set 9.0 with 1 tasks
2018-11-08 14:16:28 INFO  TaskSetManager:54 - Starting task 0.0 in stage 9.0 (TID 16, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5319 bytes)
2018-11-08 14:16:28 INFO  BlockManagerInfo:54 - Added broadcast_19_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.3 KB, free: 366.2 MB)
2018-11-08 14:16:28 INFO  BlockManagerInfo:54 - Added broadcast_18_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:28 INFO  TaskSetManager:54 - Finished task 0.0 in stage 9.0 (TID 16) in 619 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:16:28 INFO  YarnScheduler:54 - Removed TaskSet 9.0, whose tasks have all completed, from pool 
2018-11-08 14:16:28 INFO  DAGScheduler:54 - ResultStage 9 (processCmd at CliDriver.java:376) finished in 0,620 s
2018-11-08 14:16:28 INFO  DAGScheduler:54 - Job 9 finished: processCmd at CliDriver.java:376, took 0,637135 s
2018-11-08 14:16:28 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band	
2018-11-08 14:16:28 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`income_band` into Hive metastore in Hive compatible format.
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:income_band, dbName:tpcds, owner:gsd, createTime:1541686588, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ib_income_band_sk, type:int, comment:null), FieldSchema(name:ib_lower_bound, type:int, comment:null), FieldSchema(name:ib_upper_bound, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/income_band, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ib_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ib_lower_bound","type":"integer","nullable":true,"metadata":{}},{"name":"ib_upper_bound","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:income_band, dbName:tpcds, owner:gsd, createTime:1541686588, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ib_income_band_sk, type:int, comment:null), FieldSchema(name:ib_lower_bound, type:int, comment:null), FieldSchema(name:ib_upper_bound, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/income_band, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ib_income_band_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ib_lower_bound","type":"integer","nullable":true,"metadata":{}},{"name":"ib_upper_bound","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:28 INFO  log:217 - Updating table stats fast for income_band
2018-11-08 14:16:28 INFO  log:219 - Updated size of table income_band to 1062
2018-11-08 14:16:28 INFO  CliDriver:951 - Time taken: 0.825 seconds
2018-11-08 14:16:28 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists income_band_text
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:28 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=income_band_text
2018-11-08 14:16:28 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=income_band_text	
2018-11-08 14:16:29 INFO  CliDriver:951 - Time taken: 0.099 seconds
2018-11-08 14:16:29 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists inventory_text
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:16:29 INFO  SparkSqlParser:54 - Parsing command: 
create table inventory_text
(
inv_date_sk               int,
inv_item_sk               int,
inv_warehouse_sk          int,
inv_quantity_on_hand      bigint
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/inventory.csv")

2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`inventory_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:inventory_text, dbName:tpcds, owner:gsd, createTime:1541686589, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/inventory_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/inventory.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"inv_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_quantity_on_hand","type":"long","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:inventory_text, dbName:tpcds, owner:gsd, createTime:1541686589, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/inventory_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/inventory.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"inv_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_quantity_on_hand","type":"long","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:29 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/inventory_text-__PLACEHOLDER__
2018-11-08 14:16:29 INFO  CliDriver:951 - Time taken: 0.137 seconds
2018-11-08 14:16:29 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists inventory
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: bigint
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: bigint
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/inventory
2018-11-08 14:16:29 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:29 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/inventory
2018-11-08 14:16:29 INFO  CliDriver:951 - Time taken: 0.124 seconds
2018-11-08 14:16:29 INFO  SparkSqlParser:54 - Parsing command: 
create table inventory
using parquet
as (select * from inventory_text)

2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:29 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:29 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:29 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:29 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:29 INFO  FileSourceStrategy:54 - Output Data Schema: struct<inv_date_sk: int, inv_item_sk: int, inv_warehouse_sk: int, inv_quantity_on_hand: bigint ... 2 more fields>
2018-11-08 14:16:29 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:29 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:29 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:29 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:29 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:29 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:29 INFO  MemoryStore:54 - Block broadcast_20 stored as values in memory (estimated size 283.4 KB, free 364.8 MB)
2018-11-08 14:16:29 INFO  MemoryStore:54 - Block broadcast_20_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-11-08 14:16:29 INFO  BlockManagerInfo:54 - Added broadcast_20_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:29 INFO  SparkContext:54 - Created broadcast 20 from processCmd at CliDriver.java:376
2018-11-08 14:16:29 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 114434721 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:29 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Got job 10 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Final stage: ResultStage 10 (processCmd at CliDriver.java:376)
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Submitting ResultStage 10 (MapPartitionsRDD[31] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:29 INFO  MemoryStore:54 - Block broadcast_21 stored as values in memory (estimated size 84.4 KB, free 364.7 MB)
2018-11-08 14:16:29 INFO  MemoryStore:54 - Block broadcast_21_piece0 stored as bytes in memory (estimated size 32.4 KB, free 364.6 MB)
2018-11-08 14:16:29 INFO  BlockManagerInfo:54 - Added broadcast_21_piece0 in memory on 192.168.112.64:32870 (size: 32.4 KB, free: 366.1 MB)
2018-11-08 14:16:29 INFO  SparkContext:54 - Created broadcast 21 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:29 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 10 (MapPartitionsRDD[31] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:29 INFO  YarnScheduler:54 - Adding task set 10.0 with 2 tasks
2018-11-08 14:16:29 INFO  TaskSetManager:54 - Starting task 0.0 in stage 10.0 (TID 17, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5317 bytes)
2018-11-08 14:16:29 INFO  BlockManagerInfo:54 - Added broadcast_21_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.4 KB, free: 366.2 MB)
2018-11-08 14:16:29 INFO  BlockManagerInfo:54 - Added broadcast_20_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:32 INFO  TaskSetManager:54 - Starting task 1.0 in stage 10.0 (TID 18, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, RACK_LOCAL, 5317 bytes)
2018-11-08 14:16:32 INFO  BlockManagerInfo:54 - Added broadcast_21_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 32.4 KB, free: 366.2 MB)
2018-11-08 14:16:32 INFO  BlockManagerInfo:54 - Added broadcast_20_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:39 INFO  TaskSetManager:54 - Finished task 1.0 in stage 10.0 (TID 18) in 6980 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/2)
2018-11-08 14:16:42 INFO  TaskSetManager:54 - Finished task 0.0 in stage 10.0 (TID 17) in 12629 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:16:42 INFO  YarnScheduler:54 - Removed TaskSet 10.0, whose tasks have all completed, from pool 
2018-11-08 14:16:42 INFO  DAGScheduler:54 - ResultStage 10 (processCmd at CliDriver.java:376) finished in 12,630 s
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Job 10 finished: processCmd at CliDriver.java:376, took 12,645782 s
2018-11-08 14:16:42 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory	
2018-11-08 14:16:42 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`inventory` into Hive metastore in Hive compatible format.
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:inventory, dbName:tpcds, owner:gsd, createTime:1541686589, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:inv_date_sk, type:int, comment:null), FieldSchema(name:inv_item_sk, type:int, comment:null), FieldSchema(name:inv_warehouse_sk, type:int, comment:null), FieldSchema(name:inv_quantity_on_hand, type:bigint, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/inventory, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"inv_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_quantity_on_hand","type":"long","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:inventory, dbName:tpcds, owner:gsd, createTime:1541686589, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:inv_date_sk, type:int, comment:null), FieldSchema(name:inv_item_sk, type:int, comment:null), FieldSchema(name:inv_warehouse_sk, type:int, comment:null), FieldSchema(name:inv_quantity_on_hand, type:bigint, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/inventory, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"inv_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"inv_quantity_on_hand","type":"long","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:42 INFO  log:217 - Updating table stats fast for inventory
2018-11-08 14:16:42 INFO  log:219 - Updated size of table inventory to 21169916
2018-11-08 14:16:42 INFO  CliDriver:951 - Time taken: 12.863 seconds
2018-11-08 14:16:42 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists inventory_text
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=inventory_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=inventory_text	
2018-11-08 14:16:42 INFO  CliDriver:951 - Time taken: 0.092 seconds
2018-11-08 14:16:42 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists item_text
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:16:42 INFO  SparkSqlParser:54 - Parsing command: 
create table item_text
(
i_item_sk                 int,
i_item_id                 string,
i_rec_start_date          string,
i_rec_end_date            string,
i_item_desc               string,
i_current_price           double,
i_wholesale_cost          double,
i_brand_id                int,
i_brand                   string,
i_class_id                int,
i_class                   string,
i_category_id             int,
i_category                string,
i_manufact_id             int,
i_manufact                string,
i_size                    string,
i_formulation             string,
i_color                   string,
i_units                   string,
i_container               string,
i_manager_id              int,
i_product_name            string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/item.csv")

2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`item_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:item_text, dbName:tpcds, owner:gsd, createTime:1541686602, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/item_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/item.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"i_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"i_item_id","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"i_item_desc","type":"string","nullable":true,"metadata":{}},{"name":"i_current_price","type":"double","nullable":true,"metadata":{}},{"name":"i_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"i_brand_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_brand","type":"string","nullable":true,"metadata":{}},{"name":"i_class_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_class","type":"string","nullable":true,"metadata":{}},{"name":"i_category_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_category","type":"string","nullable":true,"metadata":{}},{"name":"i_manufact_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_manufact","type":"string","nullable":true,"metadata":{}},{"name":"i_size","type":"string","nullable":true,"metadata":{}},{"name":"i_formulation","type":"string","nullable":true,"metadata":{}},{"name":"i_color","type":"string","nullable":true,"metadata":{}},{"name":"i_units","type":"string","nullable":true,"metadata":{}},{"name":"i_container","type":"string","nullable":true,"metadata":{}},{"name":"i_manager_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_product_name","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:item_text, dbName:tpcds, owner:gsd, createTime:1541686602, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/item_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/item.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"i_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"i_item_id","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"i_item_desc","type":"string","nullable":true,"metadata":{}},{"name":"i_current_price","type":"double","nullable":true,"metadata":{}},{"name":"i_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"i_brand_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_brand","type":"string","nullable":true,"metadata":{}},{"name":"i_class_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_class","type":"string","nullable":true,"metadata":{}},{"name":"i_category_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_category","type":"string","nullable":true,"metadata":{}},{"name":"i_manufact_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_manufact","type":"string","nullable":true,"metadata":{}},{"name":"i_size","type":"string","nullable":true,"metadata":{}},{"name":"i_formulation","type":"string","nullable":true,"metadata":{}},{"name":"i_color","type":"string","nullable":true,"metadata":{}},{"name":"i_units","type":"string","nullable":true,"metadata":{}},{"name":"i_container","type":"string","nullable":true,"metadata":{}},{"name":"i_manager_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_product_name","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:42 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/item_text-__PLACEHOLDER__
2018-11-08 14:16:42 INFO  CliDriver:951 - Time taken: 0.083 seconds
2018-11-08 14:16:42 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists item
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/item
2018-11-08 14:16:42 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:42 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/item
2018-11-08 14:16:42 INFO  CliDriver:951 - Time taken: 0.139 seconds
2018-11-08 14:16:42 INFO  SparkSqlParser:54 - Parsing command: 
create table item
using parquet
as (select * from item_text)

2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:42 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:42 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:42 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:42 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:42 INFO  FileSourceStrategy:54 - Output Data Schema: struct<i_item_sk: int, i_item_id: string, i_rec_start_date: string, i_rec_end_date: string, i_item_desc: string ... 20 more fields>
2018-11-08 14:16:42 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:42 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:42 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:42 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:42 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:42 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:42 INFO  MemoryStore:54 - Block broadcast_22 stored as values in memory (estimated size 283.4 KB, free 364.4 MB)
2018-11-08 14:16:42 INFO  MemoryStore:54 - Block broadcast_22_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.3 MB)
2018-11-08 14:16:42 INFO  BlockManagerInfo:54 - Added broadcast_22_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:42 INFO  SparkContext:54 - Created broadcast 22 from processCmd at CliDriver.java:376
2018-11-08 14:16:42 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4614101 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:42 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Got job 11 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Final stage: ResultStage 11 (processCmd at CliDriver.java:376)
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Submitting ResultStage 11 (MapPartitionsRDD[34] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:42 INFO  MemoryStore:54 - Block broadcast_23 stored as values in memory (estimated size 88.8 KB, free 364.3 MB)
2018-11-08 14:16:42 INFO  MemoryStore:54 - Block broadcast_23_piece0 stored as bytes in memory (estimated size 33.6 KB, free 364.2 MB)
2018-11-08 14:16:42 INFO  BlockManagerInfo:54 - Added broadcast_23_piece0 in memory on 192.168.112.64:32870 (size: 33.6 KB, free: 366.0 MB)
2018-11-08 14:16:42 INFO  SparkContext:54 - Created broadcast 23 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:42 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 11 (MapPartitionsRDD[34] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:42 INFO  YarnScheduler:54 - Adding task set 11.0 with 2 tasks
2018-11-08 14:16:42 INFO  TaskSetManager:54 - Starting task 0.0 in stage 11.0 (TID 19, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5312 bytes)
2018-11-08 14:16:42 INFO  BlockManagerInfo:54 - Added broadcast_23_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 33.6 KB, free: 366.2 MB)
2018-11-08 14:16:42 INFO  BlockManagerInfo:54 - Added broadcast_22_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:43 INFO  TaskSetManager:54 - Starting task 1.0 in stage 11.0 (TID 20, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, NODE_LOCAL, 5312 bytes)
2018-11-08 14:16:43 INFO  TaskSetManager:54 - Finished task 0.0 in stage 11.0 (TID 19) in 866 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/2)
2018-11-08 14:16:43 INFO  TaskSetManager:54 - Finished task 1.0 in stage 11.0 (TID 20) in 541 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (2/2)
2018-11-08 14:16:43 INFO  YarnScheduler:54 - Removed TaskSet 11.0, whose tasks have all completed, from pool 
2018-11-08 14:16:43 INFO  DAGScheduler:54 - ResultStage 11 (processCmd at CliDriver.java:376) finished in 1,408 s
2018-11-08 14:16:43 INFO  DAGScheduler:54 - Job 11 finished: processCmd at CliDriver.java:376, took 1,426843 s
2018-11-08 14:16:44 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item	
2018-11-08 14:16:44 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`item` into Hive metastore in Hive compatible format.
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:item, dbName:tpcds, owner:gsd, createTime:1541686602, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i_item_sk, type:int, comment:null), FieldSchema(name:i_item_id, type:string, comment:null), FieldSchema(name:i_rec_start_date, type:string, comment:null), FieldSchema(name:i_rec_end_date, type:string, comment:null), FieldSchema(name:i_item_desc, type:string, comment:null), FieldSchema(name:i_current_price, type:double, comment:null), FieldSchema(name:i_wholesale_cost, type:double, comment:null), FieldSchema(name:i_brand_id, type:int, comment:null), FieldSchema(name:i_brand, type:string, comment:null), FieldSchema(name:i_class_id, type:int, comment:null), FieldSchema(name:i_class, type:string, comment:null), FieldSchema(name:i_category_id, type:int, comment:null), FieldSchema(name:i_category, type:string, comment:null), FieldSchema(name:i_manufact_id, type:int, comment:null), FieldSchema(name:i_manufact, type:string, comment:null), FieldSchema(name:i_size, type:string, comment:null), FieldSchema(name:i_formulation, type:string, comment:null), FieldSchema(name:i_color, type:string, comment:null), FieldSchema(name:i_units, type:string, comment:null), FieldSchema(name:i_container, type:string, comment:null), FieldSchema(name:i_manager_id, type:int, comment:null), FieldSchema(name:i_product_name, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/item, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"i_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"i_item_id","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"i_item_desc","type":"string","nullable":true,"metadata":{}},{"name":"i_current_price","type":"double","nullable":true,"metadata":{}},{"name":"i_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"i_brand_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_brand","type":"string","nullable":true,"metadata":{}},{"name":"i_class_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_class","type":"string","nullable":true,"metadata":{}},{"name":"i_category_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_category","type":"string","nullable":true,"metadata":{}},{"name":"i_manufact_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_manufact","type":"string","nullable":true,"metadata":{}},{"name":"i_size","type":"string","nullable":true,"metadata":{}},{"name":"i_formulation","type":"string","nullable":true,"metadata":{}},{"name":"i_color","type":"string","nullable":true,"metadata":{}},{"name":"i_units","type":"string","nullable":true,"metadata":{}},{"name":"i_container","type":"string","nullable":true,"metadata":{}},{"name":"i_manager_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_product_name","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:item, dbName:tpcds, owner:gsd, createTime:1541686602, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:i_item_sk, type:int, comment:null), FieldSchema(name:i_item_id, type:string, comment:null), FieldSchema(name:i_rec_start_date, type:string, comment:null), FieldSchema(name:i_rec_end_date, type:string, comment:null), FieldSchema(name:i_item_desc, type:string, comment:null), FieldSchema(name:i_current_price, type:double, comment:null), FieldSchema(name:i_wholesale_cost, type:double, comment:null), FieldSchema(name:i_brand_id, type:int, comment:null), FieldSchema(name:i_brand, type:string, comment:null), FieldSchema(name:i_class_id, type:int, comment:null), FieldSchema(name:i_class, type:string, comment:null), FieldSchema(name:i_category_id, type:int, comment:null), FieldSchema(name:i_category, type:string, comment:null), FieldSchema(name:i_manufact_id, type:int, comment:null), FieldSchema(name:i_manufact, type:string, comment:null), FieldSchema(name:i_size, type:string, comment:null), FieldSchema(name:i_formulation, type:string, comment:null), FieldSchema(name:i_color, type:string, comment:null), FieldSchema(name:i_units, type:string, comment:null), FieldSchema(name:i_container, type:string, comment:null), FieldSchema(name:i_manager_id, type:int, comment:null), FieldSchema(name:i_product_name, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/item, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"i_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"i_item_id","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"i_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"i_item_desc","type":"string","nullable":true,"metadata":{}},{"name":"i_current_price","type":"double","nullable":true,"metadata":{}},{"name":"i_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"i_brand_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_brand","type":"string","nullable":true,"metadata":{}},{"name":"i_class_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_class","type":"string","nullable":true,"metadata":{}},{"name":"i_category_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_category","type":"string","nullable":true,"metadata":{}},{"name":"i_manufact_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_manufact","type":"string","nullable":true,"metadata":{}},{"name":"i_size","type":"string","nullable":true,"metadata":{}},{"name":"i_formulation","type":"string","nullable":true,"metadata":{}},{"name":"i_color","type":"string","nullable":true,"metadata":{}},{"name":"i_units","type":"string","nullable":true,"metadata":{}},{"name":"i_container","type":"string","nullable":true,"metadata":{}},{"name":"i_manager_id","type":"integer","nullable":true,"metadata":{}},{"name":"i_product_name","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:44 INFO  log:217 - Updating table stats fast for item
2018-11-08 14:16:44 INFO  log:219 - Updated size of table item to 1778629
2018-11-08 14:16:44 INFO  CliDriver:951 - Time taken: 1.653 seconds
2018-11-08 14:16:44 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists item_text
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=item_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=item_text	
2018-11-08 14:16:44 INFO  CliDriver:951 - Time taken: 0.099 seconds
2018-11-08 14:16:44 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists promotion_text
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 INFO  CliDriver:951 - Time taken: 0.01 seconds
2018-11-08 14:16:44 INFO  SparkSqlParser:54 - Parsing command: 
create table promotion_text
(
p_promo_sk                int,
p_promo_id                string,
p_start_date_sk           int,
p_end_date_sk             int,
p_item_sk                 int,
p_cost                    double,
p_response_target         int,
p_promo_name              string,
p_channel_dmail           string,
p_channel_email           string,
p_channel_catalog         string,
p_channel_tv              string,
p_channel_radio           string,
p_channel_press           string,
p_channel_event           string,
p_channel_demo            string,
p_channel_details         string,
p_purpose                 string,
p_discount_active         string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/promotion.csv")

2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`promotion_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:promotion_text, dbName:tpcds, owner:gsd, createTime:1541686604, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/promotion_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/promotion.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"p_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_id","type":"string","nullable":true,"metadata":{}},{"name":"p_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_cost","type":"double","nullable":true,"metadata":{}},{"name":"p_response_target","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_name","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_dmail","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_email","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_catalog","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_tv","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_radio","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_press","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_event","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_demo","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_details","type":"string","nullable":true,"metadata":{}},{"name":"p_purpose","type":"string","nullable":true,"metadata":{}},{"name":"p_discount_active","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:promotion_text, dbName:tpcds, owner:gsd, createTime:1541686604, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/promotion_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/promotion.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"p_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_id","type":"string","nullable":true,"metadata":{}},{"name":"p_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_cost","type":"double","nullable":true,"metadata":{}},{"name":"p_response_target","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_name","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_dmail","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_email","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_catalog","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_tv","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_radio","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_press","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_event","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_demo","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_details","type":"string","nullable":true,"metadata":{}},{"name":"p_purpose","type":"string","nullable":true,"metadata":{}},{"name":"p_discount_active","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:44 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/promotion_text-__PLACEHOLDER__
2018-11-08 14:16:44 INFO  CliDriver:951 - Time taken: 0.09 seconds
2018-11-08 14:16:44 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists promotion
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/promotion
2018-11-08 14:16:44 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:44 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/promotion
2018-11-08 14:16:44 INFO  CliDriver:951 - Time taken: 0.139 seconds
2018-11-08 14:16:44 INFO  SparkSqlParser:54 - Parsing command: 
create table promotion
using parquet
as (select * from promotion_text)

2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:44 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:44 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:44 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:44 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:44 INFO  FileSourceStrategy:54 - Output Data Schema: struct<p_promo_sk: int, p_promo_id: string, p_start_date_sk: int, p_end_date_sk: int, p_item_sk: int ... 17 more fields>
2018-11-08 14:16:44 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:44 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:44 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:44 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:44 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:44 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:44 INFO  MemoryStore:54 - Block broadcast_24 stored as values in memory (estimated size 283.4 KB, free 363.9 MB)
2018-11-08 14:16:44 INFO  MemoryStore:54 - Block broadcast_24_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-11-08 14:16:44 INFO  BlockManagerInfo:54 - Added broadcast_24_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.0 MB)
2018-11-08 14:16:44 INFO  SparkContext:54 - Created broadcast 24 from processCmd at CliDriver.java:376
2018-11-08 14:16:44 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:44 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Got job 12 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Final stage: ResultStage 12 (processCmd at CliDriver.java:376)
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Submitting ResultStage 12 (MapPartitionsRDD[37] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:44 INFO  MemoryStore:54 - Block broadcast_25 stored as values in memory (estimated size 88.1 KB, free 363.8 MB)
2018-11-08 14:16:44 INFO  MemoryStore:54 - Block broadcast_25_piece0 stored as bytes in memory (estimated size 33.4 KB, free 363.8 MB)
2018-11-08 14:16:44 INFO  BlockManagerInfo:54 - Added broadcast_25_piece0 in memory on 192.168.112.64:32870 (size: 33.4 KB, free: 366.0 MB)
2018-11-08 14:16:44 INFO  SparkContext:54 - Created broadcast 25 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:44 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 12 (MapPartitionsRDD[37] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:44 INFO  YarnScheduler:54 - Adding task set 12.0 with 1 tasks
2018-11-08 14:16:44 INFO  TaskSetManager:54 - Starting task 0.0 in stage 12.0 (TID 21, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5317 bytes)
2018-11-08 14:16:44 INFO  BlockManagerInfo:54 - Added broadcast_25_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 33.4 KB, free: 366.1 MB)
2018-11-08 14:16:44 INFO  BlockManagerInfo:54 - Added broadcast_24_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 12.0 (TID 21) in 547 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/1)
2018-11-08 14:16:45 INFO  YarnScheduler:54 - Removed TaskSet 12.0, whose tasks have all completed, from pool 
2018-11-08 14:16:45 INFO  DAGScheduler:54 - ResultStage 12 (processCmd at CliDriver.java:376) finished in 0,548 s
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Job 12 finished: processCmd at CliDriver.java:376, took 0,567156 s
2018-11-08 14:16:45 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion	
2018-11-08 14:16:45 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`promotion` into Hive metastore in Hive compatible format.
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:promotion, dbName:tpcds, owner:gsd, createTime:1541686604, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:p_promo_sk, type:int, comment:null), FieldSchema(name:p_promo_id, type:string, comment:null), FieldSchema(name:p_start_date_sk, type:int, comment:null), FieldSchema(name:p_end_date_sk, type:int, comment:null), FieldSchema(name:p_item_sk, type:int, comment:null), FieldSchema(name:p_cost, type:double, comment:null), FieldSchema(name:p_response_target, type:int, comment:null), FieldSchema(name:p_promo_name, type:string, comment:null), FieldSchema(name:p_channel_dmail, type:string, comment:null), FieldSchema(name:p_channel_email, type:string, comment:null), FieldSchema(name:p_channel_catalog, type:string, comment:null), FieldSchema(name:p_channel_tv, type:string, comment:null), FieldSchema(name:p_channel_radio, type:string, comment:null), FieldSchema(name:p_channel_press, type:string, comment:null), FieldSchema(name:p_channel_event, type:string, comment:null), FieldSchema(name:p_channel_demo, type:string, comment:null), FieldSchema(name:p_channel_details, type:string, comment:null), FieldSchema(name:p_purpose, type:string, comment:null), FieldSchema(name:p_discount_active, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/promotion, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"p_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_id","type":"string","nullable":true,"metadata":{}},{"name":"p_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_cost","type":"double","nullable":true,"metadata":{}},{"name":"p_response_target","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_name","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_dmail","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_email","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_catalog","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_tv","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_radio","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_press","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_event","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_demo","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_details","type":"string","nullable":true,"metadata":{}},{"name":"p_purpose","type":"string","nullable":true,"metadata":{}},{"name":"p_discount_active","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:promotion, dbName:tpcds, owner:gsd, createTime:1541686604, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:p_promo_sk, type:int, comment:null), FieldSchema(name:p_promo_id, type:string, comment:null), FieldSchema(name:p_start_date_sk, type:int, comment:null), FieldSchema(name:p_end_date_sk, type:int, comment:null), FieldSchema(name:p_item_sk, type:int, comment:null), FieldSchema(name:p_cost, type:double, comment:null), FieldSchema(name:p_response_target, type:int, comment:null), FieldSchema(name:p_promo_name, type:string, comment:null), FieldSchema(name:p_channel_dmail, type:string, comment:null), FieldSchema(name:p_channel_email, type:string, comment:null), FieldSchema(name:p_channel_catalog, type:string, comment:null), FieldSchema(name:p_channel_tv, type:string, comment:null), FieldSchema(name:p_channel_radio, type:string, comment:null), FieldSchema(name:p_channel_press, type:string, comment:null), FieldSchema(name:p_channel_event, type:string, comment:null), FieldSchema(name:p_channel_demo, type:string, comment:null), FieldSchema(name:p_channel_details, type:string, comment:null), FieldSchema(name:p_purpose, type:string, comment:null), FieldSchema(name:p_discount_active, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/promotion, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"p_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_id","type":"string","nullable":true,"metadata":{}},{"name":"p_start_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_end_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"p_cost","type":"double","nullable":true,"metadata":{}},{"name":"p_response_target","type":"integer","nullable":true,"metadata":{}},{"name":"p_promo_name","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_dmail","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_email","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_catalog","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_tv","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_radio","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_press","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_event","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_demo","type":"string","nullable":true,"metadata":{}},{"name":"p_channel_details","type":"string","nullable":true,"metadata":{}},{"name":"p_purpose","type":"string","nullable":true,"metadata":{}},{"name":"p_discount_active","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:45 INFO  log:217 - Updating table stats fast for promotion
2018-11-08 14:16:45 INFO  log:219 - Updated size of table promotion to 20832
2018-11-08 14:16:45 INFO  CliDriver:951 - Time taken: 0.84 seconds
2018-11-08 14:16:45 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists promotion_text
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 266
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 406
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 370
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 367
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 369
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_23_piece0 on 192.168.112.64:32870 in memory (size: 33.6 KB, free: 366.0 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_23_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 33.6 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_18_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.0 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_18_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 404
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 405
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 403
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 330
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_24_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.0 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_24_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 298
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 334
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 465
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 295
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 297
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 434
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 302
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 438
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 303
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 432
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_20_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_20_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=promotion_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=promotion_text	
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_20_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 335
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 400
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_14_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_14_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_15_piece0 on 192.168.112.64:32870 in memory (size: 33.8 KB, free: 366.1 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_15_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.8 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 332
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 270
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 336
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 399
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 436
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_25_piece0 on 192.168.112.64:32870 in memory (size: 33.4 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_25_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 33.4 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 431
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 333
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 337
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_22_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_22_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 269
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 268
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 372
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 439
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 331
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 433
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 440
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 398
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 397
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 296
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 364
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_16_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  CliDriver:951 - Time taken: 0.124 seconds
2018-11-08 14:16:45 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists reason_text
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_16_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 304
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 338
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 301
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 401
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 366
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 402
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_19_piece0 on 192.168.112.64:32870 in memory (size: 32.3 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_19_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.3 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  CliDriver:951 - Time taken: 0.011 seconds
2018-11-08 14:16:45 INFO  SparkSqlParser:54 - Parsing command: 
create table reason_text
(
r_reason_sk               int,
r_reason_id               string,
r_reason_desc             string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/reason.csv")

2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 299
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 437
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 300
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 368
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 371
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 363
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 267
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 329
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 365
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_17_piece0 on 192.168.112.64:32870 in memory (size: 32.5 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_17_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 32.5 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  ContextCleaner:54 - Cleaned accumulator 435
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_21_piece0 on 192.168.112.64:32870 in memory (size: 32.4 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_21_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 32.4 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Removed broadcast_21_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.4 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`reason_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:reason_text, dbName:tpcds, owner:gsd, createTime:1541686605, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/reason_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/reason.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"r_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"r_reason_id","type":"string","nullable":true,"metadata":{}},{"name":"r_reason_desc","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:reason_text, dbName:tpcds, owner:gsd, createTime:1541686605, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/reason_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/reason.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"r_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"r_reason_id","type":"string","nullable":true,"metadata":{}},{"name":"r_reason_desc","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:45 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/reason_text-__PLACEHOLDER__
2018-11-08 14:16:45 INFO  CliDriver:951 - Time taken: 0.088 seconds
2018-11-08 14:16:45 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists reason
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/reason
2018-11-08 14:16:45 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:45 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/reason
2018-11-08 14:16:45 INFO  CliDriver:951 - Time taken: 0.131 seconds
2018-11-08 14:16:45 INFO  SparkSqlParser:54 - Parsing command: 
create table reason
using parquet
as (select * from reason_text)

2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:45 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:45 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:45 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:45 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:45 INFO  FileSourceStrategy:54 - Output Data Schema: struct<r_reason_sk: int, r_reason_id: string, r_reason_desc: string ... 1 more fields>
2018-11-08 14:16:45 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:45 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:45 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:45 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:45 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:45 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:45 INFO  MemoryStore:54 - Block broadcast_26 stored as values in memory (estimated size 283.4 KB, free 366.0 MB)
2018-11-08 14:16:45 INFO  MemoryStore:54 - Block broadcast_26_piece0 stored as bytes in memory (estimated size 23.5 KB, free 366.0 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Added broadcast_26_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  SparkContext:54 - Created broadcast 26 from processCmd at CliDriver.java:376
2018-11-08 14:16:45 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:45 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Got job 13 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Final stage: ResultStage 13 (processCmd at CliDriver.java:376)
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Submitting ResultStage 13 (MapPartitionsRDD[40] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:45 INFO  MemoryStore:54 - Block broadcast_27 stored as values in memory (estimated size 84.0 KB, free 365.9 MB)
2018-11-08 14:16:45 INFO  MemoryStore:54 - Block broadcast_27_piece0 stored as bytes in memory (estimated size 32.3 KB, free 365.9 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Added broadcast_27_piece0 in memory on 192.168.112.64:32870 (size: 32.3 KB, free: 366.2 MB)
2018-11-08 14:16:45 INFO  SparkContext:54 - Created broadcast 27 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[40] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:45 INFO  YarnScheduler:54 - Adding task set 13.0 with 1 tasks
2018-11-08 14:16:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 13.0 (TID 22, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5314 bytes)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Added broadcast_27_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.3 KB, free: 366.3 MB)
2018-11-08 14:16:45 INFO  BlockManagerInfo:54 - Added broadcast_26_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:46 INFO  TaskSetManager:54 - Finished task 0.0 in stage 13.0 (TID 22) in 576 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:16:46 INFO  YarnScheduler:54 - Removed TaskSet 13.0, whose tasks have all completed, from pool 
2018-11-08 14:16:46 INFO  DAGScheduler:54 - ResultStage 13 (processCmd at CliDriver.java:376) finished in 0,576 s
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Job 13 finished: processCmd at CliDriver.java:376, took 0,596484 s
2018-11-08 14:16:46 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason	
2018-11-08 14:16:46 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`reason` into Hive metastore in Hive compatible format.
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:reason, dbName:tpcds, owner:gsd, createTime:1541686605, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:r_reason_sk, type:int, comment:null), FieldSchema(name:r_reason_id, type:string, comment:null), FieldSchema(name:r_reason_desc, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/reason, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"r_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"r_reason_id","type":"string","nullable":true,"metadata":{}},{"name":"r_reason_desc","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:reason, dbName:tpcds, owner:gsd, createTime:1541686605, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:r_reason_sk, type:int, comment:null), FieldSchema(name:r_reason_id, type:string, comment:null), FieldSchema(name:r_reason_desc, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/reason, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"r_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"r_reason_id","type":"string","nullable":true,"metadata":{}},{"name":"r_reason_desc","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:46 INFO  log:217 - Updating table stats fast for reason
2018-11-08 14:16:46 INFO  log:219 - Updated size of table reason to 1712
2018-11-08 14:16:46 INFO  CliDriver:951 - Time taken: 0.798 seconds
2018-11-08 14:16:46 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists reason_text
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=reason_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=reason_text	
2018-11-08 14:16:46 INFO  CliDriver:951 - Time taken: 0.108 seconds
2018-11-08 14:16:46 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists ship_mode_text
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 INFO  CliDriver:951 - Time taken: 0.012 seconds
2018-11-08 14:16:46 INFO  SparkSqlParser:54 - Parsing command: 
create table ship_mode_text
(
sm_ship_mode_sk           int,
sm_ship_mode_id           string,
sm_type                   string,
sm_code                   string,
sm_carrier                string,
sm_contract               string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/ship_mode.csv")

2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`ship_mode_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:ship_mode_text, dbName:tpcds, owner:gsd, createTime:1541686606, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/ship_mode.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sm_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sm_ship_mode_id","type":"string","nullable":true,"metadata":{}},{"name":"sm_type","type":"string","nullable":true,"metadata":{}},{"name":"sm_code","type":"string","nullable":true,"metadata":{}},{"name":"sm_carrier","type":"string","nullable":true,"metadata":{}},{"name":"sm_contract","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:ship_mode_text, dbName:tpcds, owner:gsd, createTime:1541686606, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/ship_mode.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sm_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sm_ship_mode_id","type":"string","nullable":true,"metadata":{}},{"name":"sm_type","type":"string","nullable":true,"metadata":{}},{"name":"sm_code","type":"string","nullable":true,"metadata":{}},{"name":"sm_carrier","type":"string","nullable":true,"metadata":{}},{"name":"sm_contract","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:46 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode_text-__PLACEHOLDER__
2018-11-08 14:16:46 INFO  CliDriver:951 - Time taken: 0.089 seconds
2018-11-08 14:16:46 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists ship_mode
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode
2018-11-08 14:16:46 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:46 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode
2018-11-08 14:16:46 INFO  CliDriver:951 - Time taken: 0.12 seconds
2018-11-08 14:16:46 INFO  SparkSqlParser:54 - Parsing command: 
create table ship_mode
using parquet
as (select * from ship_mode_text)

2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:46 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:46 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:46 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:46 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:46 INFO  FileSourceStrategy:54 - Output Data Schema: struct<sm_ship_mode_sk: int, sm_ship_mode_id: string, sm_type: string, sm_code: string, sm_carrier: string ... 1 more field>
2018-11-08 14:16:46 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:46 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:46 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:46 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:46 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:46 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:46 INFO  MemoryStore:54 - Block broadcast_28 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:16:46 INFO  MemoryStore:54 - Block broadcast_28_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:16:46 INFO  BlockManagerInfo:54 - Added broadcast_28_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:46 INFO  SparkContext:54 - Created broadcast 28 from processCmd at CliDriver.java:376
2018-11-08 14:16:46 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:46 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Got job 14 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Final stage: ResultStage 14 (processCmd at CliDriver.java:376)
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Submitting ResultStage 14 (MapPartitionsRDD[43] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:46 INFO  MemoryStore:54 - Block broadcast_29 stored as values in memory (estimated size 84.7 KB, free 365.5 MB)
2018-11-08 14:16:46 INFO  MemoryStore:54 - Block broadcast_29_piece0 stored as bytes in memory (estimated size 32.5 KB, free 365.5 MB)
2018-11-08 14:16:46 INFO  BlockManagerInfo:54 - Added broadcast_29_piece0 in memory on 192.168.112.64:32870 (size: 32.5 KB, free: 366.2 MB)
2018-11-08 14:16:46 INFO  SparkContext:54 - Created broadcast 29 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:46 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[43] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:46 INFO  YarnScheduler:54 - Adding task set 14.0 with 1 tasks
2018-11-08 14:16:46 INFO  TaskSetManager:54 - Starting task 0.0 in stage 14.0 (TID 23, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5317 bytes)
2018-11-08 14:16:46 INFO  BlockManagerInfo:54 - Added broadcast_29_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 32.5 KB, free: 366.2 MB)
2018-11-08 14:16:47 INFO  BlockManagerInfo:54 - Added broadcast_28_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:47 INFO  TaskSetManager:54 - Finished task 0.0 in stage 14.0 (TID 23) in 192 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:16:47 INFO  YarnScheduler:54 - Removed TaskSet 14.0, whose tasks have all completed, from pool 
2018-11-08 14:16:47 INFO  DAGScheduler:54 - ResultStage 14 (processCmd at CliDriver.java:376) finished in 0,192 s
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Job 14 finished: processCmd at CliDriver.java:376, took 0,212957 s
2018-11-08 14:16:47 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode	
2018-11-08 14:16:47 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`ship_mode` into Hive metastore in Hive compatible format.
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:ship_mode, dbName:tpcds, owner:gsd, createTime:1541686606, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:sm_ship_mode_sk, type:int, comment:null), FieldSchema(name:sm_ship_mode_id, type:string, comment:null), FieldSchema(name:sm_type, type:string, comment:null), FieldSchema(name:sm_code, type:string, comment:null), FieldSchema(name:sm_carrier, type:string, comment:null), FieldSchema(name:sm_contract, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sm_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sm_ship_mode_id","type":"string","nullable":true,"metadata":{}},{"name":"sm_type","type":"string","nullable":true,"metadata":{}},{"name":"sm_code","type":"string","nullable":true,"metadata":{}},{"name":"sm_carrier","type":"string","nullable":true,"metadata":{}},{"name":"sm_contract","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:ship_mode, dbName:tpcds, owner:gsd, createTime:1541686606, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:sm_ship_mode_sk, type:int, comment:null), FieldSchema(name:sm_ship_mode_id, type:string, comment:null), FieldSchema(name:sm_type, type:string, comment:null), FieldSchema(name:sm_code, type:string, comment:null), FieldSchema(name:sm_carrier, type:string, comment:null), FieldSchema(name:sm_contract, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/ship_mode, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sm_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sm_ship_mode_id","type":"string","nullable":true,"metadata":{}},{"name":"sm_type","type":"string","nullable":true,"metadata":{}},{"name":"sm_code","type":"string","nullable":true,"metadata":{}},{"name":"sm_carrier","type":"string","nullable":true,"metadata":{}},{"name":"sm_contract","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:47 INFO  log:217 - Updating table stats fast for ship_mode
2018-11-08 14:16:47 INFO  log:219 - Updated size of table ship_mode to 2374
2018-11-08 14:16:47 INFO  CliDriver:951 - Time taken: 0.406 seconds
2018-11-08 14:16:47 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists ship_mode_text
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=ship_mode_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=ship_mode_text	
2018-11-08 14:16:47 INFO  CliDriver:951 - Time taken: 0.108 seconds
2018-11-08 14:16:47 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists store_text
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:16:47 INFO  SparkSqlParser:54 - Parsing command: 
create table store_text
(
s_store_sk                int,
s_store_id                string,
s_rec_start_date          string,
s_rec_end_date            string,
s_closed_date_sk          int,
s_store_name              string,
s_number_employees        int,
s_floor_space             int,
s_hours                   string,
s_manager                 string,
s_market_id               int,
s_geography_class         string,
s_market_desc             string,
s_market_manager          string,
s_division_id             int,
s_division_name           string,
s_company_id              int,
s_company_name            string,
s_street_number           string,
s_street_name             string,
s_street_type             string,
s_suite_number            string,
s_city                    string,
s_county                  string,
s_state                   string,
s_zip                     string,
s_country                 string,
s_gmt_offset              double,
s_tax_precentage          double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store.csv")

2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`store_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store_text, dbName:tpcds, owner:gsd, createTime:1541686607, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"s_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_id","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"s_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_name","type":"string","nullable":true,"metadata":{}},{"name":"s_number_employees","type":"integer","nullable":true,"metadata":{}},{"name":"s_floor_space","type":"integer","nullable":true,"metadata":{}},{"name":"s_hours","type":"string","nullable":true,"metadata":{}},{"name":"s_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_market_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_geography_class","type":"string","nullable":true,"metadata":{}},{"name":"s_market_desc","type":"string","nullable":true,"metadata":{}},{"name":"s_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_division_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_division_name","type":"string","nullable":true,"metadata":{}},{"name":"s_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_company_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_number","type":"string","nullable":true,"metadata":{}},{"name":"s_street_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_type","type":"string","nullable":true,"metadata":{}},{"name":"s_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"s_city","type":"string","nullable":true,"metadata":{}},{"name":"s_county","type":"string","nullable":true,"metadata":{}},{"name":"s_state","type":"string","nullable":true,"metadata":{}},{"name":"s_zip","type":"string","nullable":true,"metadata":{}},{"name":"s_country","type":"string","nullable":true,"metadata":{}},{"name":"s_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"s_tax_precentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store_text, dbName:tpcds, owner:gsd, createTime:1541686607, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"s_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_id","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"s_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_name","type":"string","nullable":true,"metadata":{}},{"name":"s_number_employees","type":"integer","nullable":true,"metadata":{}},{"name":"s_floor_space","type":"integer","nullable":true,"metadata":{}},{"name":"s_hours","type":"string","nullable":true,"metadata":{}},{"name":"s_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_market_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_geography_class","type":"string","nullable":true,"metadata":{}},{"name":"s_market_desc","type":"string","nullable":true,"metadata":{}},{"name":"s_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_division_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_division_name","type":"string","nullable":true,"metadata":{}},{"name":"s_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_company_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_number","type":"string","nullable":true,"metadata":{}},{"name":"s_street_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_type","type":"string","nullable":true,"metadata":{}},{"name":"s_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"s_city","type":"string","nullable":true,"metadata":{}},{"name":"s_county","type":"string","nullable":true,"metadata":{}},{"name":"s_state","type":"string","nullable":true,"metadata":{}},{"name":"s_zip","type":"string","nullable":true,"metadata":{}},{"name":"s_country","type":"string","nullable":true,"metadata":{}},{"name":"s_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"s_tax_precentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:47 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/store_text-__PLACEHOLDER__
2018-11-08 14:16:47 INFO  CliDriver:951 - Time taken: 0.125 seconds
2018-11-08 14:16:47 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/store
2018-11-08 14:16:47 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:47 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/store
2018-11-08 14:16:47 INFO  CliDriver:951 - Time taken: 0.13 seconds
2018-11-08 14:16:47 INFO  SparkSqlParser:54 - Parsing command: 
create table store
using parquet
as (select * from store_text)

2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:47 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:47 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:47 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:47 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:47 INFO  FileSourceStrategy:54 - Output Data Schema: struct<s_store_sk: int, s_store_id: string, s_rec_start_date: string, s_rec_end_date: string, s_closed_date_sk: int ... 27 more fields>
2018-11-08 14:16:47 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:47 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:47 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:47 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:47 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:47 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:47 INFO  MemoryStore:54 - Block broadcast_30 stored as values in memory (estimated size 283.4 KB, free 365.2 MB)
2018-11-08 14:16:47 INFO  MemoryStore:54 - Block broadcast_30_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.2 MB)
2018-11-08 14:16:47 INFO  BlockManagerInfo:54 - Added broadcast_30_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:47 INFO  SparkContext:54 - Created broadcast 30 from processCmd at CliDriver.java:376
2018-11-08 14:16:47 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:47 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Got job 15 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Final stage: ResultStage 15 (processCmd at CliDriver.java:376)
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Submitting ResultStage 15 (MapPartitionsRDD[46] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:47 INFO  MemoryStore:54 - Block broadcast_31 stored as values in memory (estimated size 90.6 KB, free 365.1 MB)
2018-11-08 14:16:47 INFO  MemoryStore:54 - Block broadcast_31_piece0 stored as bytes in memory (estimated size 33.9 KB, free 365.1 MB)
2018-11-08 14:16:47 INFO  BlockManagerInfo:54 - Added broadcast_31_piece0 in memory on 192.168.112.64:32870 (size: 33.9 KB, free: 366.1 MB)
2018-11-08 14:16:47 INFO  SparkContext:54 - Created broadcast 31 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:47 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 15 (MapPartitionsRDD[46] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:16:47 INFO  YarnScheduler:54 - Adding task set 15.0 with 1 tasks
2018-11-08 14:16:47 INFO  TaskSetManager:54 - Starting task 0.0 in stage 15.0 (TID 24, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5313 bytes)
2018-11-08 14:16:47 INFO  BlockManagerInfo:54 - Added broadcast_31_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.9 KB, free: 366.2 MB)
2018-11-08 14:16:47 INFO  BlockManagerInfo:54 - Added broadcast_30_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:48 INFO  TaskSetManager:54 - Finished task 0.0 in stage 15.0 (TID 24) in 707 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:16:48 INFO  YarnScheduler:54 - Removed TaskSet 15.0, whose tasks have all completed, from pool 
2018-11-08 14:16:48 INFO  DAGScheduler:54 - ResultStage 15 (processCmd at CliDriver.java:376) finished in 0,708 s
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Job 15 finished: processCmd at CliDriver.java:376, took 0,730354 s
2018-11-08 14:16:48 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store	
2018-11-08 14:16:48 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`store` into Hive metastore in Hive compatible format.
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store, dbName:tpcds, owner:gsd, createTime:1541686607, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s_store_sk, type:int, comment:null), FieldSchema(name:s_store_id, type:string, comment:null), FieldSchema(name:s_rec_start_date, type:string, comment:null), FieldSchema(name:s_rec_end_date, type:string, comment:null), FieldSchema(name:s_closed_date_sk, type:int, comment:null), FieldSchema(name:s_store_name, type:string, comment:null), FieldSchema(name:s_number_employees, type:int, comment:null), FieldSchema(name:s_floor_space, type:int, comment:null), FieldSchema(name:s_hours, type:string, comment:null), FieldSchema(name:s_manager, type:string, comment:null), FieldSchema(name:s_market_id, type:int, comment:null), FieldSchema(name:s_geography_class, type:string, comment:null), FieldSchema(name:s_market_desc, type:string, comment:null), FieldSchema(name:s_market_manager, type:string, comment:null), FieldSchema(name:s_division_id, type:int, comment:null), FieldSchema(name:s_division_name, type:string, comment:null), FieldSchema(name:s_company_id, type:int, comment:null), FieldSchema(name:s_company_name, type:string, comment:null), FieldSchema(name:s_street_number, type:string, comment:null), FieldSchema(name:s_street_name, type:string, comment:null), FieldSchema(name:s_street_type, type:string, comment:null), FieldSchema(name:s_suite_number, type:string, comment:null), FieldSchema(name:s_city, type:string, comment:null), FieldSchema(name:s_county, type:string, comment:null), FieldSchema(name:s_state, type:string, comment:null), FieldSchema(name:s_zip, type:string, comment:null), FieldSchema(name:s_country, type:string, comment:null), FieldSchema(name:s_gmt_offset, type:double, comment:null), FieldSchema(name:s_tax_precentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"s_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_id","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"s_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_name","type":"string","nullable":true,"metadata":{}},{"name":"s_number_employees","type":"integer","nullable":true,"metadata":{}},{"name":"s_floor_space","type":"integer","nullable":true,"metadata":{}},{"name":"s_hours","type":"string","nullable":true,"metadata":{}},{"name":"s_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_market_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_geography_class","type":"string","nullable":true,"metadata":{}},{"name":"s_market_desc","type":"string","nullable":true,"metadata":{}},{"name":"s_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_division_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_division_name","type":"string","nullable":true,"metadata":{}},{"name":"s_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_company_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_number","type":"string","nullable":true,"metadata":{}},{"name":"s_street_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_type","type":"string","nullable":true,"metadata":{}},{"name":"s_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"s_city","type":"string","nullable":true,"metadata":{}},{"name":"s_county","type":"string","nullable":true,"metadata":{}},{"name":"s_state","type":"string","nullable":true,"metadata":{}},{"name":"s_zip","type":"string","nullable":true,"metadata":{}},{"name":"s_country","type":"string","nullable":true,"metadata":{}},{"name":"s_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"s_tax_precentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store, dbName:tpcds, owner:gsd, createTime:1541686607, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s_store_sk, type:int, comment:null), FieldSchema(name:s_store_id, type:string, comment:null), FieldSchema(name:s_rec_start_date, type:string, comment:null), FieldSchema(name:s_rec_end_date, type:string, comment:null), FieldSchema(name:s_closed_date_sk, type:int, comment:null), FieldSchema(name:s_store_name, type:string, comment:null), FieldSchema(name:s_number_employees, type:int, comment:null), FieldSchema(name:s_floor_space, type:int, comment:null), FieldSchema(name:s_hours, type:string, comment:null), FieldSchema(name:s_manager, type:string, comment:null), FieldSchema(name:s_market_id, type:int, comment:null), FieldSchema(name:s_geography_class, type:string, comment:null), FieldSchema(name:s_market_desc, type:string, comment:null), FieldSchema(name:s_market_manager, type:string, comment:null), FieldSchema(name:s_division_id, type:int, comment:null), FieldSchema(name:s_division_name, type:string, comment:null), FieldSchema(name:s_company_id, type:int, comment:null), FieldSchema(name:s_company_name, type:string, comment:null), FieldSchema(name:s_street_number, type:string, comment:null), FieldSchema(name:s_street_name, type:string, comment:null), FieldSchema(name:s_street_type, type:string, comment:null), FieldSchema(name:s_suite_number, type:string, comment:null), FieldSchema(name:s_city, type:string, comment:null), FieldSchema(name:s_county, type:string, comment:null), FieldSchema(name:s_state, type:string, comment:null), FieldSchema(name:s_zip, type:string, comment:null), FieldSchema(name:s_country, type:string, comment:null), FieldSchema(name:s_gmt_offset, type:double, comment:null), FieldSchema(name:s_tax_precentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"s_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_id","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"s_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"s_closed_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"s_store_name","type":"string","nullable":true,"metadata":{}},{"name":"s_number_employees","type":"integer","nullable":true,"metadata":{}},{"name":"s_floor_space","type":"integer","nullable":true,"metadata":{}},{"name":"s_hours","type":"string","nullable":true,"metadata":{}},{"name":"s_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_market_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_geography_class","type":"string","nullable":true,"metadata":{}},{"name":"s_market_desc","type":"string","nullable":true,"metadata":{}},{"name":"s_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"s_division_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_division_name","type":"string","nullable":true,"metadata":{}},{"name":"s_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"s_company_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_number","type":"string","nullable":true,"metadata":{}},{"name":"s_street_name","type":"string","nullable":true,"metadata":{}},{"name":"s_street_type","type":"string","nullable":true,"metadata":{}},{"name":"s_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"s_city","type":"string","nullable":true,"metadata":{}},{"name":"s_county","type":"string","nullable":true,"metadata":{}},{"name":"s_state","type":"string","nullable":true,"metadata":{}},{"name":"s_zip","type":"string","nullable":true,"metadata":{}},{"name":"s_country","type":"string","nullable":true,"metadata":{}},{"name":"s_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"s_tax_precentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:48 INFO  log:217 - Updating table stats fast for store
2018-11-08 14:16:48 INFO  log:219 - Updated size of table store to 8832
2018-11-08 14:16:48 INFO  CliDriver:951 - Time taken: 0.968 seconds
2018-11-08 14:16:48 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store_text
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store_text	
2018-11-08 14:16:48 INFO  CliDriver:951 - Time taken: 0.109 seconds
2018-11-08 14:16:48 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists store_returns_text
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 INFO  CliDriver:951 - Time taken: 0.008 seconds
2018-11-08 14:16:48 INFO  SparkSqlParser:54 - Parsing command: 
create table store_returns_text
(
sr_returned_date_sk       int,
sr_return_time_sk         int,
sr_item_sk                int,
sr_customer_sk            int,
sr_cdemo_sk               int,
sr_hdemo_sk               int,
sr_addr_sk                int,
sr_store_sk               int,
sr_reason_sk              int,
sr_ticket_number          int,
sr_return_quantity        int,
sr_return_amt             double,
sr_return_tax             double,
sr_return_amt_inc_tax     double,
sr_fee                    double,
sr_return_ship_cost       double,
sr_refunded_cash          double,
sr_reversed_charge        double,
sr_store_credit           double,
sr_net_loss               double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_returns.csv")

2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`store_returns_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store_returns_text, dbName:tpcds, owner:gsd, createTime:1541686608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_fee","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"sr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"sr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"sr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"sr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store_returns_text, dbName:tpcds, owner:gsd, createTime:1541686608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_fee","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"sr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"sr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"sr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"sr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:48 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns_text-__PLACEHOLDER__
2018-11-08 14:16:48 INFO  CliDriver:951 - Time taken: 0.084 seconds
2018-11-08 14:16:48 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store_returns
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns
2018-11-08 14:16:48 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:48 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns
2018-11-08 14:16:48 INFO  CliDriver:951 - Time taken: 0.129 seconds
2018-11-08 14:16:48 INFO  SparkSqlParser:54 - Parsing command: 
create table store_returns
using parquet
as (select * from store_returns_text)

2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:48 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:48 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:48 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:48 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:48 INFO  FileSourceStrategy:54 - Output Data Schema: struct<sr_returned_date_sk: int, sr_return_time_sk: int, sr_item_sk: int, sr_customer_sk: int, sr_cdemo_sk: int ... 18 more fields>
2018-11-08 14:16:48 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:48 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:48 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:48 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:48 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:48 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:48 INFO  MemoryStore:54 - Block broadcast_32 stored as values in memory (estimated size 283.4 KB, free 364.8 MB)
2018-11-08 14:16:48 INFO  MemoryStore:54 - Block broadcast_32_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-11-08 14:16:48 INFO  BlockManagerInfo:54 - Added broadcast_32_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:48 INFO  SparkContext:54 - Created broadcast 32 from processCmd at CliDriver.java:376
2018-11-08 14:16:48 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 18308397 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:48 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Got job 16 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Final stage: ResultStage 16 (processCmd at CliDriver.java:376)
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Submitting ResultStage 16 (MapPartitionsRDD[49] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:48 INFO  MemoryStore:54 - Block broadcast_33 stored as values in memory (estimated size 88.4 KB, free 364.7 MB)
2018-11-08 14:16:48 INFO  MemoryStore:54 - Block broadcast_33_piece0 stored as bytes in memory (estimated size 33.5 KB, free 364.6 MB)
2018-11-08 14:16:48 INFO  BlockManagerInfo:54 - Added broadcast_33_piece0 in memory on 192.168.112.64:32870 (size: 33.5 KB, free: 366.1 MB)
2018-11-08 14:16:48 INFO  SparkContext:54 - Created broadcast 33 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:48 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 16 (MapPartitionsRDD[49] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:16:48 INFO  YarnScheduler:54 - Adding task set 16.0 with 2 tasks
2018-11-08 14:16:48 INFO  TaskSetManager:54 - Starting task 0.0 in stage 16.0 (TID 25, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5321 bytes)
2018-11-08 14:16:49 INFO  BlockManagerInfo:54 - Added broadcast_33_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.5 KB, free: 366.1 MB)
2018-11-08 14:16:49 INFO  BlockManagerInfo:54 - Added broadcast_32_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:51 INFO  TaskSetManager:54 - Starting task 1.0 in stage 16.0 (TID 26, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, NODE_LOCAL, 5321 bytes)
2018-11-08 14:16:51 INFO  TaskSetManager:54 - Finished task 0.0 in stage 16.0 (TID 25) in 2090 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:16:52 INFO  TaskSetManager:54 - Finished task 1.0 in stage 16.0 (TID 26) in 1696 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:16:52 INFO  YarnScheduler:54 - Removed TaskSet 16.0, whose tasks have all completed, from pool 
2018-11-08 14:16:52 INFO  DAGScheduler:54 - ResultStage 16 (processCmd at CliDriver.java:376) finished in 3,788 s
2018-11-08 14:16:52 INFO  DAGScheduler:54 - Job 16 finished: processCmd at CliDriver.java:376, took 3,801813 s
2018-11-08 14:16:52 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns	
2018-11-08 14:16:52 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`store_returns` into Hive metastore in Hive compatible format.
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store_returns, dbName:tpcds, owner:gsd, createTime:1541686608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:sr_returned_date_sk, type:int, comment:null), FieldSchema(name:sr_return_time_sk, type:int, comment:null), FieldSchema(name:sr_item_sk, type:int, comment:null), FieldSchema(name:sr_customer_sk, type:int, comment:null), FieldSchema(name:sr_cdemo_sk, type:int, comment:null), FieldSchema(name:sr_hdemo_sk, type:int, comment:null), FieldSchema(name:sr_addr_sk, type:int, comment:null), FieldSchema(name:sr_store_sk, type:int, comment:null), FieldSchema(name:sr_reason_sk, type:int, comment:null), FieldSchema(name:sr_ticket_number, type:int, comment:null), FieldSchema(name:sr_return_quantity, type:int, comment:null), FieldSchema(name:sr_return_amt, type:double, comment:null), FieldSchema(name:sr_return_tax, type:double, comment:null), FieldSchema(name:sr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:sr_fee, type:double, comment:null), FieldSchema(name:sr_return_ship_cost, type:double, comment:null), FieldSchema(name:sr_refunded_cash, type:double, comment:null), FieldSchema(name:sr_reversed_charge, type:double, comment:null), FieldSchema(name:sr_store_credit, type:double, comment:null), FieldSchema(name:sr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_fee","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"sr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"sr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"sr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"sr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store_returns, dbName:tpcds, owner:gsd, createTime:1541686608, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:sr_returned_date_sk, type:int, comment:null), FieldSchema(name:sr_return_time_sk, type:int, comment:null), FieldSchema(name:sr_item_sk, type:int, comment:null), FieldSchema(name:sr_customer_sk, type:int, comment:null), FieldSchema(name:sr_cdemo_sk, type:int, comment:null), FieldSchema(name:sr_hdemo_sk, type:int, comment:null), FieldSchema(name:sr_addr_sk, type:int, comment:null), FieldSchema(name:sr_store_sk, type:int, comment:null), FieldSchema(name:sr_reason_sk, type:int, comment:null), FieldSchema(name:sr_ticket_number, type:int, comment:null), FieldSchema(name:sr_return_quantity, type:int, comment:null), FieldSchema(name:sr_return_amt, type:double, comment:null), FieldSchema(name:sr_return_tax, type:double, comment:null), FieldSchema(name:sr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:sr_fee, type:double, comment:null), FieldSchema(name:sr_return_ship_cost, type:double, comment:null), FieldSchema(name:sr_refunded_cash, type:double, comment:null), FieldSchema(name:sr_reversed_charge, type:double, comment:null), FieldSchema(name:sr_store_credit, type:double, comment:null), FieldSchema(name:sr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"sr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"sr_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"sr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"sr_fee","type":"double","nullable":true,"metadata":{}},{"name":"sr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"sr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"sr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"sr_store_credit","type":"double","nullable":true,"metadata":{}},{"name":"sr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:52 INFO  log:217 - Updating table stats fast for store_returns
2018-11-08 14:16:52 INFO  log:219 - Updated size of table store_returns to 17125817
2018-11-08 14:16:52 INFO  CliDriver:951 - Time taken: 4.023 seconds
2018-11-08 14:16:52 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store_returns_text
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store_returns_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store_returns_text	
2018-11-08 14:16:52 INFO  CliDriver:951 - Time taken: 0.091 seconds
2018-11-08 14:16:52 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists store_sales_text
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:52 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:52 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:52 INFO  CliDriver:951 - Time taken: 0.006 seconds
2018-11-08 14:16:52 INFO  SparkSqlParser:54 - Parsing command: 
create table store_sales_text
(
ss_sold_date_sk           int,
ss_sold_time_sk           int,
ss_item_sk                int,
ss_customer_sk            int,
ss_cdemo_sk               int,
ss_hdemo_sk               int,
ss_addr_sk                int,
ss_store_sk               int,
ss_promo_sk               int,
ss_ticket_number          int,
ss_quantity               int,
ss_wholesale_cost         double,
ss_list_price             double,
ss_sales_price            double,
ss_ext_discount_amt       double,
ss_ext_sales_price        double,
ss_ext_wholesale_cost     double,
ss_ext_list_price         double,
ss_ext_tax                double,
ss_coupon_amt             double,
ss_net_paid               double,
ss_net_paid_inc_tax       double,
ss_net_profit             double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_sales.csv")

2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:53 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`store_sales_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store_sales_text, dbName:tpcds, owner:gsd, createTime:1541686612, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ss_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"ss_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ss_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store_sales_text, dbName:tpcds, owner:gsd, createTime:1541686612, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/store_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ss_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"ss_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ss_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:16:53 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales_text-__PLACEHOLDER__
2018-11-08 14:16:53 INFO  CliDriver:951 - Time taken: 0.077 seconds
2018-11-08 14:16:53 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store_sales
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales
2018-11-08 14:16:53 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:16:53 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales
2018-11-08 14:16:53 INFO  CliDriver:951 - Time taken: 0.113 seconds
2018-11-08 14:16:53 INFO  SparkSqlParser:54 - Parsing command: 
create table store_sales
using parquet
as (select * from store_sales_text)

2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:16:53 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:16:53 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:16:53 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:16:53 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:16:53 INFO  FileSourceStrategy:54 - Output Data Schema: struct<ss_sold_date_sk: int, ss_sold_time_sk: int, ss_item_sk: int, ss_customer_sk: int, ss_cdemo_sk: int ... 21 more fields>
2018-11-08 14:16:53 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:16:53 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:53 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:53 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:53 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:16:53 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:16:53 INFO  MemoryStore:54 - Block broadcast_34 stored as values in memory (estimated size 283.4 KB, free 364.4 MB)
2018-11-08 14:16:53 INFO  MemoryStore:54 - Block broadcast_34_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.3 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_34_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  SparkContext:54 - Created broadcast 34 from processCmd at CliDriver.java:376
2018-11-08 14:16:53 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 134217728 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:16:53 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Got job 17 (processCmd at CliDriver.java:376) with 3 output partitions
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Final stage: ResultStage 17 (processCmd at CliDriver.java:376)
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Submitting ResultStage 17 (MapPartitionsRDD[52] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 508
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 506
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 540
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 505
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 469
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 568
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 499
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 601
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 507
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 467
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 474
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_29_piece0 on 192.168.112.64:32870 in memory (size: 32.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_29_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  MemoryStore:54 - Block broadcast_35 stored as values in memory (estimated size 89.1 KB, free 364.4 MB)
2018-11-08 14:16:53 INFO  MemoryStore:54 - Block broadcast_35_piece0 stored as bytes in memory (estimated size 33.6 KB, free 364.3 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_35_piece0 in memory on 192.168.112.64:32870 (size: 33.6 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 605
2018-11-08 14:16:53 INFO  SparkContext:54 - Created broadcast 35 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:16:53 INFO  DAGScheduler:54 - Submitting 3 missing tasks from ResultStage 17 (MapPartitionsRDD[52] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1, 2))
2018-11-08 14:16:53 INFO  YarnScheduler:54 - Adding task set 17.0 with 3 tasks
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_33_piece0 on 192.168.112.64:32870 in memory (size: 33.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  TaskSetManager:54 - Starting task 2.0 in stage 17.0 (TID 27, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 2, NODE_LOCAL, 5319 bytes)
2018-11-08 14:16:53 INFO  TaskSetManager:54 - Starting task 0.0 in stage 17.0 (TID 28, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5319 bytes)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_33_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 542
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 603
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_32_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_32_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 569
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_35_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 33.6 KB, free: 366.3 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 534
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_26_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_26_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_35_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.6 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 604
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_27_piece0 on 192.168.112.64:32870 in memory (size: 32.3 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_27_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 32.3 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 500
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 573
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 472
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 533
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_30_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_30_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 572
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 574
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 570
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 571
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 471
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 539
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 466
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_31_piece0 on 192.168.112.64:32870 in memory (size: 33.9 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_31_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.9 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_28_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Removed broadcast_28_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 501
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 602
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 473
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 504
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 503
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 537
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 538
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 576
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 536
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 575
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 502
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 567
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 541
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 535
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 470
2018-11-08 14:16:53 INFO  ContextCleaner:54 - Cleaned accumulator 468
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_34_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:16:53 INFO  BlockManagerInfo:54 - Added broadcast_34_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:00 INFO  TaskSetManager:54 - Starting task 1.0 in stage 17.0 (TID 29, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, NODE_LOCAL, 5319 bytes)
2018-11-08 14:17:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 17.0 (TID 28) in 7135 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/3)
2018-11-08 14:17:01 INFO  TaskSetManager:54 - Finished task 2.0 in stage 17.0 (TID 27) in 8075 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/3)
2018-11-08 14:17:07 INFO  TaskSetManager:54 - Finished task 1.0 in stage 17.0 (TID 29) in 7103 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (3/3)
2018-11-08 14:17:07 INFO  YarnScheduler:54 - Removed TaskSet 17.0, whose tasks have all completed, from pool 
2018-11-08 14:17:07 INFO  DAGScheduler:54 - ResultStage 17 (processCmd at CliDriver.java:376) finished in 14,238 s
2018-11-08 14:17:07 INFO  DAGScheduler:54 - Job 17 finished: processCmd at CliDriver.java:376, took 14,276988 s
2018-11-08 14:17:07 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales	
2018-11-08 14:17:07 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`store_sales` into Hive metastore in Hive compatible format.
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:store_sales, dbName:tpcds, owner:gsd, createTime:1541686613, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ss_sold_date_sk, type:int, comment:null), FieldSchema(name:ss_sold_time_sk, type:int, comment:null), FieldSchema(name:ss_item_sk, type:int, comment:null), FieldSchema(name:ss_customer_sk, type:int, comment:null), FieldSchema(name:ss_cdemo_sk, type:int, comment:null), FieldSchema(name:ss_hdemo_sk, type:int, comment:null), FieldSchema(name:ss_addr_sk, type:int, comment:null), FieldSchema(name:ss_store_sk, type:int, comment:null), FieldSchema(name:ss_promo_sk, type:int, comment:null), FieldSchema(name:ss_ticket_number, type:int, comment:null), FieldSchema(name:ss_quantity, type:int, comment:null), FieldSchema(name:ss_wholesale_cost, type:double, comment:null), FieldSchema(name:ss_list_price, type:double, comment:null), FieldSchema(name:ss_sales_price, type:double, comment:null), FieldSchema(name:ss_ext_discount_amt, type:double, comment:null), FieldSchema(name:ss_ext_sales_price, type:double, comment:null), FieldSchema(name:ss_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:ss_ext_list_price, type:double, comment:null), FieldSchema(name:ss_ext_tax, type:double, comment:null), FieldSchema(name:ss_coupon_amt, type:double, comment:null), FieldSchema(name:ss_net_paid, type:double, comment:null), FieldSchema(name:ss_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:ss_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ss_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"ss_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ss_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:store_sales, dbName:tpcds, owner:gsd, createTime:1541686613, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ss_sold_date_sk, type:int, comment:null), FieldSchema(name:ss_sold_time_sk, type:int, comment:null), FieldSchema(name:ss_item_sk, type:int, comment:null), FieldSchema(name:ss_customer_sk, type:int, comment:null), FieldSchema(name:ss_cdemo_sk, type:int, comment:null), FieldSchema(name:ss_hdemo_sk, type:int, comment:null), FieldSchema(name:ss_addr_sk, type:int, comment:null), FieldSchema(name:ss_store_sk, type:int, comment:null), FieldSchema(name:ss_promo_sk, type:int, comment:null), FieldSchema(name:ss_ticket_number, type:int, comment:null), FieldSchema(name:ss_quantity, type:int, comment:null), FieldSchema(name:ss_wholesale_cost, type:double, comment:null), FieldSchema(name:ss_list_price, type:double, comment:null), FieldSchema(name:ss_sales_price, type:double, comment:null), FieldSchema(name:ss_ext_discount_amt, type:double, comment:null), FieldSchema(name:ss_ext_sales_price, type:double, comment:null), FieldSchema(name:ss_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:ss_ext_list_price, type:double, comment:null), FieldSchema(name:ss_ext_tax, type:double, comment:null), FieldSchema(name:ss_coupon_amt, type:double, comment:null), FieldSchema(name:ss_net_paid, type:double, comment:null), FieldSchema(name:ss_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:ss_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/store_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ss_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_store_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ss_ticket_number","type":"integer","nullable":true,"metadata":{}},{"name":"ss_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ss_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ss_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ss_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:07 INFO  log:217 - Updating table stats fast for store_sales
2018-11-08 14:17:07 INFO  log:219 - Updated size of table store_sales to 142354817
2018-11-08 14:17:07 INFO  CliDriver:951 - Time taken: 14.538 seconds
2018-11-08 14:17:07 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists store_sales_text
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=store_sales_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=store_sales_text	
2018-11-08 14:17:07 INFO  CliDriver:951 - Time taken: 0.098 seconds
2018-11-08 14:17:07 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists time_dim_text
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:07 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:17:07 INFO  SparkSqlParser:54 - Parsing command: 
create table time_dim_text
(
t_time_sk                 int,
t_time_id                 string,
t_time                    int,
t_hour                    int,
t_minute                  int,
t_second                  int,
t_am_pm                   string,
t_shift                   string,
t_sub_shift               string,
t_meal_time               string
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/time_dim.csv")

2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:07 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`time_dim_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:time_dim_text, dbName:tpcds, owner:gsd, createTime:1541686627, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/time_dim.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"t_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"t_time_id","type":"string","nullable":true,"metadata":{}},{"name":"t_time","type":"integer","nullable":true,"metadata":{}},{"name":"t_hour","type":"integer","nullable":true,"metadata":{}},{"name":"t_minute","type":"integer","nullable":true,"metadata":{}},{"name":"t_second","type":"integer","nullable":true,"metadata":{}},{"name":"t_am_pm","type":"string","nullable":true,"metadata":{}},{"name":"t_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_sub_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_meal_time","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:time_dim_text, dbName:tpcds, owner:gsd, createTime:1541686627, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/time_dim.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"t_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"t_time_id","type":"string","nullable":true,"metadata":{}},{"name":"t_time","type":"integer","nullable":true,"metadata":{}},{"name":"t_hour","type":"integer","nullable":true,"metadata":{}},{"name":"t_minute","type":"integer","nullable":true,"metadata":{}},{"name":"t_second","type":"integer","nullable":true,"metadata":{}},{"name":"t_am_pm","type":"string","nullable":true,"metadata":{}},{"name":"t_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_sub_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_meal_time","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:07 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim_text-__PLACEHOLDER__
2018-11-08 14:17:07 INFO  CliDriver:951 - Time taken: 0.075 seconds
2018-11-08 14:17:07 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists time_dim
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:07 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=time_dim
2018-11-08 14:17:07 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:08 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim
2018-11-08 14:17:08 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:08 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim
2018-11-08 14:17:08 INFO  CliDriver:951 - Time taken: 0.138 seconds
2018-11-08 14:17:08 INFO  SparkSqlParser:54 - Parsing command: 
create table time_dim
using parquet
as (select * from time_dim_text)

2018-11-08 14:17:08 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:08 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:08 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:08 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:08 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:08 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:08 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:08 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:08 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:08 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:08 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:08 INFO  FileSourceStrategy:54 - Output Data Schema: struct<t_time_sk: int, t_time_id: string, t_time: int, t_hour: int, t_minute: int ... 8 more fields>
2018-11-08 14:17:08 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:08 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:08 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:08 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:08 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:08 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:08 INFO  MemoryStore:54 - Block broadcast_36 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:17:08 INFO  MemoryStore:54 - Block broadcast_36_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:17:08 INFO  BlockManagerInfo:54 - Added broadcast_36_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:08 INFO  SparkContext:54 - Created broadcast 36 from processCmd at CliDriver.java:376
2018-11-08 14:17:08 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4607842 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:08 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Got job 18 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Final stage: ResultStage 18 (processCmd at CliDriver.java:376)
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Submitting ResultStage 18 (MapPartitionsRDD[55] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:08 INFO  MemoryStore:54 - Block broadcast_37 stored as values in memory (estimated size 85.7 KB, free 365.5 MB)
2018-11-08 14:17:08 INFO  MemoryStore:54 - Block broadcast_37_piece0 stored as bytes in memory (estimated size 32.8 KB, free 365.5 MB)
2018-11-08 14:17:08 INFO  BlockManagerInfo:54 - Added broadcast_37_piece0 in memory on 192.168.112.64:32870 (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:17:08 INFO  SparkContext:54 - Created broadcast 37 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:08 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 18 (MapPartitionsRDD[55] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:17:08 INFO  YarnScheduler:54 - Adding task set 18.0 with 2 tasks
2018-11-08 14:17:08 INFO  TaskSetManager:54 - Starting task 0.0 in stage 18.0 (TID 30, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5316 bytes)
2018-11-08 14:17:08 INFO  BlockManagerInfo:54 - Added broadcast_37_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:17:08 INFO  BlockManagerInfo:54 - Added broadcast_36_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:08 INFO  TaskSetManager:54 - Starting task 1.0 in stage 18.0 (TID 31, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 1, NODE_LOCAL, 5316 bytes)
2018-11-08 14:17:08 INFO  TaskSetManager:54 - Finished task 0.0 in stage 18.0 (TID 30) in 824 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/2)
2018-11-08 14:17:09 INFO  TaskSetManager:54 - Finished task 1.0 in stage 18.0 (TID 31) in 537 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (2/2)
2018-11-08 14:17:09 INFO  YarnScheduler:54 - Removed TaskSet 18.0, whose tasks have all completed, from pool 
2018-11-08 14:17:09 INFO  DAGScheduler:54 - ResultStage 18 (processCmd at CliDriver.java:376) finished in 1,362 s
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Job 18 finished: processCmd at CliDriver.java:376, took 1,381196 s
2018-11-08 14:17:09 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim	
2018-11-08 14:17:09 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`time_dim` into Hive metastore in Hive compatible format.
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:time_dim, dbName:tpcds, owner:gsd, createTime:1541686628, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:t_time_sk, type:int, comment:null), FieldSchema(name:t_time_id, type:string, comment:null), FieldSchema(name:t_time, type:int, comment:null), FieldSchema(name:t_hour, type:int, comment:null), FieldSchema(name:t_minute, type:int, comment:null), FieldSchema(name:t_second, type:int, comment:null), FieldSchema(name:t_am_pm, type:string, comment:null), FieldSchema(name:t_shift, type:string, comment:null), FieldSchema(name:t_sub_shift, type:string, comment:null), FieldSchema(name:t_meal_time, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"t_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"t_time_id","type":"string","nullable":true,"metadata":{}},{"name":"t_time","type":"integer","nullable":true,"metadata":{}},{"name":"t_hour","type":"integer","nullable":true,"metadata":{}},{"name":"t_minute","type":"integer","nullable":true,"metadata":{}},{"name":"t_second","type":"integer","nullable":true,"metadata":{}},{"name":"t_am_pm","type":"string","nullable":true,"metadata":{}},{"name":"t_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_sub_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_meal_time","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:time_dim, dbName:tpcds, owner:gsd, createTime:1541686628, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:t_time_sk, type:int, comment:null), FieldSchema(name:t_time_id, type:string, comment:null), FieldSchema(name:t_time, type:int, comment:null), FieldSchema(name:t_hour, type:int, comment:null), FieldSchema(name:t_minute, type:int, comment:null), FieldSchema(name:t_second, type:int, comment:null), FieldSchema(name:t_am_pm, type:string, comment:null), FieldSchema(name:t_shift, type:string, comment:null), FieldSchema(name:t_sub_shift, type:string, comment:null), FieldSchema(name:t_meal_time, type:string, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/time_dim, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"t_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"t_time_id","type":"string","nullable":true,"metadata":{}},{"name":"t_time","type":"integer","nullable":true,"metadata":{}},{"name":"t_hour","type":"integer","nullable":true,"metadata":{}},{"name":"t_minute","type":"integer","nullable":true,"metadata":{}},{"name":"t_second","type":"integer","nullable":true,"metadata":{}},{"name":"t_am_pm","type":"string","nullable":true,"metadata":{}},{"name":"t_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_sub_shift","type":"string","nullable":true,"metadata":{}},{"name":"t_meal_time","type":"string","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:09 INFO  log:217 - Updating table stats fast for time_dim
2018-11-08 14:17:09 INFO  log:219 - Updated size of table time_dim to 1130949
2018-11-08 14:17:09 INFO  CliDriver:951 - Time taken: 1.579 seconds
2018-11-08 14:17:09 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists time_dim_text
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=time_dim_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=time_dim_text	
2018-11-08 14:17:09 INFO  CliDriver:951 - Time taken: 0.083 seconds
2018-11-08 14:17:09 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists warehouse_text
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:17:09 INFO  SparkSqlParser:54 - Parsing command: 
create table warehouse_text
(
w_warehouse_sk            int,
w_warehouse_id            string,
w_warehouse_name          string,
w_warehouse_sq_ft         int,
w_street_number           string,
w_street_name             string,
w_street_type             string,
w_suite_number            string,
w_city                    string,
w_county                  string,
w_state                   string,
w_zip                     string,
w_country                 string,
w_gmt_offset              double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/warehouse.csv")

2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`warehouse_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:warehouse_text, dbName:tpcds, owner:gsd, createTime:1541686629, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/warehouse.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"w_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"w_warehouse_id","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_name","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"w_street_number","type":"string","nullable":true,"metadata":{}},{"name":"w_street_name","type":"string","nullable":true,"metadata":{}},{"name":"w_street_type","type":"string","nullable":true,"metadata":{}},{"name":"w_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"w_city","type":"string","nullable":true,"metadata":{}},{"name":"w_county","type":"string","nullable":true,"metadata":{}},{"name":"w_state","type":"string","nullable":true,"metadata":{}},{"name":"w_zip","type":"string","nullable":true,"metadata":{}},{"name":"w_country","type":"string","nullable":true,"metadata":{}},{"name":"w_gmt_offset","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:warehouse_text, dbName:tpcds, owner:gsd, createTime:1541686629, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/warehouse.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"w_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"w_warehouse_id","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_name","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"w_street_number","type":"string","nullable":true,"metadata":{}},{"name":"w_street_name","type":"string","nullable":true,"metadata":{}},{"name":"w_street_type","type":"string","nullable":true,"metadata":{}},{"name":"w_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"w_city","type":"string","nullable":true,"metadata":{}},{"name":"w_county","type":"string","nullable":true,"metadata":{}},{"name":"w_state","type":"string","nullable":true,"metadata":{}},{"name":"w_zip","type":"string","nullable":true,"metadata":{}},{"name":"w_country","type":"string","nullable":true,"metadata":{}},{"name":"w_gmt_offset","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:09 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse_text-__PLACEHOLDER__
2018-11-08 14:17:09 INFO  CliDriver:951 - Time taken: 0.084 seconds
2018-11-08 14:17:09 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists warehouse
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse
2018-11-08 14:17:09 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:09 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse
2018-11-08 14:17:09 INFO  CliDriver:951 - Time taken: 0.106 seconds
2018-11-08 14:17:09 INFO  SparkSqlParser:54 - Parsing command: 
create table warehouse
using parquet
as (select * from warehouse_text)

2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:09 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:09 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:09 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:09 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:09 INFO  FileSourceStrategy:54 - Output Data Schema: struct<w_warehouse_sk: int, w_warehouse_id: string, w_warehouse_name: string, w_warehouse_sq_ft: int, w_street_number: string ... 12 more fields>
2018-11-08 14:17:09 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:09 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:09 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:09 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:09 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:09 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:09 INFO  MemoryStore:54 - Block broadcast_38 stored as values in memory (estimated size 283.4 KB, free 365.2 MB)
2018-11-08 14:17:09 INFO  MemoryStore:54 - Block broadcast_38_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.2 MB)
2018-11-08 14:17:09 INFO  BlockManagerInfo:54 - Added broadcast_38_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:09 INFO  SparkContext:54 - Created broadcast 38 from processCmd at CliDriver.java:376
2018-11-08 14:17:09 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:09 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Got job 19 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Final stage: ResultStage 19 (processCmd at CliDriver.java:376)
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:09 INFO  DAGScheduler:54 - Submitting ResultStage 19 (MapPartitionsRDD[58] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:10 INFO  MemoryStore:54 - Block broadcast_39 stored as values in memory (estimated size 86.8 KB, free 365.1 MB)
2018-11-08 14:17:10 INFO  MemoryStore:54 - Block broadcast_39_piece0 stored as bytes in memory (estimated size 33.1 KB, free 365.0 MB)
2018-11-08 14:17:10 INFO  BlockManagerInfo:54 - Added broadcast_39_piece0 in memory on 192.168.112.64:32870 (size: 33.1 KB, free: 366.1 MB)
2018-11-08 14:17:10 INFO  SparkContext:54 - Created broadcast 39 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 19 (MapPartitionsRDD[58] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:17:10 INFO  YarnScheduler:54 - Adding task set 19.0 with 1 tasks
2018-11-08 14:17:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 19.0 (TID 32, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5317 bytes)
2018-11-08 14:17:10 INFO  BlockManagerInfo:54 - Added broadcast_39_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 33.1 KB, free: 366.2 MB)
2018-11-08 14:17:10 INFO  BlockManagerInfo:54 - Added broadcast_38_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 19.0 (TID 32) in 551 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/1)
2018-11-08 14:17:10 INFO  YarnScheduler:54 - Removed TaskSet 19.0, whose tasks have all completed, from pool 
2018-11-08 14:17:10 INFO  DAGScheduler:54 - ResultStage 19 (processCmd at CliDriver.java:376) finished in 0,553 s
2018-11-08 14:17:10 INFO  DAGScheduler:54 - Job 19 finished: processCmd at CliDriver.java:376, took 0,572318 s
2018-11-08 14:17:10 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse	
2018-11-08 14:17:10 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`warehouse` into Hive metastore in Hive compatible format.
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:warehouse, dbName:tpcds, owner:gsd, createTime:1541686629, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:w_warehouse_sk, type:int, comment:null), FieldSchema(name:w_warehouse_id, type:string, comment:null), FieldSchema(name:w_warehouse_name, type:string, comment:null), FieldSchema(name:w_warehouse_sq_ft, type:int, comment:null), FieldSchema(name:w_street_number, type:string, comment:null), FieldSchema(name:w_street_name, type:string, comment:null), FieldSchema(name:w_street_type, type:string, comment:null), FieldSchema(name:w_suite_number, type:string, comment:null), FieldSchema(name:w_city, type:string, comment:null), FieldSchema(name:w_county, type:string, comment:null), FieldSchema(name:w_state, type:string, comment:null), FieldSchema(name:w_zip, type:string, comment:null), FieldSchema(name:w_country, type:string, comment:null), FieldSchema(name:w_gmt_offset, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"w_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"w_warehouse_id","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_name","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"w_street_number","type":"string","nullable":true,"metadata":{}},{"name":"w_street_name","type":"string","nullable":true,"metadata":{}},{"name":"w_street_type","type":"string","nullable":true,"metadata":{}},{"name":"w_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"w_city","type":"string","nullable":true,"metadata":{}},{"name":"w_county","type":"string","nullable":true,"metadata":{}},{"name":"w_state","type":"string","nullable":true,"metadata":{}},{"name":"w_zip","type":"string","nullable":true,"metadata":{}},{"name":"w_country","type":"string","nullable":true,"metadata":{}},{"name":"w_gmt_offset","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:warehouse, dbName:tpcds, owner:gsd, createTime:1541686629, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:w_warehouse_sk, type:int, comment:null), FieldSchema(name:w_warehouse_id, type:string, comment:null), FieldSchema(name:w_warehouse_name, type:string, comment:null), FieldSchema(name:w_warehouse_sq_ft, type:int, comment:null), FieldSchema(name:w_street_number, type:string, comment:null), FieldSchema(name:w_street_name, type:string, comment:null), FieldSchema(name:w_street_type, type:string, comment:null), FieldSchema(name:w_suite_number, type:string, comment:null), FieldSchema(name:w_city, type:string, comment:null), FieldSchema(name:w_county, type:string, comment:null), FieldSchema(name:w_state, type:string, comment:null), FieldSchema(name:w_zip, type:string, comment:null), FieldSchema(name:w_country, type:string, comment:null), FieldSchema(name:w_gmt_offset, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/warehouse, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"w_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"w_warehouse_id","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_name","type":"string","nullable":true,"metadata":{}},{"name":"w_warehouse_sq_ft","type":"integer","nullable":true,"metadata":{}},{"name":"w_street_number","type":"string","nullable":true,"metadata":{}},{"name":"w_street_name","type":"string","nullable":true,"metadata":{}},{"name":"w_street_type","type":"string","nullable":true,"metadata":{}},{"name":"w_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"w_city","type":"string","nullable":true,"metadata":{}},{"name":"w_county","type":"string","nullable":true,"metadata":{}},{"name":"w_state","type":"string","nullable":true,"metadata":{}},{"name":"w_zip","type":"string","nullable":true,"metadata":{}},{"name":"w_country","type":"string","nullable":true,"metadata":{}},{"name":"w_gmt_offset","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:10 INFO  log:217 - Updating table stats fast for warehouse
2018-11-08 14:17:10 INFO  log:219 - Updated size of table warehouse to 3725
2018-11-08 14:17:10 INFO  CliDriver:951 - Time taken: 0.759 seconds
2018-11-08 14:17:10 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists warehouse_text
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=warehouse_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=warehouse_text	
2018-11-08 14:17:10 INFO  CliDriver:951 - Time taken: 0.083 seconds
2018-11-08 14:17:10 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists web_page_text
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:10 INFO  CliDriver:951 - Time taken: 0.006 seconds
2018-11-08 14:17:10 INFO  SparkSqlParser:54 - Parsing command: 
create table web_page_text
(
wp_web_page_sk            int,
wp_web_page_id            string,
wp_rec_start_date         string,
wp_rec_end_date           string,
wp_creation_date_sk       int,
wp_access_date_sk         int,
wp_autogen_flag           string,
wp_customer_sk            int,
wp_url                    string,
wp_type                   string,
wp_char_count             int,
wp_link_count             int,
wp_image_count            int,
wp_max_ad_count           int
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_page.csv")

2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:10 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`web_page_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_page_text, dbName:tpcds, owner:gsd, createTime:1541686630, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_page_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_page.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wp_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_web_page_id","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_creation_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_access_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_autogen_flag","type":"string","nullable":true,"metadata":{}},{"name":"wp_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_url","type":"string","nullable":true,"metadata":{}},{"name":"wp_type","type":"string","nullable":true,"metadata":{}},{"name":"wp_char_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_link_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_image_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_max_ad_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_page_text, dbName:tpcds, owner:gsd, createTime:1541686630, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_page_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_page.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wp_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_web_page_id","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_creation_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_access_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_autogen_flag","type":"string","nullable":true,"metadata":{}},{"name":"wp_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_url","type":"string","nullable":true,"metadata":{}},{"name":"wp_type","type":"string","nullable":true,"metadata":{}},{"name":"wp_char_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_link_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_image_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_max_ad_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:10 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/web_page_text-__PLACEHOLDER__
2018-11-08 14:17:10 INFO  CliDriver:951 - Time taken: 0.13 seconds
2018-11-08 14:17:10 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_page
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_page
2018-11-08 14:17:10 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_page	
2018-11-08 14:17:10 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/web_page
2018-11-08 14:17:10 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:11 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/web_page
2018-11-08 14:17:11 INFO  CliDriver:951 - Time taken: 0.113 seconds
2018-11-08 14:17:11 INFO  SparkSqlParser:54 - Parsing command: 
create table web_page
using parquet
as (select * from web_page_text)

2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:11 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:11 INFO  FileSourceStrategy:54 - Output Data Schema: struct<wp_web_page_sk: int, wp_web_page_id: string, wp_rec_start_date: string, wp_rec_end_date: string, wp_creation_date_sk: int ... 12 more fields>
2018-11-08 14:17:11 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:11 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:11 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:11 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:11 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:11 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:11 INFO  MemoryStore:54 - Block broadcast_40 stored as values in memory (estimated size 283.4 KB, free 364.8 MB)
2018-11-08 14:17:11 INFO  MemoryStore:54 - Block broadcast_40_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.7 MB)
2018-11-08 14:17:11 INFO  BlockManagerInfo:54 - Added broadcast_40_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:11 INFO  SparkContext:54 - Created broadcast 40 from processCmd at CliDriver.java:376
2018-11-08 14:17:11 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:11 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Got job 20 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Final stage: ResultStage 20 (processCmd at CliDriver.java:376)
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Submitting ResultStage 20 (MapPartitionsRDD[61] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:11 INFO  MemoryStore:54 - Block broadcast_41 stored as values in memory (estimated size 86.8 KB, free 364.7 MB)
2018-11-08 14:17:11 INFO  MemoryStore:54 - Block broadcast_41_piece0 stored as bytes in memory (estimated size 33.1 KB, free 364.6 MB)
2018-11-08 14:17:11 INFO  BlockManagerInfo:54 - Added broadcast_41_piece0 in memory on 192.168.112.64:32870 (size: 33.1 KB, free: 366.1 MB)
2018-11-08 14:17:11 INFO  SparkContext:54 - Created broadcast 41 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 20 (MapPartitionsRDD[61] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:17:11 INFO  YarnScheduler:54 - Adding task set 20.0 with 1 tasks
2018-11-08 14:17:11 INFO  TaskSetManager:54 - Starting task 0.0 in stage 20.0 (TID 33, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5316 bytes)
2018-11-08 14:17:11 INFO  BlockManagerInfo:54 - Added broadcast_41_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.1 KB, free: 366.2 MB)
2018-11-08 14:17:11 INFO  BlockManagerInfo:54 - Added broadcast_40_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:11 INFO  TaskSetManager:54 - Finished task 0.0 in stage 20.0 (TID 33) in 610 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:17:11 INFO  YarnScheduler:54 - Removed TaskSet 20.0, whose tasks have all completed, from pool 
2018-11-08 14:17:11 INFO  DAGScheduler:54 - ResultStage 20 (processCmd at CliDriver.java:376) finished in 0,612 s
2018-11-08 14:17:11 INFO  DAGScheduler:54 - Job 20 finished: processCmd at CliDriver.java:376, took 0,626120 s
2018-11-08 14:17:11 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page	
2018-11-08 14:17:11 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`web_page` into Hive metastore in Hive compatible format.
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_page, dbName:tpcds, owner:gsd, createTime:1541686631, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:wp_web_page_sk, type:int, comment:null), FieldSchema(name:wp_web_page_id, type:string, comment:null), FieldSchema(name:wp_rec_start_date, type:string, comment:null), FieldSchema(name:wp_rec_end_date, type:string, comment:null), FieldSchema(name:wp_creation_date_sk, type:int, comment:null), FieldSchema(name:wp_access_date_sk, type:int, comment:null), FieldSchema(name:wp_autogen_flag, type:string, comment:null), FieldSchema(name:wp_customer_sk, type:int, comment:null), FieldSchema(name:wp_url, type:string, comment:null), FieldSchema(name:wp_type, type:string, comment:null), FieldSchema(name:wp_char_count, type:int, comment:null), FieldSchema(name:wp_link_count, type:int, comment:null), FieldSchema(name:wp_image_count, type:int, comment:null), FieldSchema(name:wp_max_ad_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_page, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wp_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_web_page_id","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_creation_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_access_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_autogen_flag","type":"string","nullable":true,"metadata":{}},{"name":"wp_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_url","type":"string","nullable":true,"metadata":{}},{"name":"wp_type","type":"string","nullable":true,"metadata":{}},{"name":"wp_char_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_link_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_image_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_max_ad_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_page, dbName:tpcds, owner:gsd, createTime:1541686631, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:wp_web_page_sk, type:int, comment:null), FieldSchema(name:wp_web_page_id, type:string, comment:null), FieldSchema(name:wp_rec_start_date, type:string, comment:null), FieldSchema(name:wp_rec_end_date, type:string, comment:null), FieldSchema(name:wp_creation_date_sk, type:int, comment:null), FieldSchema(name:wp_access_date_sk, type:int, comment:null), FieldSchema(name:wp_autogen_flag, type:string, comment:null), FieldSchema(name:wp_customer_sk, type:int, comment:null), FieldSchema(name:wp_url, type:string, comment:null), FieldSchema(name:wp_type, type:string, comment:null), FieldSchema(name:wp_char_count, type:int, comment:null), FieldSchema(name:wp_link_count, type:int, comment:null), FieldSchema(name:wp_image_count, type:int, comment:null), FieldSchema(name:wp_max_ad_count, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_page, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wp_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_web_page_id","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"wp_creation_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_access_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_autogen_flag","type":"string","nullable":true,"metadata":{}},{"name":"wp_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wp_url","type":"string","nullable":true,"metadata":{}},{"name":"wp_type","type":"string","nullable":true,"metadata":{}},{"name":"wp_char_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_link_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_image_count","type":"integer","nullable":true,"metadata":{}},{"name":"wp_max_ad_count","type":"integer","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:11 INFO  log:217 - Updating table stats fast for web_page
2018-11-08 14:17:11 INFO  log:219 - Updated size of table web_page to 5011
2018-11-08 14:17:11 INFO  CliDriver:951 - Time taken: 0.812 seconds
2018-11-08 14:17:11 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_page_text
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_page_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_page_text	
2018-11-08 14:17:11 INFO  CliDriver:951 - Time taken: 0.1 seconds
2018-11-08 14:17:11 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists web_returns_text
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:11 INFO  CliDriver:951 - Time taken: 0.009 seconds
2018-11-08 14:17:11 INFO  SparkSqlParser:54 - Parsing command: 
create table web_returns_text
(
wr_returned_date_sk       int,
wr_returned_time_sk       int,
wr_item_sk                int,
wr_refunded_customer_sk   int,
wr_refunded_cdemo_sk      int,
wr_refunded_hdemo_sk      int,
wr_refunded_addr_sk       int,
wr_returning_customer_sk  int,
wr_returning_cdemo_sk     int,
wr_returning_hdemo_sk     int,
wr_returning_addr_sk      int,
wr_web_page_sk            int,
wr_reason_sk              int,
wr_order_number           int,
wr_return_quantity        int,
wr_return_amt             double,
wr_return_tax             double,
wr_return_amt_inc_tax     double,
wr_fee                    double,
wr_return_ship_cost       double,
wr_refunded_cash          double,
wr_reversed_charge        double,
wr_account_credit         double,
wr_net_loss               double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_returns.csv")

2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:11 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`web_returns_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:11 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_returns_text, dbName:tpcds, owner:gsd, createTime:1541686631, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_fee","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"wr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"wr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"wr_account_credit","type":"double","nullable":true,"metadata":{}},{"name":"wr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:11 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_returns_text, dbName:tpcds, owner:gsd, createTime:1541686631, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_returns.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_fee","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"wr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"wr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"wr_account_credit","type":"double","nullable":true,"metadata":{}},{"name":"wr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:11 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns_text-__PLACEHOLDER__
2018-11-08 14:17:12 INFO  CliDriver:951 - Time taken: 0.077 seconds
2018-11-08 14:17:12 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_returns
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns
2018-11-08 14:17:12 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:12 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns
2018-11-08 14:17:12 INFO  CliDriver:951 - Time taken: 0.112 seconds
2018-11-08 14:17:12 INFO  SparkSqlParser:54 - Parsing command: 
create table web_returns
using parquet
as (select * from web_returns_text)

2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:12 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:12 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:12 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:12 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:12 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:12 INFO  FileSourceStrategy:54 - Output Data Schema: struct<wr_returned_date_sk: int, wr_returned_time_sk: int, wr_item_sk: int, wr_refunded_customer_sk: int, wr_refunded_cdemo_sk: int ... 22 more fields>
2018-11-08 14:17:12 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:12 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:12 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:12 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:12 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:12 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:12 INFO  MemoryStore:54 - Block broadcast_42 stored as values in memory (estimated size 283.4 KB, free 364.4 MB)
2018-11-08 14:17:12 INFO  MemoryStore:54 - Block broadcast_42_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.3 MB)
2018-11-08 14:17:12 INFO  BlockManagerInfo:54 - Added broadcast_42_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:12 INFO  SparkContext:54 - Created broadcast 42 from processCmd at CliDriver.java:376
2018-11-08 14:17:12 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 6964388 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:12 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Got job 21 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Final stage: ResultStage 21 (processCmd at CliDriver.java:376)
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Submitting ResultStage 21 (MapPartitionsRDD[64] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:12 INFO  MemoryStore:54 - Block broadcast_43 stored as values in memory (estimated size 89.5 KB, free 364.2 MB)
2018-11-08 14:17:12 INFO  MemoryStore:54 - Block broadcast_43_piece0 stored as bytes in memory (estimated size 33.7 KB, free 364.2 MB)
2018-11-08 14:17:12 INFO  BlockManagerInfo:54 - Added broadcast_43_piece0 in memory on 192.168.112.64:32870 (size: 33.7 KB, free: 366.0 MB)
2018-11-08 14:17:12 INFO  SparkContext:54 - Created broadcast 43 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:12 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 21 (MapPartitionsRDD[64] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:17:12 INFO  YarnScheduler:54 - Adding task set 21.0 with 2 tasks
2018-11-08 14:17:12 INFO  TaskSetManager:54 - Starting task 0.0 in stage 21.0 (TID 34, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5319 bytes)
2018-11-08 14:17:12 INFO  BlockManagerInfo:54 - Added broadcast_43_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.7 KB, free: 366.2 MB)
2018-11-08 14:17:12 INFO  BlockManagerInfo:54 - Added broadcast_42_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:13 INFO  TaskSetManager:54 - Starting task 1.0 in stage 21.0 (TID 35, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, NODE_LOCAL, 5319 bytes)
2018-11-08 14:17:13 INFO  TaskSetManager:54 - Finished task 0.0 in stage 21.0 (TID 34) in 1293 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/2)
2018-11-08 14:17:14 INFO  TaskSetManager:54 - Finished task 1.0 in stage 21.0 (TID 35) in 815 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:17:14 INFO  YarnScheduler:54 - Removed TaskSet 21.0, whose tasks have all completed, from pool 
2018-11-08 14:17:14 INFO  DAGScheduler:54 - ResultStage 21 (processCmd at CliDriver.java:376) finished in 2,108 s
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Job 21 finished: processCmd at CliDriver.java:376, took 2,124106 s
2018-11-08 14:17:14 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns	
2018-11-08 14:17:14 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`web_returns` into Hive metastore in Hive compatible format.
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_returns, dbName:tpcds, owner:gsd, createTime:1541686632, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:wr_returned_date_sk, type:int, comment:null), FieldSchema(name:wr_returned_time_sk, type:int, comment:null), FieldSchema(name:wr_item_sk, type:int, comment:null), FieldSchema(name:wr_refunded_customer_sk, type:int, comment:null), FieldSchema(name:wr_refunded_cdemo_sk, type:int, comment:null), FieldSchema(name:wr_refunded_hdemo_sk, type:int, comment:null), FieldSchema(name:wr_refunded_addr_sk, type:int, comment:null), FieldSchema(name:wr_returning_customer_sk, type:int, comment:null), FieldSchema(name:wr_returning_cdemo_sk, type:int, comment:null), FieldSchema(name:wr_returning_hdemo_sk, type:int, comment:null), FieldSchema(name:wr_returning_addr_sk, type:int, comment:null), FieldSchema(name:wr_web_page_sk, type:int, comment:null), FieldSchema(name:wr_reason_sk, type:int, comment:null), FieldSchema(name:wr_order_number, type:int, comment:null), FieldSchema(name:wr_return_quantity, type:int, comment:null), FieldSchema(name:wr_return_amt, type:double, comment:null), FieldSchema(name:wr_return_tax, type:double, comment:null), FieldSchema(name:wr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:wr_fee, type:double, comment:null), FieldSchema(name:wr_return_ship_cost, type:double, comment:null), FieldSchema(name:wr_refunded_cash, type:double, comment:null), FieldSchema(name:wr_reversed_charge, type:double, comment:null), FieldSchema(name:wr_account_credit, type:double, comment:null), FieldSchema(name:wr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_fee","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"wr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"wr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"wr_account_credit","type":"double","nullable":true,"metadata":{}},{"name":"wr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_returns, dbName:tpcds, owner:gsd, createTime:1541686632, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:wr_returned_date_sk, type:int, comment:null), FieldSchema(name:wr_returned_time_sk, type:int, comment:null), FieldSchema(name:wr_item_sk, type:int, comment:null), FieldSchema(name:wr_refunded_customer_sk, type:int, comment:null), FieldSchema(name:wr_refunded_cdemo_sk, type:int, comment:null), FieldSchema(name:wr_refunded_hdemo_sk, type:int, comment:null), FieldSchema(name:wr_refunded_addr_sk, type:int, comment:null), FieldSchema(name:wr_returning_customer_sk, type:int, comment:null), FieldSchema(name:wr_returning_cdemo_sk, type:int, comment:null), FieldSchema(name:wr_returning_hdemo_sk, type:int, comment:null), FieldSchema(name:wr_returning_addr_sk, type:int, comment:null), FieldSchema(name:wr_web_page_sk, type:int, comment:null), FieldSchema(name:wr_reason_sk, type:int, comment:null), FieldSchema(name:wr_order_number, type:int, comment:null), FieldSchema(name:wr_return_quantity, type:int, comment:null), FieldSchema(name:wr_return_amt, type:double, comment:null), FieldSchema(name:wr_return_tax, type:double, comment:null), FieldSchema(name:wr_return_amt_inc_tax, type:double, comment:null), FieldSchema(name:wr_fee, type:double, comment:null), FieldSchema(name:wr_return_ship_cost, type:double, comment:null), FieldSchema(name:wr_refunded_cash, type:double, comment:null), FieldSchema(name:wr_reversed_charge, type:double, comment:null), FieldSchema(name:wr_account_credit, type:double, comment:null), FieldSchema(name:wr_net_loss, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_returns, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"wr_returned_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returned_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_refunded_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_returning_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_reason_sk","type":"integer","nullable":true,"metadata":{}},{"name":"wr_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"wr_return_amt","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_amt_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"wr_fee","type":"double","nullable":true,"metadata":{}},{"name":"wr_return_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"wr_refunded_cash","type":"double","nullable":true,"metadata":{}},{"name":"wr_reversed_charge","type":"double","nullable":true,"metadata":{}},{"name":"wr_account_credit","type":"double","nullable":true,"metadata":{}},{"name":"wr_net_loss","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:14 INFO  log:217 - Updating table stats fast for web_returns
2018-11-08 14:17:14 INFO  log:219 - Updated size of table web_returns to 5955799
2018-11-08 14:17:14 INFO  CliDriver:951 - Time taken: 2.337 seconds
2018-11-08 14:17:14 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_returns_text
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_returns_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_returns_text	
2018-11-08 14:17:14 INFO  CliDriver:951 - Time taken: 0.083 seconds
2018-11-08 14:17:14 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists web_sales_text
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 INFO  CliDriver:951 - Time taken: 0.007 seconds
2018-11-08 14:17:14 INFO  SparkSqlParser:54 - Parsing command: 
create table web_sales_text
(
ws_sold_date_sk           int,
ws_sold_time_sk           int,
ws_ship_date_sk           int,
ws_item_sk                int,
ws_bill_customer_sk       int,
ws_bill_cdemo_sk          int,
ws_bill_hdemo_sk          int,
ws_bill_addr_sk           int,
ws_ship_customer_sk       int,
ws_ship_cdemo_sk          int,
ws_ship_hdemo_sk          int,
ws_ship_addr_sk           int,
ws_web_page_sk            int,
ws_web_site_sk            int,
ws_ship_mode_sk           int,
ws_warehouse_sk           int,
ws_promo_sk               int,
ws_order_number           int,
ws_quantity               int,
ws_wholesale_cost         double,
ws_list_price             double,
ws_sales_price            double,
ws_ext_discount_amt       double,
ws_ext_sales_price        double,
ws_ext_wholesale_cost     double,
ws_ext_list_price         double,
ws_ext_tax                double,
ws_coupon_amt             double,
ws_ext_ship_cost          double,
ws_net_paid               double,
ws_net_paid_inc_tax       double,
ws_net_paid_inc_ship      double,
ws_net_paid_inc_ship_tax  double,
ws_net_profit             double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_sales.csv")

2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`web_sales_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_sales_text, dbName:tpcds, owner:gsd, createTime:1541686634, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ws_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"ws_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ws_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_sales_text, dbName:tpcds, owner:gsd, createTime:1541686634, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_sales.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ws_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"ws_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ws_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:14 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales_text-__PLACEHOLDER__
2018-11-08 14:17:14 INFO  CliDriver:951 - Time taken: 0.078 seconds
2018-11-08 14:17:14 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_sales
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales
2018-11-08 14:17:14 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:14 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales
2018-11-08 14:17:14 INFO  CliDriver:951 - Time taken: 0.133 seconds
2018-11-08 14:17:14 INFO  SparkSqlParser:54 - Parsing command: 
create table web_sales
using parquet
as (select * from web_sales_text)

2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:14 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:14 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 746
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 708
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 641
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 673
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_43_piece0 on 192.168.112.64:32870 in memory (size: 33.7 KB, free: 366.1 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_43_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.7 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:14 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:14 INFO  FileSourceStrategy:54 - Output Data Schema: struct<ws_sold_date_sk: int, ws_sold_time_sk: int, ws_ship_date_sk: int, ws_item_sk: int, ws_bill_customer_sk: int ... 32 more fields>
2018-11-08 14:17:14 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 638
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 771
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 703
2018-11-08 14:17:14 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_36_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_36_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:14 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:14 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:14 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 711
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 709
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 741
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 707
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 738
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 669
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 642
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 675
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 745
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 610
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 644
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 643
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 740
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 639
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_34_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_34_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_34_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_40_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.1 MB)
2018-11-08 14:17:14 INFO  MemoryStore:54 - Block broadcast_44 stored as values in memory (estimated size 283.4 KB, free 365.0 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_40_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 671
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 636
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 772
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_35_piece0 on 192.168.112.64:32870 in memory (size: 33.6 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_35_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 33.6 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_35_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.6 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  MemoryStore:54 - Block broadcast_44_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.1 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_42_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Added broadcast_44_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  SparkContext:54 - Created broadcast 44 from processCmd at CliDriver.java:376
2018-11-08 14:17:14 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 75176297 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_42_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 773
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 742
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 737
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 774
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 640
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_37_piece0 on 192.168.112.64:32870 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_37_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 32.8 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_41_piece0 on 192.168.112.64:32870 in memory (size: 33.1 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_41_piece0 on cloud70.cluster.lsd.di.uminho.pt:44385 in memory (size: 33.1 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 672
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 676
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 608
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 706
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 606
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 674
2018-11-08 14:17:14 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Got job 22 (processCmd at CliDriver.java:376) with 2 output partitions
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Final stage: ResultStage 22 (processCmd at CliDriver.java:376)
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Submitting ResultStage 22 (MapPartitionsRDD[67] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_38_piece0 on 192.168.112.64:32870 in memory (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_38_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 23.5 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_39_piece0 on cloud74.cluster.lsd.di.uminho.pt:38882 in memory (size: 33.1 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Removed broadcast_39_piece0 on 192.168.112.64:32870 in memory (size: 33.1 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 712
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 670
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 705
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 704
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 607
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 637
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 739
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 743
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 678
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 744
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 609
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 710
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 635
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 677
2018-11-08 14:17:14 INFO  ContextCleaner:54 - Cleaned accumulator 775
2018-11-08 14:17:14 INFO  MemoryStore:54 - Block broadcast_45 stored as values in memory (estimated size 92.0 KB, free 365.9 MB)
2018-11-08 14:17:14 INFO  MemoryStore:54 - Block broadcast_45_piece0 stored as bytes in memory (estimated size 34.2 KB, free 365.9 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Added broadcast_45_piece0 in memory on 192.168.112.64:32870 (size: 34.2 KB, free: 366.2 MB)
2018-11-08 14:17:14 INFO  SparkContext:54 - Created broadcast 45 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:14 INFO  DAGScheduler:54 - Submitting 2 missing tasks from ResultStage 22 (MapPartitionsRDD[67] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0, 1))
2018-11-08 14:17:14 INFO  YarnScheduler:54 - Adding task set 22.0 with 2 tasks
2018-11-08 14:17:14 INFO  TaskSetManager:54 - Starting task 0.0 in stage 22.0 (TID 36, cloud74.cluster.lsd.di.uminho.pt, executor 2, partition 0, NODE_LOCAL, 5317 bytes)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Added broadcast_45_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 34.2 KB, free: 366.3 MB)
2018-11-08 14:17:14 INFO  BlockManagerInfo:54 - Added broadcast_44_piece0 in memory on cloud74.cluster.lsd.di.uminho.pt:38882 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:18 INFO  TaskSetManager:54 - Starting task 1.0 in stage 22.0 (TID 37, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 1, RACK_LOCAL, 5317 bytes)
2018-11-08 14:17:18 INFO  BlockManagerInfo:54 - Added broadcast_45_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 34.2 KB, free: 366.3 MB)
2018-11-08 14:17:18 INFO  BlockManagerInfo:54 - Added broadcast_44_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:19 INFO  TaskSetManager:54 - Finished task 0.0 in stage 22.0 (TID 36) in 4223 ms on cloud74.cluster.lsd.di.uminho.pt (executor 2) (1/2)
2018-11-08 14:17:23 INFO  TaskSetManager:54 - Finished task 1.0 in stage 22.0 (TID 37) in 5069 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (2/2)
2018-11-08 14:17:23 INFO  YarnScheduler:54 - Removed TaskSet 22.0, whose tasks have all completed, from pool 
2018-11-08 14:17:23 INFO  DAGScheduler:54 - ResultStage 22 (processCmd at CliDriver.java:376) finished in 8,635 s
2018-11-08 14:17:23 INFO  DAGScheduler:54 - Job 22 finished: processCmd at CliDriver.java:376, took 8,657299 s
2018-11-08 14:17:23 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales	
2018-11-08 14:17:23 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`web_sales` into Hive metastore in Hive compatible format.
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_sales, dbName:tpcds, owner:gsd, createTime:1541686634, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ws_sold_date_sk, type:int, comment:null), FieldSchema(name:ws_sold_time_sk, type:int, comment:null), FieldSchema(name:ws_ship_date_sk, type:int, comment:null), FieldSchema(name:ws_item_sk, type:int, comment:null), FieldSchema(name:ws_bill_customer_sk, type:int, comment:null), FieldSchema(name:ws_bill_cdemo_sk, type:int, comment:null), FieldSchema(name:ws_bill_hdemo_sk, type:int, comment:null), FieldSchema(name:ws_bill_addr_sk, type:int, comment:null), FieldSchema(name:ws_ship_customer_sk, type:int, comment:null), FieldSchema(name:ws_ship_cdemo_sk, type:int, comment:null), FieldSchema(name:ws_ship_hdemo_sk, type:int, comment:null), FieldSchema(name:ws_ship_addr_sk, type:int, comment:null), FieldSchema(name:ws_web_page_sk, type:int, comment:null), FieldSchema(name:ws_web_site_sk, type:int, comment:null), FieldSchema(name:ws_ship_mode_sk, type:int, comment:null), FieldSchema(name:ws_warehouse_sk, type:int, comment:null), FieldSchema(name:ws_promo_sk, type:int, comment:null), FieldSchema(name:ws_order_number, type:int, comment:null), FieldSchema(name:ws_quantity, type:int, comment:null), FieldSchema(name:ws_wholesale_cost, type:double, comment:null), FieldSchema(name:ws_list_price, type:double, comment:null), FieldSchema(name:ws_sales_price, type:double, comment:null), FieldSchema(name:ws_ext_discount_amt, type:double, comment:null), FieldSchema(name:ws_ext_sales_price, type:double, comment:null), FieldSchema(name:ws_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:ws_ext_list_price, type:double, comment:null), FieldSchema(name:ws_ext_tax, type:double, comment:null), FieldSchema(name:ws_coupon_amt, type:double, comment:null), FieldSchema(name:ws_ext_ship_cost, type:double, comment:null), FieldSchema(name:ws_net_paid, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_ship, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_ship_tax, type:double, comment:null), FieldSchema(name:ws_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ws_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"ws_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ws_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_sales, dbName:tpcds, owner:gsd, createTime:1541686634, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:ws_sold_date_sk, type:int, comment:null), FieldSchema(name:ws_sold_time_sk, type:int, comment:null), FieldSchema(name:ws_ship_date_sk, type:int, comment:null), FieldSchema(name:ws_item_sk, type:int, comment:null), FieldSchema(name:ws_bill_customer_sk, type:int, comment:null), FieldSchema(name:ws_bill_cdemo_sk, type:int, comment:null), FieldSchema(name:ws_bill_hdemo_sk, type:int, comment:null), FieldSchema(name:ws_bill_addr_sk, type:int, comment:null), FieldSchema(name:ws_ship_customer_sk, type:int, comment:null), FieldSchema(name:ws_ship_cdemo_sk, type:int, comment:null), FieldSchema(name:ws_ship_hdemo_sk, type:int, comment:null), FieldSchema(name:ws_ship_addr_sk, type:int, comment:null), FieldSchema(name:ws_web_page_sk, type:int, comment:null), FieldSchema(name:ws_web_site_sk, type:int, comment:null), FieldSchema(name:ws_ship_mode_sk, type:int, comment:null), FieldSchema(name:ws_warehouse_sk, type:int, comment:null), FieldSchema(name:ws_promo_sk, type:int, comment:null), FieldSchema(name:ws_order_number, type:int, comment:null), FieldSchema(name:ws_quantity, type:int, comment:null), FieldSchema(name:ws_wholesale_cost, type:double, comment:null), FieldSchema(name:ws_list_price, type:double, comment:null), FieldSchema(name:ws_sales_price, type:double, comment:null), FieldSchema(name:ws_ext_discount_amt, type:double, comment:null), FieldSchema(name:ws_ext_sales_price, type:double, comment:null), FieldSchema(name:ws_ext_wholesale_cost, type:double, comment:null), FieldSchema(name:ws_ext_list_price, type:double, comment:null), FieldSchema(name:ws_ext_tax, type:double, comment:null), FieldSchema(name:ws_coupon_amt, type:double, comment:null), FieldSchema(name:ws_ext_ship_cost, type:double, comment:null), FieldSchema(name:ws_net_paid, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_tax, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_ship, type:double, comment:null), FieldSchema(name:ws_net_paid_inc_ship_tax, type:double, comment:null), FieldSchema(name:ws_net_profit, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_sales, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"ws_sold_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_sold_time_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_item_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_bill_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_customer_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_cdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_hdemo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_addr_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_page_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_ship_mode_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_warehouse_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_promo_sk","type":"integer","nullable":true,"metadata":{}},{"name":"ws_order_number","type":"integer","nullable":true,"metadata":{}},{"name":"ws_quantity","type":"integer","nullable":true,"metadata":{}},{"name":"ws_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_discount_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_sales_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_wholesale_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_list_price","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_coupon_amt","type":"double","nullable":true,"metadata":{}},{"name":"ws_ext_ship_cost","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_paid_inc_ship_tax","type":"double","nullable":true,"metadata":{}},{"name":"ws_net_profit","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:23 INFO  log:217 - Updating table stats fast for web_sales
2018-11-08 14:17:23 INFO  log:219 - Updated size of table web_sales to 55224492
2018-11-08 14:17:23 INFO  CliDriver:951 - Time taken: 8.979 seconds
2018-11-08 14:17:23 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_sales_text
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_sales_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_sales_text	
2018-11-08 14:17:23 INFO  CliDriver:951 - Time taken: 0.091 seconds
2018-11-08 14:17:23 INFO  SparkSqlParser:54 - Parsing command: 

drop table if exists web_site_text
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:23 INFO  CliDriver:951 - Time taken: 0.008 seconds
2018-11-08 14:17:23 INFO  SparkSqlParser:54 - Parsing command: 
create table web_site_text
(
web_site_sk               int,
web_site_id               string,
web_rec_start_date        string,
web_rec_end_date          string,
web_name                  string,
web_open_date_sk          int,
web_close_date_sk         int,
web_class                 string,
web_manager               string,
web_mkt_id                int,
web_mkt_class             string,
web_mkt_desc              string,
web_market_manager        string,
web_company_id            int,
web_company_name          string,
web_street_number         string,
web_street_name           string,
web_street_type           string,
web_suite_number          string,
web_city                  string,
web_county                string,
web_state                 string,
web_zip                   string,
web_country               string,
web_gmt_offset            double,
web_tax_percentage        double
)
USING csv
OPTIONS(header "false", delimiter "|", path "hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_site.csv")

2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:23 WARN  HiveExternalCatalog:66 - Couldn't find corresponding Hive SerDe for data source provider csv. Persisting data source table `tpcds`.`web_site_text` into Hive metastore in Spark SQL specific format, which is NOT compatible with Hive.
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_site_text, dbName:tpcds, owner:gsd, createTime:1541686643, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_site_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_site.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_site_id","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"web_name","type":"string","nullable":true,"metadata":{}},{"name":"web_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_close_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_class","type":"string","nullable":true,"metadata":{}},{"name":"web_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"web_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_company_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_number","type":"string","nullable":true,"metadata":{}},{"name":"web_street_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_type","type":"string","nullable":true,"metadata":{}},{"name":"web_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"web_city","type":"string","nullable":true,"metadata":{}},{"name":"web_county","type":"string","nullable":true,"metadata":{}},{"name":"web_state","type":"string","nullable":true,"metadata":{}},{"name":"web_zip","type":"string","nullable":true,"metadata":{}},{"name":"web_country","type":"string","nullable":true,"metadata":{}},{"name":"web_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"web_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_site_text, dbName:tpcds, owner:gsd, createTime:1541686643, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:col, type:array<string>, comment:from deserializer)], location:hdfs://cloud64:9000/home/gsd/tpcds.db/web_site_text-__PLACEHOLDER__, inputFormat:org.apache.hadoop.mapred.SequenceFileInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/TPC-DS_Spark_HBase/gendata/web_site.csv, delimiter=|, header=false, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{EXTERNAL=TRUE, spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_site_id","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"web_name","type":"string","nullable":true,"metadata":{}},{"name":"web_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_close_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_class","type":"string","nullable":true,"metadata":{}},{"name":"web_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"web_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_company_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_number","type":"string","nullable":true,"metadata":{}},{"name":"web_street_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_type","type":"string","nullable":true,"metadata":{}},{"name":"web_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"web_city","type":"string","nullable":true,"metadata":{}},{"name":"web_county","type":"string","nullable":true,"metadata":{}},{"name":"web_state","type":"string","nullable":true,"metadata":{}},{"name":"web_zip","type":"string","nullable":true,"metadata":{}},{"name":"web_country","type":"string","nullable":true,"metadata":{}},{"name":"web_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"web_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=csv}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:23 INFO  FileUtils:501 - Creating directory if it doesn't exist: hdfs://cloud64:9000/home/gsd/tpcds.db/web_site_text-__PLACEHOLDER__
2018-11-08 14:17:23 INFO  CliDriver:951 - Time taken: 0.078 seconds
2018-11-08 14:17:23 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_site
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: int
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: string
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:23 INFO  CatalystSqlParser:54 - Parsing command: double
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:23 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_site
2018-11-08 14:17:23 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_site	
2018-11-08 14:17:24 INFO  hivemetastoressimpl:41 - deleting  hdfs://cloud64:9000/home/gsd/tpcds.db/web_site
2018-11-08 14:17:24 INFO  TrashPolicyDefault:92 - Namenode trash configuration: Deletion interval = 0 minutes, Emptier interval = 0 minutes.
2018-11-08 14:17:24 INFO  hivemetastoressimpl:53 - Deleted the diretory hdfs://cloud64:9000/home/gsd/tpcds.db/web_site
2018-11-08 14:17:24 INFO  CliDriver:951 - Time taken: 0.132 seconds
2018-11-08 14:17:24 INFO  SparkSqlParser:54 - Parsing command: 
create table web_site
using parquet
as (select * from web_site_text)

2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  FileSourceStrategy:54 - Pruning directories with: 
2018-11-08 14:17:24 INFO  FileSourceStrategy:54 - Post-Scan Filters: 
2018-11-08 14:17:24 INFO  FileSourceStrategy:54 - Output Data Schema: struct<web_site_sk: int, web_site_id: string, web_rec_start_date: string, web_rec_end_date: string, web_name: string ... 24 more fields>
2018-11-08 14:17:24 INFO  FileSourceScanExec:54 - Pushed Filters: 
2018-11-08 14:17:24 INFO  ParquetFileFormat:54 - Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:24 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:24 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:24 INFO  FileOutputCommitter:108 - File Output Committer Algorithm version is 1
2018-11-08 14:17:24 INFO  SQLHadoopMapReduceCommitProtocol:54 - Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
2018-11-08 14:17:24 INFO  MemoryStore:54 - Block broadcast_46 stored as values in memory (estimated size 283.4 KB, free 365.6 MB)
2018-11-08 14:17:24 INFO  MemoryStore:54 - Block broadcast_46_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.6 MB)
2018-11-08 14:17:24 INFO  BlockManagerInfo:54 - Added broadcast_46_piece0 in memory on 192.168.112.64:32870 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:24 INFO  SparkContext:54 - Created broadcast 46 from processCmd at CliDriver.java:376
2018-11-08 14:17:24 INFO  FileSourceScanExec:54 - Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
2018-11-08 14:17:24 INFO  SparkContext:54 - Starting job: processCmd at CliDriver.java:376
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Got job 23 (processCmd at CliDriver.java:376) with 1 output partitions
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Final stage: ResultStage 23 (processCmd at CliDriver.java:376)
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Parents of final stage: List()
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Missing parents: List()
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Submitting ResultStage 23 (MapPartitionsRDD[70] at processCmd at CliDriver.java:376), which has no missing parents
2018-11-08 14:17:24 INFO  MemoryStore:54 - Block broadcast_47 stored as values in memory (estimated size 89.9 KB, free 365.5 MB)
2018-11-08 14:17:24 INFO  MemoryStore:54 - Block broadcast_47_piece0 stored as bytes in memory (estimated size 33.7 KB, free 365.5 MB)
2018-11-08 14:17:24 INFO  BlockManagerInfo:54 - Added broadcast_47_piece0 in memory on 192.168.112.64:32870 (size: 33.7 KB, free: 366.2 MB)
2018-11-08 14:17:24 INFO  SparkContext:54 - Created broadcast 47 from broadcast at DAGScheduler.scala:1006
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 23 (MapPartitionsRDD[70] at processCmd at CliDriver.java:376) (first 15 tasks are for partitions Vector(0))
2018-11-08 14:17:24 INFO  YarnScheduler:54 - Adding task set 23.0 with 1 tasks
2018-11-08 14:17:24 INFO  TaskSetManager:54 - Starting task 0.0 in stage 23.0 (TID 38, cloud70.cluster.lsd.di.uminho.pt, executor 1, partition 0, NODE_LOCAL, 5316 bytes)
2018-11-08 14:17:24 INFO  BlockManagerInfo:54 - Added broadcast_47_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 33.7 KB, free: 366.2 MB)
2018-11-08 14:17:24 INFO  BlockManagerInfo:54 - Added broadcast_46_piece0 in memory on cloud70.cluster.lsd.di.uminho.pt:44385 (size: 23.5 KB, free: 366.2 MB)
2018-11-08 14:17:24 INFO  TaskSetManager:54 - Finished task 0.0 in stage 23.0 (TID 38) in 589 ms on cloud70.cluster.lsd.di.uminho.pt (executor 1) (1/1)
2018-11-08 14:17:24 INFO  YarnScheduler:54 - Removed TaskSet 23.0, whose tasks have all completed, from pool 
2018-11-08 14:17:24 INFO  DAGScheduler:54 - ResultStage 23 (processCmd at CliDriver.java:376) finished in 0,590 s
2018-11-08 14:17:24 INFO  DAGScheduler:54 - Job 23 finished: processCmd at CliDriver.java:376, took 0,602734 s
2018-11-08 14:17:24 INFO  FileFormatWriter:54 - Job null committed.
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site	
2018-11-08 14:17:24 INFO  HiveExternalCatalog:54 - Persisting file based data source table `tpcds`.`web_site` into Hive metastore in Hive compatible format.
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: create_table: Table(tableName:web_site, dbName:tpcds, owner:gsd, createTime:1541686644, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:web_site_sk, type:int, comment:null), FieldSchema(name:web_site_id, type:string, comment:null), FieldSchema(name:web_rec_start_date, type:string, comment:null), FieldSchema(name:web_rec_end_date, type:string, comment:null), FieldSchema(name:web_name, type:string, comment:null), FieldSchema(name:web_open_date_sk, type:int, comment:null), FieldSchema(name:web_close_date_sk, type:int, comment:null), FieldSchema(name:web_class, type:string, comment:null), FieldSchema(name:web_manager, type:string, comment:null), FieldSchema(name:web_mkt_id, type:int, comment:null), FieldSchema(name:web_mkt_class, type:string, comment:null), FieldSchema(name:web_mkt_desc, type:string, comment:null), FieldSchema(name:web_market_manager, type:string, comment:null), FieldSchema(name:web_company_id, type:int, comment:null), FieldSchema(name:web_company_name, type:string, comment:null), FieldSchema(name:web_street_number, type:string, comment:null), FieldSchema(name:web_street_name, type:string, comment:null), FieldSchema(name:web_street_type, type:string, comment:null), FieldSchema(name:web_suite_number, type:string, comment:null), FieldSchema(name:web_city, type:string, comment:null), FieldSchema(name:web_county, type:string, comment:null), FieldSchema(name:web_state, type:string, comment:null), FieldSchema(name:web_zip, type:string, comment:null), FieldSchema(name:web_country, type:string, comment:null), FieldSchema(name:web_gmt_offset, type:double, comment:null), FieldSchema(name:web_tax_percentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_site, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_site_id","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"web_name","type":"string","nullable":true,"metadata":{}},{"name":"web_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_close_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_class","type":"string","nullable":true,"metadata":{}},{"name":"web_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"web_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_company_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_number","type":"string","nullable":true,"metadata":{}},{"name":"web_street_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_type","type":"string","nullable":true,"metadata":{}},{"name":"web_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"web_city","type":"string","nullable":true,"metadata":{}},{"name":"web_county","type":"string","nullable":true,"metadata":{}},{"name":"web_state","type":"string","nullable":true,"metadata":{}},{"name":"web_zip","type":"string","nullable":true,"metadata":{}},{"name":"web_country","type":"string","nullable":true,"metadata":{}},{"name":"web_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"web_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=create_table: Table(tableName:web_site, dbName:tpcds, owner:gsd, createTime:1541686644, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:web_site_sk, type:int, comment:null), FieldSchema(name:web_site_id, type:string, comment:null), FieldSchema(name:web_rec_start_date, type:string, comment:null), FieldSchema(name:web_rec_end_date, type:string, comment:null), FieldSchema(name:web_name, type:string, comment:null), FieldSchema(name:web_open_date_sk, type:int, comment:null), FieldSchema(name:web_close_date_sk, type:int, comment:null), FieldSchema(name:web_class, type:string, comment:null), FieldSchema(name:web_manager, type:string, comment:null), FieldSchema(name:web_mkt_id, type:int, comment:null), FieldSchema(name:web_mkt_class, type:string, comment:null), FieldSchema(name:web_mkt_desc, type:string, comment:null), FieldSchema(name:web_market_manager, type:string, comment:null), FieldSchema(name:web_company_id, type:int, comment:null), FieldSchema(name:web_company_name, type:string, comment:null), FieldSchema(name:web_street_number, type:string, comment:null), FieldSchema(name:web_street_name, type:string, comment:null), FieldSchema(name:web_street_type, type:string, comment:null), FieldSchema(name:web_suite_number, type:string, comment:null), FieldSchema(name:web_city, type:string, comment:null), FieldSchema(name:web_county, type:string, comment:null), FieldSchema(name:web_state, type:string, comment:null), FieldSchema(name:web_zip, type:string, comment:null), FieldSchema(name:web_country, type:string, comment:null), FieldSchema(name:web_gmt_offset, type:double, comment:null), FieldSchema(name:web_tax_percentage, type:double, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe, parameters:{path=hdfs://cloud64:9000/home/gsd/tpcds.db/web_site, serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{})), partitionKeys:[], parameters:{spark.sql.sources.schema.part.0={"type":"struct","fields":[{"name":"web_site_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_site_id","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_start_date","type":"string","nullable":true,"metadata":{}},{"name":"web_rec_end_date","type":"string","nullable":true,"metadata":{}},{"name":"web_name","type":"string","nullable":true,"metadata":{}},{"name":"web_open_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_close_date_sk","type":"integer","nullable":true,"metadata":{}},{"name":"web_class","type":"string","nullable":true,"metadata":{}},{"name":"web_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_mkt_class","type":"string","nullable":true,"metadata":{}},{"name":"web_mkt_desc","type":"string","nullable":true,"metadata":{}},{"name":"web_market_manager","type":"string","nullable":true,"metadata":{}},{"name":"web_company_id","type":"integer","nullable":true,"metadata":{}},{"name":"web_company_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_number","type":"string","nullable":true,"metadata":{}},{"name":"web_street_name","type":"string","nullable":true,"metadata":{}},{"name":"web_street_type","type":"string","nullable":true,"metadata":{}},{"name":"web_suite_number","type":"string","nullable":true,"metadata":{}},{"name":"web_city","type":"string","nullable":true,"metadata":{}},{"name":"web_county","type":"string","nullable":true,"metadata":{}},{"name":"web_state","type":"string","nullable":true,"metadata":{}},{"name":"web_zip","type":"string","nullable":true,"metadata":{}},{"name":"web_country","type":"string","nullable":true,"metadata":{}},{"name":"web_gmt_offset","type":"double","nullable":true,"metadata":{}},{"name":"web_tax_percentage","type":"double","nullable":true,"metadata":{}}]}, spark.sql.sources.schema.numParts=1, spark.sql.sources.provider=parquet}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{}, groupPrivileges:null, rolePrivileges:null))	
2018-11-08 14:17:24 INFO  log:217 - Updating table stats fast for web_site
2018-11-08 14:17:24 INFO  log:219 - Updated size of table web_site to 10919
2018-11-08 14:17:24 INFO  CliDriver:951 - Time taken: 0.767 seconds
2018-11-08 14:17:24 INFO  SparkSqlParser:54 - Parsing command: 
drop table if exists web_site_text
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  CatalystSqlParser:54 - Parsing command: array<string>
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_database: tpcds
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_database: tpcds	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: get_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=get_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  HiveMetaStore:746 - 0: drop_table : db=tpcds tbl=web_site_text
2018-11-08 14:17:24 INFO  audit:371 - ugi=gsd	ip=unknown-ip-addr	cmd=drop_table : db=tpcds tbl=web_site_text	
2018-11-08 14:17:24 INFO  CliDriver:951 - Time taken: 0.084 seconds
2018-11-08 14:17:24 INFO  SparkUI:54 - Stopped Spark web UI at http://192.168.112.64:4040
2018-11-08 14:17:24 INFO  YarnClientSchedulerBackend:54 - Interrupting monitor thread
2018-11-08 14:17:25 INFO  YarnClientSchedulerBackend:54 - Shutting down all executors
2018-11-08 14:17:25 INFO  YarnSchedulerBackend$YarnDriverEndpoint:54 - Asking each executor to shut down
2018-11-08 14:17:25 INFO  SchedulerExtensionServices:54 - Stopping SchedulerExtensionServices
(serviceOption=None,
 services=List(),
 started=false)
2018-11-08 14:17:25 INFO  YarnClientSchedulerBackend:54 - Stopped
2018-11-08 14:17:25 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2018-11-08 14:17:25 INFO  MemoryStore:54 - MemoryStore cleared
2018-11-08 14:17:25 INFO  BlockManager:54 - BlockManager stopped
2018-11-08 14:17:25 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2018-11-08 14:17:25 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2018-11-08 14:17:25 INFO  SparkContext:54 - Successfully stopped SparkContext
2018-11-08 14:17:25 INFO  ShutdownHookManager:54 - Shutdown hook called
2018-11-08 14:17:25 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-b44058d3-dad1-488a-ad21-c313c10aae16
2018-11-08 14:17:25 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-5e457d56-7936-41e6-9e83-7caae0ab5699
